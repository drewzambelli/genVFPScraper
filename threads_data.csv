Post Type,Title,Author,Timestamp,Thread Link,Reply Author,Reply Message
Question,"how to send Esc code to Epson LQ-590II for draft, courier, etc.",Steve Yu,"Feb 28, 2025 at 8:42 PM",https://www.tek-tips.com/threads/how-to-send-esc-code-to-epson-lq-590ii-for-draft-courier-etc.1833251/,Steve Yu,"Hello colleagues,Sending Printer Command from VFP - Microsoft: FoxProHi,  I am using EPSON LX-300 (dot matrix printer) to print out invoice report. Using ??? command to send everything out to the printer. Everything work fine unless the font and font size. I put already commands such as  SET PRINT FONT TO 'Courier', 8 ??? CHR(15) but they does not affect the...www.tek-tips.comAbove is an old thread that deals with exactly the same issue as I'm having now.My code:mpname = GETPRINTER()SET PRINTER TO NAME &mpnameSET DEVICE TO printSET PRINTER on??? chr(27) + ""x"" + ""0""  && draft mode??? chr(27) + ""k"" + ""2""  && courier? ""Hello World""set printer toThe front panel display of Epson does not change, showing 'script' instead of USD or HSD.Any output after that seems to resemble letter quality, not the draft mode I expected.And the courier font does not seem to work either.Help appreciated."
Reply,"how to send Esc code to Epson LQ-590II for draft, courier, etc.",Steve Yu,"Feb 28, 2025 at 8:42 PM",https://www.tek-tips.com/threads/how-to-send-esc-code-to-epson-lq-590ii-for-draft-courier-etc.1833251/,ggreen61,What is your Windows printer driver -- I think you have to use a Raw printer driver.
Reply,"how to send Esc code to Epson LQ-590II for draft, courier, etc.",Steve Yu,"Feb 28, 2025 at 8:42 PM",https://www.tek-tips.com/threads/how-to-send-esc-code-to-epson-lq-590ii-for-draft-courier-etc.1833251/,Tore Bleken,"Steve Yu said:Hello colleagues,Sending Printer Command from VFP - Microsoft: FoxProHi,  I am using EPSON LX-300 (dot matrix printer) to print out invoice report. Using ??? command to send everything out to the printer. Everything work fine unless the font and font size. I put already commands such as  SET PRINT FONT TO 'Courier', 8 ??? CHR(15) but they does not affect the...www.tek-tips.comAbove is an old thread that deals with exactly the same issue as I'm having now.My code:mpname = GETPRINTER()SET PRINTER TO NAME &mpnameSET DEVICE TO printSET PRINTER on??? chr(27) + ""x"" + ""0""  && draft mode??? chr(27) + ""k"" + ""2""  && courier? ""Hello World""set printer toThe front panel display of Epson does not change, showing 'script' instead of USD or HSD.Any output after that seems to resemble letter quality, not the draft mode I expected.And the courier font does not seem to work either.Help appreciated.Click to expand...Make sure that you use a printer driver that passes the data directly to the printer. It's called Generic, text only, or something like that."
Reply,"how to send Esc code to Epson LQ-590II for draft, courier, etc.",Steve Yu,"Feb 28, 2025 at 8:42 PM",https://www.tek-tips.com/threads/how-to-send-esc-code-to-epson-lq-590ii-for-draft-courier-etc.1833251/,Joe Crescenzi,Ditto.  You need to use Generic Text Only printer drivers.  Any device specific printer driver will not pass through ESC codes.
Reply,"how to send Esc code to Epson LQ-590II for draft, courier, etc.",Steve Yu,"Feb 28, 2025 at 8:42 PM",https://www.tek-tips.com/threads/how-to-send-esc-code-to-epson-lq-590ii-for-draft-courier-etc.1833251/,Steve Yu,"That did it.Changed the driver from Epson to Generic/Text and the Esc code went through and reconfigured the fonts.Thanks everyone.One note: even I set Widows printer property to no spool (print direct), the print job still went to the print queue and won't go away until multiple 'set printer to', 'set printer off' commands. What is the exact command to end the print job ?"
Reply,"how to send Esc code to Epson LQ-590II for draft, courier, etc.",Steve Yu,"Feb 28, 2025 at 8:42 PM",https://www.tek-tips.com/threads/how-to-send-esc-code-to-epson-lq-590ii-for-draft-courier-etc.1833251/,Chriss Miller,"This might help.3 Ways to Stop Printer Spooling on a Windows Computer - wikiHowPrinters can be tedious machines to use. This article will cover one of the most common printer problems: spooling. Printer Spooling, an acronym for Simultaneous Peripheral Operations On-line, is the term given to the system on your...www.wikihow.comAs it talks of starting the print spooler service, finally, I wonder what you mean with a no spool printer property.And what ends a print job you do with ??? after you SET PRINTER ON? I'd guess SET PRINTER OFF.Or, if not, it would be one of the specific escape sequences you would send to your printer, wouldn't it?"
Reply,"how to send Esc code to Epson LQ-590II for draft, courier, etc.",Steve Yu,"Feb 28, 2025 at 8:42 PM",https://www.tek-tips.com/threads/how-to-send-esc-code-to-epson-lq-590ii-for-draft-courier-etc.1833251/,Steve Yu,"Chriss Miller said:This might help.3 Ways to Stop Printer Spooling on a Windows Computer - wikiHowPrinters can be tedious machines to use. This article will cover one of the most common printer problems: spooling. Printer Spooling, an acronym for Simultaneous Peripheral Operations On-line, is the term given to the system on your...www.wikihow.comAs it talks of starting the print spooler service, finally, I wonder what you mean with a no spool printer property.And what ends a print job you do with ??? after you SET PRINTER ON? I'd guess SET PRINTER OFF.Or, if not, it would be one of the specific escape sequences you would send to your printer, wouldn't it?Click to expand...I'm familiar with start/stop procedures of spooler under Windows Services.Here it seems I need to use Generic/Text as driver (vs Epson printer driver) and disable print spool; that's what I did by selecting 'Print directly to printer' instead of 'Spool print documents' under printer property.My question was, with these settings, my print output went to the print queue anyway and stay there for sometime until I did a bunch of 'set printer off','set printer to'.Maybe there is a time delay between 'set printer off' and when print jobs actually clear out of the queue; but it just seems to me they stay there for a very long time.Maybe I'll try the printer reset Esc sequence at the end and see if it clears the queue."
Reply,"how to send Esc code to Epson LQ-590II for draft, courier, etc.",Steve Yu,"Feb 28, 2025 at 8:42 PM",https://www.tek-tips.com/threads/how-to-send-esc-code-to-epson-lq-590ii-for-draft-courier-etc.1833251/,Joe Crescenzi,"It's been a while since I've needed to send ESC codes, but one thing that may make a difference is sending a FormFeed character when you want to eject a page.In the old days, printers printed one line at a time.  You sent a line, it printed the line right after the Carriage Return and Line Feed was sent.When page based printers came along (laser and inkjets), they didn't start printing until either the page hit the last line, or you sent a FormFeed, CHR(12).  That's because unlike line based printers, page based printers could define pages in any order by positioning items anywhere on the page, so they often wait until the FF to know when to print."
Reply,"how to send Esc code to Epson LQ-590II for draft, courier, etc.",Steve Yu,"Feb 28, 2025 at 8:42 PM",https://www.tek-tips.com/threads/how-to-send-esc-code-to-epson-lq-590ii-for-draft-courier-etc.1833251/,Steve Yu,"Joe Crescenzi said:It's been a while since I've needed to send ESC codes, but one thing that may make a difference is sending a FormFeed character when you want to eject a page.In the old days, printers printed one line at a time.  You sent a line, it printed the line right after the Carriage Return and Line Feed was sent.When page based printers came along (laser and inkjets), they didn't start printing until either the page hit the last line, or you sent a FormFeed, CHR(12).  That's because unlike line based printers, page based printers could define pages in any order by positioning items anywhere on the page, so they often wait until the FF to know when to print.Click to expand...Esc codes are used here primarily for printer font selection purpose for Epson LQ-590 dot-matrix printer (unfortunately we are still searching for laser alternatives for multi-part paper apps, or paperless options, but still, people need that piece of paper). The build-in Set Printer Font command in VFP does not seem to work (can't trigger draft mode for example). Even though the Set Printer Font does work for Okidata dot-matrix printers without need for any Esc codes.Maybe that was the question I should have posted instead."
Reply,"how to send Esc code to Epson LQ-590II for draft, courier, etc.",Steve Yu,"Feb 28, 2025 at 8:42 PM",https://www.tek-tips.com/threads/how-to-send-esc-code-to-epson-lq-590ii-for-draft-courier-etc.1833251/,Chriss Miller,"There is no direct printing, that should be clear by needing the Generic/Text Only driver. Your printer communication in Windows always goes through a driver and uses the whole Windows printer environment, i.e. print queue. Print queue and spooling are a tandem, they're not the same.I'd set it that way. Isn't that an option in the driver settings?Otherwise any ??? does neither finish a line nor a page, and even with a form feed (page feed) you're never defining thelastpage. So if you don't have these detailed options but only spooling or direct printing, I guess direct printing will still not mean immediate printing. I'd still say SET PRINTER OFF ends the job, maybe also SET PRINTER TO afterwards tells the printer and Windows you're done with that printer.Steve Yu said:Maybe I'll try the printer reset Esc sequence at the end and see if it clears the queue.Click to expand...Surely a good idea worth testing, I fear it would rather forget the whole print job, though."
Reply,"how to send Esc code to Epson LQ-590II for draft, courier, etc.",Steve Yu,"Feb 28, 2025 at 8:42 PM",https://www.tek-tips.com/threads/how-to-send-esc-code-to-epson-lq-590ii-for-draft-courier-etc.1833251/,Joe Crescenzi,"Most printers today still respond to variations of the same coding languages they had for decades.  The difference is how programs interact with them.When I first started writing code around 1981, there was no such thing as a printer driver.  You took the printer out of the box, and the book for the printer gave you a list of the codes to control things like font choices and sizes.  The key here is that font choices had to be among those *built-in* to the printer.You would need to know the specific fonts and sizes your printer supported and what codes changed them.  The closest thing to a ""driver"" for me was tracking whether they had an Epson or Okidata printer in my own set of variables such as ""FontBold"", ""FontNormal"", ""FontCondensed"", etc., then swapping those variables based on a the printer they owned .When graphic operating systems with unlimited fonts came along, they were able to ignore the limitations of the built-in fonts by making extensive use of the coding needed to send graphics, so instead of telling the printer to change to condensed, it could *draw* letters anywhere on the page alongside any other graphics with pixel perfect precision.When you use the Generic Text Only printer driver, it fundamentally removes the ability to use things like SET PRINTER FONT that let Windows send any font you have installed to the printer and puts you back into the driver's seat when it comes to controlling the printer and using just the built-in font sizes."
Reply,"how to send Esc code to Epson LQ-590II for draft, courier, etc.",Steve Yu,"Feb 28, 2025 at 8:42 PM",https://www.tek-tips.com/threads/how-to-send-esc-code-to-epson-lq-590ii-for-draft-courier-etc.1833251/,Gary Sutherland,Have you tried sending Ctrl Z ?
Reply,"how to send Esc code to Epson LQ-590II for draft, courier, etc.",Steve Yu,"Feb 28, 2025 at 8:42 PM",https://www.tek-tips.com/threads/how-to-send-esc-code-to-epson-lq-590ii-for-draft-courier-etc.1833251/,Steve Yu,Gary Sutherland said:Have you tried sending Ctrl Z ?Click to expand...Nope. What does it do ?
Reply,"how to send Esc code to Epson LQ-590II for draft, courier, etc.",Steve Yu,"Feb 28, 2025 at 8:42 PM",https://www.tek-tips.com/threads/how-to-send-esc-code-to-epson-lq-590ii-for-draft-courier-etc.1833251/,Joe Crescenzi,"Control-C is the ASCII code for End of File.We've had quite a few responses, so I'm not sure which issues you are still having and which suggestions you tried.  One thing I can say is that FormFeed, CHR(12) is definitely a universal command that tells a printer your page is complete, so it can start a new page, so if you haven't tried sending that, you may want to give it a try.  EJECT should have the same effect."
Question,sorting,Mandy_crw,"Feb 28, 2025 at 11:34 AM",https://www.tek-tips.com/threads/sorting.1833245/,Mandy_crw,"Hi everyone... i have grade as field as character which are 0,1,2,3,4,5,6,7,8,9,10,11,12.... but everytime i sort using set order , order by and index... it display 0,1,10,11,12,2,3,4,5,6,7,8,9.... may i ask how to sort from 0-12? thanks and advanced...."
Reply,sorting,Mandy_crw,"Feb 28, 2025 at 11:34 AM",https://www.tek-tips.com/threads/sorting.1833245/,Chriss Miller,"Right align the values, i.e. store "" 1"", not ""1 "", "" 2"", not ""2 "", etc.Or simpler: Use an integer or numeric field for grades."
Reply,sorting,Mandy_crw,"Feb 28, 2025 at 11:34 AM",https://www.tek-tips.com/threads/sorting.1833245/,Joe Crescenzi,"If the values are text based instead of numbers, 1, 10, 11, 100, or even 10000000 will sort before 2.You will either need to make them numbers, or pad the text based values with zeros or even spaces before sorting.The number of pads will depend on your largest value.  So, if your largest value is 100, all your numbers need to be padded 3 characters.Code:So this...
? PADL(1,3)
? PADL(12,3)
? PADL(123,3)

Will look like this...
  1
 12
123"
Reply,sorting,Mandy_crw,"Feb 28, 2025 at 11:34 AM",https://www.tek-tips.com/threads/sorting.1833245/,gbcpastor,"I've had this situation several times years ago. What I got in the habit of doing was using a leading zero in my text fields so I would have values that looked like this:01020304050607080910111213...That's if I wished to keep the values as text. Otherwise, just use the val() function in your sort. Either way will give you the expected results.Keep On Codin'Pastor Steve"
Reply,sorting,Mandy_crw,"Feb 28, 2025 at 11:34 AM",https://www.tek-tips.com/threads/sorting.1833245/,EinTerraner,in case this field has no additional chars except the numeric ones just set INDEX ON VAL(fieldname)
Reply,sorting,Mandy_crw,"Feb 28, 2025 at 11:34 AM",https://www.tek-tips.com/threads/sorting.1833245/,Chriss Miller,"Mandy,I hope the major point is clear now. You're defining the grade field as character, so text sorting rules.You do expect a dictionary to sort all words with a before all words with b, don't you? You don't expect the dictionary to sort a,b,c,d,e,f,..,z,aa,ab,ac,.., etc.Do you? Would you like to first need to count the number of letters of a word to be able to look it up in a dictionary? No, you don't. Or do you?In text sorting the inital letter (also if that's a digit) has the major importance, in number notation that's also true, in general, but the longer the numbers get the higher the weight of the first digit, i.e. a three-digit number starting with 1 comes before a two-digit number, even if that begins with 9. That's not so with words, the word length of a word doesn't scale the weight of letters, all a-words come before all b-words, no matter if they are longer or shorter.So you can only expect numeric sortfing for numeric fields or formatting text so the text sorting has the same order as numeric sorting or you determine the text value, that will sort text which represents numbers correctly, but would treat every other text as 0, not sorting it or sorting all text between positive and negative numbers.It's a very general rule of working without surprises like that to store data in the appropriate data type only, ever. You store numbers in integer, numeric, float, currency field type - what you need is specific, not only when you want to calculate with it but also when you want sort numerically vs alphabetically, compare them. And grades are numbers that you calculate with, normally, when you calculate the average grade, for example. That's also best done when storing grades in one of the available number formats. As average grades have decimal places, it would even not be wrong to store the simple integer grades into float fields, just so that you could also store an averyge of a class or of all homework of a student into such a field, too."
Reply,sorting,Mandy_crw,"Feb 28, 2025 at 11:34 AM",https://www.tek-tips.com/threads/sorting.1833245/,ggreen61,"Create the following index on your field that contains the grade value (where grade is the field name):Code:INDEX ON PADL(ALLTRIM(grade), 10, '0') TAG gradeNow use this index to set the order for display.  If you want to select the records then use the same PADL() expression in the ORDER BY clause."
Reply,sorting,Mandy_crw,"Feb 28, 2025 at 11:34 AM",https://www.tek-tips.com/threads/sorting.1833245/,igorsandler,"Mandy_crw said:Hi everyone... i have grade as field as character which are 0,1,2,3,4,5,6,7,8,9,10,11,12.... but everytime i sort using set order , order by and index... it display 0,1,10,11,12,2,3,4,5,6,7,8,9.... may i ask how to sort from 0-12? thanks and advanced....Click to expand...Mandy_crw said:Hi everyone... i have grade as field as character which are 0,1,2,3,4,5,6,7,8,9,10,11,12.... but everytime i sort using set order , order by and index... it display 0,1,10,11,12,2,3,4,5,6,7,8,9.... may i ask how to sort from 0-12? thanks and advanced....Click to expand...If you need to sort a view or a cursor, you can add an additional field to it INT(VAL(grade)) AS igrade_sort. If you need to order a table then you need to create an index, like it was suggested above. I am using it all the time"
Reply,sorting,Mandy_crw,"Feb 28, 2025 at 11:34 AM",https://www.tek-tips.com/threads/sorting.1833245/,Steve Yu,"Mandy_crw said:Hi everyone... i have grade as field as character which are 0,1,2,3,4,5,6,7,8,9,10,11,12.... but everytime i sort using set order , order by and index... it display 0,1,10,11,12,2,3,4,5,6,7,8,9.... may i ask how to sort from 0-12? thanks and advanced....Click to expand...index on str(val(grade),2) tag tag1"
Reply,sorting,Mandy_crw,"Feb 28, 2025 at 11:34 AM",https://www.tek-tips.com/threads/sorting.1833245/,Mandy_crw,"Hi everyone... thank you for all your answers.... i have used your method steve yu,... and it worked as i desire.... thank you so much steve yu.... God bless..."
Question,Command History not saved if VFP closed by shutdown,rbeitler,"Feb 26, 2025 at 3:09 PM",https://www.tek-tips.com/threads/command-history-not-saved-if-vfp-closed-by-shutdown.1833224/,rbeitler,"I use VFP IDE on our server.  If I use QUIT in command window, command history is saved properly.  This is also true if use close the IDE with the ""X"" button, or right click in taskbar and choose close window.However, if the computer is rebooted by someone else (like for updates, etc) the command history is not saved.  I am guessing the vfp9.exe process is terminated so it is not running the normal shutdown routine.  This is very frustrating when you have days or weeks of command history that you need to see!Has anyone else seen this behavior, and is there a way to fix it?  Perhaps using ON SHUTDOWN?"
Reply,Command History not saved if VFP closed by shutdown,rbeitler,"Feb 26, 2025 at 3:09 PM",https://www.tek-tips.com/threads/command-history-not-saved-if-vfp-closed-by-shutdown.1833224/,Joe Crescenzi,"If you are concerned about saving history, just keep in mind that your history is stored in a simple PRG file called _Command.Prg.  So, you can periodically back it up, or as you suggested, perhaps make a copy on shutdown."
Reply,Command History not saved if VFP closed by shutdown,rbeitler,"Feb 26, 2025 at 3:09 PM",https://www.tek-tips.com/threads/command-history-not-saved-if-vfp-closed-by-shutdown.1833224/,GTGeek88,"That's long been a problem. It's frustrating when VFP crashes or the computer reboots for an update and you lose those commands. The 64K limit has also been bothersome. There are likely solutions like setting up a macro to save the command history to a file (besides _command.prg). Also, you can simply quit and restart at lunch and when you leave work. Or, heck, every damn hour. I'm jumping back and forth between projects, so I switch folders with a CD, open various VFP forms, classes, and reports, etc., but before I do, I use an on key label setup of F7 that does this:on key label F7 keyboard ""* "" + cdow(date()) + "" "" + ttoc(datetime())  && + ""(Enter}""This lets me find the switches when I look back over the code and is helpful with billing, since I sometimes forget to record my start/stop times. At least I have something to go on."
Reply,Command History not saved if VFP closed by shutdown,rbeitler,"Feb 26, 2025 at 3:09 PM",https://www.tek-tips.com/threads/command-history-not-saved-if-vfp-closed-by-shutdown.1833224/,ggreen61,"When the machine is rebooted that is running VFP IDE, the VFP running process is terminated by the OS.  This is not an orderly shutdown that would allow the command history to be saved.  You would need to use a method as described above that the user can trigger to save the contents to a file.  You might also add a timer to the _SCREEN that would do this automatically in an interval that is started when VFP is started."
Reply,Command History not saved if VFP closed by shutdown,rbeitler,"Feb 26, 2025 at 3:09 PM",https://www.tek-tips.com/threads/command-history-not-saved-if-vfp-closed-by-shutdown.1833224/,Chriss Miller,"If the shutdown would simply cause no save of the command history, you would still have the history up to the last start of VFP. If your _command.prg (as mentioned by Joe) is emptied, then it's not just true the shutdown kills the process without an effect on the commdn history.I would look, whether your command history is really emptied or just not found or it's loaded from another directrory and your last or at least a quite recent state still exists elsewhere.Much of what has alredy been said can be found in the help topic of the Command Window in this paragraphCommand Window (Visual FoxPro)Persistence of Contents​The contents of theCommandwindow are saved to a file, _command.prg, automatically unless the noRecentDocHistory system policy is enabled or you are not using a FoxUser resource file. You can clear the window by selecting Clear from the Command Window shortcut menu. To enable its use by multiple instances of Visual FoxPro, the file is only read when starting Visual FoxPro, and written when exiting Visual FoxPro. The file is located in the same directory as the FoxUser resource file. You can determine or change the location of the resource file from the Options dialog box, File Locations tab, or via language using SET(""RESOURCE"") or SET RESOURCE respectively.Click to expand...It also literally tells about a case that can be the root cause of loosing the history: If you clear the command window with CTRL+A and DEL or with the context menu ""Clear"" and think you just clear the window for the current session, then close VFP normally, you actually shorten the _command.prg, the prg file really is just and simply the whole content of the Command Window at the moment of saving, there is no such thing as appending to _command.prg or keeping a history like a transction log.Knowing this, going forward you better backup your command history yourself and also take it as a way to redigate it to what you really want and need.I also like to point out that _command.prg also was a topic in the threadhttps://www.tek-tips.com/threads/settings-in-config-fpw.1832550/that was about wanting to have several _command.prg file or even individual names.So also when you switch the location of foxuser.dbf or delete and recreate it, but not in the same place but perhaps the default location you switch to another state of the _command.prg stored there or ""empty"" it indirectly. That's also a case where you can still find an untouched recent version. Just to be clear: If you recreate the foxuser.dbf to recover from a corrupt state of that table, you don't also delete the _command.prg, but when that changes the location of the foxuser you also change the location and thereby state of the _command.prg"
Reply,Command History not saved if VFP closed by shutdown,rbeitler,"Feb 26, 2025 at 3:09 PM",https://www.tek-tips.com/threads/command-history-not-saved-if-vfp-closed-by-shutdown.1833224/,rbeitler,"Thank you for all the replies.I also keep my own history file, periodically I add a line like:* 2/26/2025 Updated \u\work\_commandThen I search backward for the last comment I have like this, do a Ctrl+Shift+End to select everything from that point, and copy and past to my history file.  It is invaluable to have everything going back to rerun old queries, etc.So OS shutdowns are my only blind spot...  I do find myself quitting and restarting to make sure it gets saved to _command.prg, I guess I will try to make it a end of day habit.Does anyone know if ON SHUTDOWN code would be executed if the OS tries to end the vfp.exe process?  And even if it did, if the ""fresh"" commands are not in _command.prg how would vfp code get it from the command window?  Maybe simply having a QUIT in ON SHUTDOWN would execute the normal routine and save the history?  If I get time I will give it a try."
Reply,Command History not saved if VFP closed by shutdown,rbeitler,"Feb 26, 2025 at 3:09 PM",https://www.tek-tips.com/threads/command-history-not-saved-if-vfp-closed-by-shutdown.1833224/,Dan Olsson,"No offense, but why are OS shutdowns a problem? You don't let Windows decide when to do them, do you?When it want to update itself I always shut down all programs before I reboot."
Reply,Command History not saved if VFP closed by shutdown,rbeitler,"Feb 26, 2025 at 3:09 PM",https://www.tek-tips.com/threads/command-history-not-saved-if-vfp-closed-by-shutdown.1833224/,TamarGranor,"Do a lot of people really leave VFP running for days at a time? I shut it every time I'm done with it.Of course, I also shut down my development computer (which is a desktop) every night.Tamar"
Reply,Command History not saved if VFP closed by shutdown,rbeitler,"Feb 26, 2025 at 3:09 PM",https://www.tek-tips.com/threads/command-history-not-saved-if-vfp-closed-by-shutdown.1833224/,rbeitler,"VFP.exe is running on the server.  We started having file locking issues using SMB, so I have been using VFP directly on our server that hosts our application.  It is WAY faster.  We also set up RemoteApp for the users, and things have been much faster for them as well.With the RemoteApp, IT has been changing settings for screen lock etc, I think they put in a setting to automatically disconnect idle sessions after so many hours.  So I think that is what killed my VFP.exeOther scenario is leaving it open on a Friday and updates being installed over the weekend."
Reply,Command History not saved if VFP closed by shutdown,rbeitler,"Feb 26, 2025 at 3:09 PM",https://www.tek-tips.com/threads/command-history-not-saved-if-vfp-closed-by-shutdown.1833224/,wOOdy-Soft,"A regular server shutdown / restart will always close running programs gracefully. I.e. that's the same API call, which is triggered if you close VFP withe the closebox in upper right corner. This will also save your commandwindow to the _command.prg.  Editing in the CommandWindow always happens in Memory, only when saving it will copy the newer version back to file.  Unfortunately, the commandwindow has no separate ""Save"" enabled in the File-menu, but IMHO someone knowledgable could write an FLL which grabs that editor-handle and does a periodic saving.Only if you have a real VFP crash (c0005 etc) or a VFP session which is not responding to the Windows-Close API call (where then Windows will just delete the task to go on with Reboot), only then VFP is not able to perform it's Shutdown task and will not be able to close its files correctly."
Reply,Command History not saved if VFP closed by shutdown,rbeitler,"Feb 26, 2025 at 3:09 PM",https://www.tek-tips.com/threads/command-history-not-saved-if-vfp-closed-by-shutdown.1833224/,Chriss Miller,"rbeitler said:VFP.exe is running on the server.Click to expand...If multiple users use VFP from there, only one of them has to have the habit of clearing the command window, which indirectly clears the _command.prg. Well, or only stores the commands he did from then onwards. Also if a user decides to not use a foxuser.dbf and clears the file location of the resource file that clears the command window at each start. Keep in mind this is not a file VFP appends to, at shutdown, normal or otherwise graceful, VFP just stores the command window content to the file. The help on command window also says:Command Window (Visual FoxPro)(_command.prg is saved...) unless the noRecentDocHistory system policy is enabled or you are not using a FoxUser resource file.Click to expand...Using one vfp.exe for all users, your histories mix. So the best thing you can do is create your own foxuser.dbf and config.fpw in a user directory of yours to have your own _command.prg. Knowing it goes into the same directory as foxuser.dbf you then have your own."
Reply,Command History not saved if VFP closed by shutdown,rbeitler,"Feb 26, 2025 at 3:09 PM",https://www.tek-tips.com/threads/command-history-not-saved-if-vfp-closed-by-shutdown.1833224/,rbeitler,"On my PC and on the server the _command.prg and foxuser dbf are stored in user profile (C:\Users\<username>\AppData\Roaming\Microsoft\Visual FoxPro 9) so every user should be getting their own command history.As for closing vfp.exe gracefully, I just did a test.  I opened vfp IDE, entered a comment in command window, then did a reboot but left vfp open.  After reboot, it only have my previous history, not the new comment.  So at least for me this is the behavior.I was hoping running this would help:Code:ON SHUTDOWN QUITBut same thing, new commands were not saved if I rebooted while vfp was open.Can someone else try restarting while vfp is running to see if they observe the same behavior?Thanks"
Reply,Command History not saved if VFP closed by shutdown,rbeitler,"Feb 26, 2025 at 3:09 PM",https://www.tek-tips.com/threads/command-history-not-saved-if-vfp-closed-by-shutdown.1833224/,Chriss Miller,"It works as you say, but you just lose the added commands of the last session.rbeitler said:This is very frustrating when you have days or weeks of command history that you need to see!Click to expand...That's true, but what you describe now is not losing the history of weeks but just the commands used in the last VFP session. Or are you saying it's normal for your VFP sessions to last for weeks?Get used to closing down your applications and shut down, I promise you your computer will work better every day, not get into lagging because of running for a long time. Even now VFP runs on a server via RemoteApp, you use a server as a client. You don't shut down that server, you shut down your client, that in turn ends RemoteApps. If I remember correctly in RemoteDesktop sessions (with or without TS) you could turn off your computer, come back, reconnect and find your server desktop session still running. That seems to have changed from what RemoteDesktop was to RemoteApps now. But the server keeps running, doesn't it? So it's now actually only server shutdowns that would cause this.But if, as you say, other users, maybe admins do a shutdown (or Windows Update does), then the real problem is that you don't shut down your computer for weeks, nothing else.By the way, if you look for a pattern: Every second tuesday of a month is Windows Update aka Micorsoft Patchday. So at least shut down VFP IDE and your computer on the second Monday of a month."
Reply,Command History not saved if VFP closed by shutdown,rbeitler,"Feb 26, 2025 at 3:09 PM",https://www.tek-tips.com/threads/command-history-not-saved-if-vfp-closed-by-shutdown.1833224/,Chriss Miller,"wOOdy-Soft said:IMHO someone knowledgable could write an FLL which grabs that editor-handle and does a periodic saving.Click to expand...Not necessary. You can save the command window content this way:Code:Local lcCommandHistoryDir, llSafety

lcCommandHistoryDir = Justpath(Sys(2005))
Try
   llSafety = (Set(""Safety"")==""ON"")
   Set Safety Off
   Copy File (lcCommandHistoryDir+""\_command.prg"") To (lcCommandHistoryDir+""\_command.prg.bak"")
Catch
   If Empty(Sys(2005))
      Messagebox(""Without configuring a resource file no command history."",64,""No Command History"")
   Endif
Endtry

Show Window Command
Activate Window Command
Keyboard '{CTRL+A}'
Doevents

If Popup('ensurecopyworks')
   Deactivate Popup ensurecopyworks
Endif
Define Popup ensurecopyworks Shortcut Relative
Define Bar _MED_COPY Of ensurecopyworks Prompt ""\<Copy""
Activate Popup ensurecopyworks Nowait
Doevents
Keyboard '{CTRL+C}'
Doevents
Deactivate Popup ensurecopyworks

Strtofile(_Cliptext,lcCommandHistoryDir+""\_command.prg"",0)
If llSafety
   Set Safety On
EndIfWhy so complicated? Well, turns out after CTRL+A the copy menu item of the edit menu is grayed out (inactivated), so while CTRL+A did select all command window content, CTRL+C does not work to actually copy the selection into _cliptext. With the trick of defining a shortcut menu with the _MED_COPY system menu item you can trigger that with CTRL+C. It also requires all the Doevents.Now to have that at hand at all times you could make it a menu item, add this as PRG to your project, do both or even put it into a timer, though that would disrupt working in the IDE when suddenly the command window is activated and the _cliptext changes to it.One last important notice of caution: This is tested in my VFP IDE, if by any means any setting of VFP causes it not to work (or conditions like a closed command window - though I have Show Window, not only Activate Window) cause it to fail. Or any timing problems or flaky functionality of CTRL+C, the code does first backup _command.prg to _command.prg.bak. I ask you to verify that _command.prg is as you expect it to become before running it twice, otherwise that backup is overwritten by whatever is in the _cliptext instead of the command window content.So in short: Please test this on your computer and inspect the effect on the _command.prg before putting this into production.To verify it helps to add a last command or even just a comment into the command window and see if that gets into _command.prg (obviously it will only get into _command.prg.bak if you run this at least twice).To verify _command.prg just doCode:Modify Command (JustPath(Sys(2005))+""\_command.prg"")One more notice: Once you verified _command.prg close that, otherwise you could get into the trap that closing the IDE saves the state of the prg you have open as a normal PRG edit window and not what's in the actual command window. Might not happen, as saving the command window should be done last and you didn't modify the verified _command.prg state, but you never know.One idea verifying the copy step didn't fail is you check, whether _cliptext starts with _command.prg.bak and is longer than that backup. And/Or create a multi staging backup mechanism with bak1-bak9999 or whatever."
Question,Can someone help with meaning from VFP Help for ComReturnError,cfsjohn,"Feb 27, 2025 at 12:38 PM",https://www.tek-tips.com/threads/can-someone-help-with-meaning-from-vfp-help-for-comreturnerror.1833232/,cfsjohn,"VFP help for ComReturnError() says:COMRETURNERROR( ) FunctionExecuting COMRETURNERROR( ) places the specified text in the COM exception structure, aborts executing the current method, and returns control to the client. The Automation server remains in memory and the client can call more Automation server methods.I am confused about what ""aborts executing the current method, and returns control to the client"" means.My web service is a COM server. Let's call it ""ITFBO"". It calls other COM servers.So a hit to the ""server"" comes in.The appropriate endpoint is executed. An endpoint is just a method. Let's say the endpoint is ""GetBalance()"".The endpoint method calls a method in a different COM server to actually do what is necessary to get the balance. Let's call this COM server ""VFEITFBO"". The method that gets called is ""VFEGetBalance()"".VFEITFBO has an on error method.If any error occurs, ComReturnError gets executed.So, an error occurs while executing VFEITFBO's VFEGetBalance method. The ONERROR method is called and ComReturnError gets executed.Can you tell me exectly what happens? Where does code exection resume? Does VFEITFBO continue to run?Thanks,John"
Reply,Can someone help with meaning from VFP Help for ComReturnError,cfsjohn,"Feb 27, 2025 at 12:38 PM",https://www.tek-tips.com/threads/can-someone-help-with-meaning-from-vfp-help-for-comreturnerror.1833232/,Joe Crescenzi,"It should follow the hierarchy and each layer will be able to send messages upwards one level.So, if you catch an error and push your own message into the exception, whatever function called that function will have access to that message.For example, a COM server called TOP calls a COM server called MIDDLE, which calls a COM server called BOTTOM.If an error is caught in BOTTOM, MIDDLE should be able to see it, then you can decide whether MIDDLE should take action, or relay yet another error to TOP"
Reply,Can someone help with meaning from VFP Help for ComReturnError,cfsjohn,"Feb 27, 2025 at 12:38 PM",https://www.tek-tips.com/threads/can-someone-help-with-meaning-from-vfp-help-for-comreturnerror.1833232/,Chriss Miller,"If a server uses another server, it becomes a client of that other server.So COMRETURNERROR will return to the ITFBO. It does not return to the GetBalance, though, because it causes an OLE error and that causes an error routine in the ITFBO client (that's technically also a COM server, but is a client because it calls the VFEGetBalance method in the VFEITFBO server.Does that make anything clearer?I'd explain it inversely, starting from an error happening in a VFP application, if that error happens in a COM (automation) Server, no matter if that's a VFP COM Server or any COM Server like Word.Application, you get an error number 1427 or 1429, as those are the OLE error numbers. And an AERROR call then populates the array with some informations from the OLE server, if the OLE server provides them. COMRETURNERROR is a function that allows you to do so. So unlike so many OLE errors that leave you with no further information than that it was an OLE error 1427 or 1429 you can pass on informations.They don't get back to the calling method, they get back into the error handler of the client, which in your situation is the ITFBO COM Server. If you don't have an ON ERROR routine there, it gets lost, if your ITFBO COM server has an ON ERROR routine that itself is making a COMRETURNERROR call you would throw an error in the actual client that called GetBalance(), though, so this would cascade the error triggering.So your error handling should handle errors 1427 or 1429 specifically. Within a COM Server this does mean the error actually happened in another COM Server and you may or may not want to forward that with COMRETURNERROR, too. If any normal error happens within a COM Server the error handling of errors other than 1427 and 1429 can and should definitely use COMRETURNERROR to help the client get it, unless you have error handling code that actually handles the error in the sense of resolving it and continuing, which would mean you don't need a client further up tha call chain to get informed about it, as you actually resolve it.And to make this even more complicated, COMRETURNERROR of course can also be used in a COM Server to add this error information to the client outside of the COM Servers general error handlling, i.e. you can trigger an error in the client.What COMRETURNERROR is not is returning an error instead of the usual return value of a method. It's not just a simple RETURN mechanism, it's a mechanism to add to the error information structure and it causes an error in the client, whether the client is a normal non COM Server client or COM server itself doesn't matter. Just the caller process.All in all it means that you can still have an all purpose error handling routine you can use in clients, in COM Servers, also if they use further COM Servers as clients of them and also on the second level. It makes always sense to look into what error number errors have, to know whether the current process/thread is a COM Server to make use of COMRETURNERROR in case you don't resolve the error and continue."
Reply,Can someone help with meaning from VFP Help for ComReturnError,cfsjohn,"Feb 27, 2025 at 12:38 PM",https://www.tek-tips.com/threads/can-someone-help-with-meaning-from-vfp-help-for-comreturnerror.1833232/,cfsjohn,"Joe and Chriss, The parts about everything moving up the hierarchy is logical and I concur.Joe Crescenzi said:It should follow the hierarchy and each layer will be able to send messages upwards one level.So, if you catch an error and push your own message into the exception, whatever function called that function will have access to that message.For example, a COM server called TOP calls a COM server called MIDDLE, which calls a COM server called BOTTOM.If an error is caught in BOTTOM, MIDDLE should be able to see it, then you can decide whether MIDDLE should take action, or relay yet another error to TOPClick to expand...Joe, Using your scenario, when the error is caught in BOTTOM and COMErrorReturn gets executed, the error routine in MIDDLE (assuming there is one), would automatically get executed and it would need to do something about dealing with the error. Am I understanding correctly?"
Reply,Can someone help with meaning from VFP Help for ComReturnError,cfsjohn,"Feb 27, 2025 at 12:38 PM",https://www.tek-tips.com/threads/can-someone-help-with-meaning-from-vfp-help-for-comreturnerror.1833232/,Chriss Miller,Correct.
Reply,Can someone help with meaning from VFP Help for ComReturnError,cfsjohn,"Feb 27, 2025 at 12:38 PM",https://www.tek-tips.com/threads/can-someone-help-with-meaning-from-vfp-help-for-comreturnerror.1833232/,cfsjohn,"Chriss Miller said:Correct.Click to expand...Thanks Chriss, Now I will try to follow you guys advice. I will let you know.John"
Question,VFP 'unresponsive' for 60 secs when closing MSCOMMLib.MSComm,David Higgs,"Feb 20, 2025 at 1:06 PM",https://www.tek-tips.com/threads/vfp-unresponsive-for-60-secs-when-closing-mscommlib-mscomm.1833155/,David Higgs,"My VFP application connects to my Amateur Radio Transceiver (via Serial COM Port 3) for CAT Control. CAT Control is a generic term used to describe how a PC can control the frequency and various other settings of a transceiver. The CAT commands are bi-directional. My application has run for a number of years without any ‘comms’ issues.I’ve been looking at sharing the Transceiver (Serial COM Port 3) with VFP and another 3rd Party Application. I decided on using aVirtualSerialPortEmulator (VSPE) byhttps://eterlogic.com/products.vspe.htmlI configured VSPE to allow my VFP application using Virtual Serial Port COM 10 to communicate with my Transceiver Serial Port COM 3. I intend using another 3rd Party Application on Virtual Serial Port COM 11.When running VSPE, my VFP application (Virtual Serial Port COM 10) connects to my Transceiver (COM 3) and works as expected. However, I have an issue which I’ve not be able to resolve. When I exit my VFP application by clicking the ‘Exit Program’ Command Button VFP becomes ‘unresponsive’ for 60 secs before closing down.VSPE TestTo eliminate any ‘code’ issues with my VFP application, I created a simple VFP Form with just three Command Buttons ‘Set Frequency 1’, ‘Set Frequency 2’ and ‘Exit Program’I ran this VFP Form with no other Code, it opened and closed with no issues.I then added an ‘ActiveX Control OLE Class MSCOMMLib.MSComm.1’ to the form.I then ran the VFP Form again and when clicking the ‘Exit Program’ Command Button the application became ‘unresponsive’ for 60 Seconds and then closed.The only time the problem (VFP being un-responsive for 60 Secs) seems to manifest itself is when I run VFP and VSPE together.My VFP application works ok when connected directly to my Transceiver on Serial Port COM 3.VSPE works ok with my Transceiver using other 3rd party applications.Comms settingsCode:* Command Button 1

thisform.transceiver.output = ""FA003760000;""     && Set Transceiver Frequency 

* Command Button 2

thisform.transceiver.output = ""FA007160000;""     && Set Transceiver Frequency 

* Command Button 'Exit Program'

thisform.transceiver.PortOpen = .F.    && Release Comm Port

thisform.Release"
Reply,VFP 'unresponsive' for 60 secs when closing MSCOMMLib.MSComm,David Higgs,"Feb 20, 2025 at 1:06 PM",https://www.tek-tips.com/threads/vfp-unresponsive-for-60-secs-when-closing-mscommlib-mscomm.1833155/,ggreen61,The only suggestion I have is to use the RemoveObject() method of the VSPE's parent control to first remove the control before you close the form.
Reply,VFP 'unresponsive' for 60 secs when closing MSCOMMLib.MSComm,David Higgs,"Feb 20, 2025 at 1:06 PM",https://www.tek-tips.com/threads/vfp-unresponsive-for-60-secs-when-closing-mscommlib-mscomm.1833155/,David Higgs,"Hi Greg,Thank you for your reply; I'll take a look at your suggestion."
Reply,VFP 'unresponsive' for 60 secs when closing MSCOMMLib.MSComm,David Higgs,"Feb 20, 2025 at 1:06 PM",https://www.tek-tips.com/threads/vfp-unresponsive-for-60-secs-when-closing-mscommlib-mscomm.1833155/,David Higgs,"Hi Greg,Having looked at the Properties of VSPE.SCX (see previous post) I'm not sure how to implementRemoveObject()on the ActiveX (ole control) namedTransceiverin my case. It's probably me being a bit thick!"
Reply,VFP 'unresponsive' for 60 secs when closing MSCOMMLib.MSComm,David Higgs,"Feb 20, 2025 at 1:06 PM",https://www.tek-tips.com/threads/vfp-unresponsive-for-60-secs-when-closing-mscommlib-mscomm.1833155/,Chriss Miller,"It's not an OCX method, it's a VFP method:Code:Thisform.RemoveObject(""Transceiver"")If you put the ocx in a container or page of a pageframe, use the parent object (the container or the page, whatever) and call the RemoveObject method of that, i.e. the RemoveObject() method always only can remove objects directly on the level of the object, Thisform.RemoveObject() can't remove objects within pageframes, containers, etc, just objects directly on the form. As this is no visual control I assume you just put it directly onto the form.It's actually holding on to a straw, but so simple that it's still worth trying. Removing the object is also done when releasing the form, as that removes all objects in the form release, from that persepctive there's nothing to expect from directly and explicitly removing the object. But it still may circumvent something that takes the 60 seconds. In the worst case, if this one RemoveObject takes most of the 60 seconds you actually know and could dig deeper about how to close down the COM port to make the object relese/remove faster. So for that matter measure how long the object removal takes:Code:lnStarttime = Seconds()
Thisform.RemoveObject(""Transceiver"")
lnEndTime=Seconds()
Messagebox(""Tranceiver object removed in ""+Transform(lnEndTime-lnStartTime)+"" seconds.""You already are explicitly doingthisform.transceiver.PortOpen = .F.Well, PortOpen might just be a property to read, not to set, there might be a ClosePort method to do, instead. Whatever is causing the delay in release must have to do with closing connections and resources used by the OCX before it can actually finish. But it also might turn out anything else takes long.If it turns out this does not take long but the form still needs long to release, then you suspected the wrong thing, just because it's the only unusual thing you don't have in other forms. That's would just turn out to be a hasty assumption, but you'll see. Then it would of course be innteresting to find out what takes so long, and SET COVERAGE might tell you that. The only downside is, that it only measures time code takes, so it would summarize all the time the form needs to release on the one line of code THISFORM.Release() and can't give an overview about detail times taken for each form control, unless there is code in destroy events that's also measured. Therefore explicitly removing objects and not letting this be done automatically can point out a bottleneck, as you can measure the time it takes to execute the RemoveObject call."
Reply,VFP 'unresponsive' for 60 secs when closing MSCOMMLib.MSComm,David Higgs,"Feb 20, 2025 at 1:06 PM",https://www.tek-tips.com/threads/vfp-unresponsive-for-60-secs-when-closing-mscommlib-mscomm.1833155/,David Higgs,"Chris,Thank you for your reply; I was nearly there, I'd missed the quotes around Transceiver.When  I ran your code it took 60.025 secs to complete.It's a strange problem because My App runs ok when using a standard Serial Comms Port, the issue only occurs when using a Virtual Serial Port  (VSPE).Code:lnStarttime = Seconds()

Thisform.RemoveObject(""Transceiver"")

lnEndTime=Seconds()

Messagebox(""Tranceiver object removed in "" + Transform(lnEndTime-lnStartTime) + "" seconds."")

SET COVERAGE TO

thisform.Release0.000211,,test.set_freq_7160.click,2,d:\visual fox pro\projects\comms\forms\vspe.sct,10.000173,,test.set_freq_3760.click,2,d:\visual fox pro\projects\comms\forms\vspe.sct,10.000056,,test.closelogbook.click,2,d:\visual fox pro\projects\comms\forms\vspe.sct,160.028075,,test.closelogbook.click,4,d:\visual fox pro\projects\comms\forms\vspe.sct,10.000103,,test.closelogbook.click,6,d:\visual fox pro\projects\comms\forms\vspe.sct,13.790639,,test.closelogbook.click,8,d:\visual fox pro\projects\comms\forms\vspe.sct,10.000042,,test.closelogbook.click,10,d:\visual fox pro\projects\comms\forms\vspe.sct,1"
Reply,VFP 'unresponsive' for 60 secs when closing MSCOMMLib.MSComm,David Higgs,"Feb 20, 2025 at 1:06 PM",https://www.tek-tips.com/threads/vfp-unresponsive-for-60-secs-when-closing-mscommlib-mscomm.1833155/,Chriss Miller,"So line number 4 in the click code is the RemoveObject, right?Is there any code in the VSPE COMM port object Destroy event? I don't assume.Now there's only one thing you can do: Dig into the documentation to find out how you're supposed to close the port and release it as quickly as can be done, i.e. the intended way to tidy up usage of ressources and connections etc. Because that's the only thing that causes that delay, isn't it?You can do a little experimenting in designing a test form only with that OCX control, then don't open a port and just measure how long it takes to release, if that already takes long, it's nothing to do with closing the port. But if that runs fast, that's the baseline of relase time and you should be able to get near there.I alkso wonder if you unintentionally create objects while the form runs and releasing them takes time. So you could just look at Thisform.Objects.Count at init of the form and at release of it to check that out."
Reply,VFP 'unresponsive' for 60 secs when closing MSCOMMLib.MSComm,David Higgs,"Feb 20, 2025 at 1:06 PM",https://www.tek-tips.com/threads/vfp-unresponsive-for-60-secs-when-closing-mscommlib-mscomm.1833155/,Chriss Miller,"David Higgs said:I was nearly there, I'd missed the quotes around Transceiver.Click to expand...On that, learn how to read intellisense information:The c in front of ObjectName tells you that the parameter is a string of the object name, so ""Transceiver"" not Transceiver.Here's a an example in contrast:ADir expects you to write an array name directly, not in quotes. In this case even a name of an array to be created, not one that must alreaddy exist. It can exist and will be overwritten and extended, but that's details off topic. The intellisense has subtle differences, but what oyu need to specify is told to you by, when you know it."
Reply,VFP 'unresponsive' for 60 secs when closing MSCOMMLib.MSComm,David Higgs,"Feb 20, 2025 at 1:06 PM",https://www.tek-tips.com/threads/vfp-unresponsive-for-60-secs-when-closing-mscommlib-mscomm.1833155/,David Higgs,"Chriss Miller said:So line number 4 in the click code is the RemoveObject, right?Click to expand...That's correct.Chriss Miller said:Is there any code in the VSPE COMM port object Destroy event? I don't assume.Click to expand...There is no code (Default) in the Destroy EventChriss Miller said:I alkso wonder if you unintentionally create objects while the form runs and releasing them takes time. So you could just look at Thisform.Objects.Count at init of the form and at release of it to check that out.Click to expand...I created the Test App to have the bare minimum of Code and Code alterations, but I will do the object counts. I will also carry out some more tests as you suggest.I will also pay more attention to the 'intellisense information' now you pointed it out. As you say I should have noticed the 'c' ."
Reply,VFP 'unresponsive' for 60 secs when closing MSCOMMLib.MSComm,David Higgs,"Feb 20, 2025 at 1:06 PM",https://www.tek-tips.com/threads/vfp-unresponsive-for-60-secs-when-closing-mscommlib-mscomm.1833155/,David Higgs,"Chriss Miller said:You can do a little experimenting in designing a test form only with that OCX control, then don't open a port and just measure how long it takes to release, if that already takes long, it's nothing to do with closing the port. But if that runs fast, that's the baseline of release time and you should be able to get near there.Click to expand...I designed a basic form, added an OCX control and a Command Button to close the form. The only thing I changed was the Comm Port to COM 10. I then ran the form and closed it using the Command Button; the Form closed instantaneously. I then ran the form with the Comm Port Open and on closing there was a 60 sec delay.I'm thinking that the issue (whatever it is) maybe due to the fact that I'm trying to close aVirtual Serial Portand not a HardwareSerial COM Port."
Reply,VFP 'unresponsive' for 60 secs when closing MSCOMMLib.MSComm,David Higgs,"Feb 20, 2025 at 1:06 PM",https://www.tek-tips.com/threads/vfp-unresponsive-for-60-secs-when-closing-mscommlib-mscomm.1833155/,Chriss Miller,"I don't see that. But how is the driver configured? If the virtual nature of the port is the reason, does it remove the virtual port when you close it instead of just closing it?I could see why that takes a minute. So if you open up the Device manager and look into (virtual) COM port devices, does it remove ports when you form closes?As you can't see inside the process of removing the MSCOMMLib.MSCOMM control your only way of getting more details will be using procmon to look what runs when your form closes. Logging what procmon can monitor is hard, though. Usually, when you know you look for specific things like file related api calls, you can limit the logging, if you don't know what's done you'd have to go through a full logging. And then the problem also is synchronizing the procmon logging with the closing of the VFP form, starting short before closing and ending logging after the minute it takes. And then going through a minute of log data."
Reply,VFP 'unresponsive' for 60 secs when closing MSCOMMLib.MSComm,David Higgs,"Feb 20, 2025 at 1:06 PM",https://www.tek-tips.com/threads/vfp-unresponsive-for-60-secs-when-closing-mscommlib-mscomm.1833155/,Chriss Miller,"Could it be you have set the COM port into a mode waiting for incoming data? Then closing the port might be delayed in a timeout that seems to be configured to 60 seconds somewhere or by default. Before closing the port, you might need to set/unset some other properties modes of the COM port to be able to close it."
Reply,VFP 'unresponsive' for 60 secs when closing MSCOMMLib.MSComm,David Higgs,"Feb 20, 2025 at 1:06 PM",https://www.tek-tips.com/threads/vfp-unresponsive-for-60-secs-when-closing-mscommlib-mscomm.1833155/,David Higgs,"Chriss Miller said:So if you open up the Device manager and look into (virtual) COM port devices, does it remove ports when you form closes?Click to expand...No, the COM Ports (COM10,COM11) are still showing after VFP Closes.Chriss Miller said:Could it be you have set the COM port into a mode waiting for incoming data?Click to expand...No, I don't think so. I placed the OCX control on the Form with minimal changes.I've just carried a further some further tests using the test form. I now have 4 Command Buttons.Code:* Button 1 - check status of Com Port
MESSAGEBOX(thisform.TestComm.portOpen())

* Button 2 -
thisform.testComm.portOpen= .T.

* Button 3 -
thisform.testComm.portOpen= .F.

* Button 4 -
lnStarttime = Seconds()

Thisform.RemoveObject(""TestComm"")

lnEndTime=Seconds()

Messagebox(""Object removed in "" + Transform(lnEndTime-lnStartTime) + "" seconds."")

thisform.releaseI ran the form, check the status of Com Port (Command Button 1), Opened Com Port (Command Button 2) and then Closed Com Port (Command Button 3). When I clicked Command 3 the 60 sec delay occurred. Next, I click on Command 4 and the form closed instantaneously.So, it would appear that the issue is with changing the status of the Com Port?"
Reply,VFP 'unresponsive' for 60 secs when closing MSCOMMLib.MSComm,David Higgs,"Feb 20, 2025 at 1:06 PM",https://www.tek-tips.com/threads/vfp-unresponsive-for-60-secs-when-closing-mscommlib-mscomm.1833155/,Chriss Miller,"Well, did you try closing the form without closing the com port? I wouldn't expect a difference, becuase the coverage logging already showed the 60 seconds go into removing the object, which always happens.So one ide idea circumventing to remove that object would be to add the MSCOMMlib.MsCOMM object to the screen instead of your form and keep it existing until you quit the application. That will then take 60 seconds.Overall you will need to identify the reason for that timeout of 60 seconds, something is done and not reset that causes a timeout, it seems to me."
Reply,VFP 'unresponsive' for 60 secs when closing MSCOMMLib.MSComm,David Higgs,"Feb 20, 2025 at 1:06 PM",https://www.tek-tips.com/threads/vfp-unresponsive-for-60-secs-when-closing-mscommlib-mscomm.1833155/,David Higgs,"Chriss Miller said:Well, did you try closing the form without closing the com port?Click to expand...Yes, I did and still had the delay.I'm still thinking on the lines that the issue is something to do with Virtual Port sharing. If I use the same Form and Comms setup on Serial Port COM3 there isn't a problem but as soon as I change to Virtual Serial Port COM 10 and use Virtual Port sharing (VSPE) I have the issue. When using Virtual Port sharing with the form open, I'm able to communicate with the Transceiver, it's only when I close the connection that I get the issue.Thank you for your help, I very much appreciated it as I'm a little out of my depth. The VSPE team appear to be very helpful, so, with the results of the various tests I may well seek their opinion and see if they can offer any advice. None this affects the use of my application it's just that I wanted to include another application sharing the Com Port."
Reply,VFP 'unresponsive' for 60 secs when closing MSCOMMLib.MSComm,David Higgs,"Feb 20, 2025 at 1:06 PM",https://www.tek-tips.com/threads/vfp-unresponsive-for-60-secs-when-closing-mscommlib-mscomm.1833155/,Chriss Miller,"Well, the idea to put the MsCommLib.MsComm object to the screen instead of a form still would solve the problem, as this object can stay until you quit the application."
Reply,VFP 'unresponsive' for 60 secs when closing MSCOMMLib.MSComm,David Higgs,"Feb 20, 2025 at 1:06 PM",https://www.tek-tips.com/threads/vfp-unresponsive-for-60-secs-when-closing-mscommlib-mscomm.1833155/,David Higgs,"Chriss Miller said:Well, the idea to put the MsCommLib.MsComm object to the screen instead of a form still would solve the problem, as this object can stay until you quit the application.Click to expand...There lies another problem! When I drag the MsCommLib.MsComm object and drop it on the screen, it disappears off the form but doesn't show on the screen. I have removed SCREEN = OFF from config.fpw but still the same."
Reply,VFP 'unresponsive' for 60 secs when closing MSCOMMLib.MSComm,David Higgs,"Feb 20, 2025 at 1:06 PM",https://www.tek-tips.com/threads/vfp-unresponsive-for-60-secs-when-closing-mscommlib-mscomm.1833155/,tomk3,"Hello,I remember that many years ago we replaced mscomm with scomm32 due to problems on virtual ports (>8). Use was exactly the same (no code change)Later on a friend informed me that its now freeware. Not sure whether its available anymore, we do not need it anymore.Basically you may try another control."
Reply,VFP 'unresponsive' for 60 secs when closing MSCOMMLib.MSComm,David Higgs,"Feb 20, 2025 at 1:06 PM",https://www.tek-tips.com/threads/vfp-unresponsive-for-60-secs-when-closing-mscommlib-mscomm.1833155/,David Higgs,"tomk3 said:Hello,I remember that many years ago we replaced mscomm with scomm32 due to problems on virtual ports (>8). Use was exactly the same (no code change)Later on a friend informed me that its now freeware. Not sure whether its available anymore, we do not need it anymore.Basically you may try another control.Click to expand...Hi Tom, Thank you for your reply.  My App works ok with the Virtual Port COM 10 with the exception of closing the comm port. I will try using a lower port number and see if that helps."
Reply,VFP 'unresponsive' for 60 secs when closing MSCOMMLib.MSComm,David Higgs,"Feb 20, 2025 at 1:06 PM",https://www.tek-tips.com/threads/vfp-unresponsive-for-60-secs-when-closing-mscommlib-mscomm.1833155/,Chriss Miller,"David Higgs said:There lies another problem! When I drag the MsCommLib.MsComm object and drop it on the screen, it disappears off the form but doesn't show on the screen. I have removed SCREEN = OFF from config.fpw but still the same.Click to expand...You can't drop the control on the screen, as you never have the screen in designmode, but you can use _screen.addobject(), just like you can use removeobject."
Question,Copy fields from one table to another,SitesMasstec,"Feb 23, 2025 at 10:22 PM",https://www.tek-tips.com/threads/copy-fields-from-one-table-to-another.1833190/,SitesMasstec,"Hello colleagues!I have 2 tables: Table A has 30 fields and Table B has 34 fields.The 30 first fields in table B are the same (names) in table A. So, Table B has 4 additional fields.How can I select and copy some filtered records from Table A to Table B, without excluding the last 4 fields in Table B?I used the command bellow, the records were correctly copied to Table B, but the structure in Table B became with the same structure in table A, that is, the last 4 fields in Table B were lost...Code:SELECT * FROM TableA.DBF WHERE LOCALIZA=YLOCALIZA ORDER BY CHAVEPAX INTO TABLE TableB.DBFThank you,"
Reply,Copy fields from one table to another,SitesMasstec,"Feb 23, 2025 at 10:22 PM",https://www.tek-tips.com/threads/copy-fields-from-one-table-to-another.1833190/,SitesMasstec,"Yes, I did what EinTerraner advised, and as Doug said, it is the simplest.Code:USE TEMPPAX EXCLUSIVE 
DELETE ALL
PACK
USE

USE TEMPPAX 
APPEND FROM PASSAGEIROS FOR LOCALIZA=YLOCALIZA
USEThe file TEMPPAX has now 2 records after a filter is applied (it can have maximum 5 records):Now, problem is, The Report shows only the first Detail record:This is the report design:What am I missing?Thank you."
Reply,Copy fields from one table to another,SitesMasstec,"Feb 23, 2025 at 10:22 PM",https://www.tek-tips.com/threads/copy-fields-from-one-table-to-another.1833190/,Joe Crescenzi,"Since there are only 4 fields, the simplest thing would be to just put four placeholder values at the end.Just be sure that the placeholders are the same type and size as the ones you need to match the other table.For example:Code:select tableA.*;
    ,space(25) as Missing1;
    ,space(10) as Missing2,
    ,cast(0.00 as N(10,2) as Missing3;
    ,{} as Missing4;
WHERE LOCALIZA=YLOCALIZA ;
ORDER BY CHAVEPAX ;
   INTO TABLE TableB.DBFThis will give you all the columns from TableA, plus the 4 missing columns with placeholders with the correct types and field sizes."
Reply,Copy fields from one table to another,SitesMasstec,"Feb 23, 2025 at 10:22 PM",https://www.tek-tips.com/threads/copy-fields-from-one-table-to-another.1833190/,Doug Lindauer,"If you do that you'll overwrite TableB with the structure from TableA and the contents will only be that of the select statement.You could either do an ""append from"" operation where you first copy the rows out of TableA into a temporary file and then append from the temporary fileorDo a sql insert and  select statement like thisINSERT  INTO TABLEB( field list ) SELECT( matching field list ) FROM TABLEA WHERE LOCALIZA=YLOCALIZAWhen I tried this I found that I couldn't make it work unless both tables were in the default folder but it works.Also I don't understand what you mean by ""without excluding the last 4 fields in Table B"".  TableA doesn't have information for those last 4 fields so they're going to be blank."
Reply,Copy fields from one table to another,SitesMasstec,"Feb 23, 2025 at 10:22 PM",https://www.tek-tips.com/threads/copy-fields-from-one-table-to-another.1833190/,SitesMasstec,"Joe and Doug: I am going to try your solutions now.Table B, with all 34 fields, is already in the Data Environment of a Report, and there is a linking between a field in Table B and another table (let's say Table C). So I cannot generate Table B from Table A.Thank you."
Reply,Copy fields from one table to another,SitesMasstec,"Feb 23, 2025 at 10:22 PM",https://www.tek-tips.com/threads/copy-fields-from-one-table-to-another.1833190/,SitesMasstec,"First, I did this:Code:select * FROM PASSAGEIROS.DBF;
    ,cast(0.00 as N(12,2)) as Missing1;
    ,cast(0.00 as N(12,2)) as Missing2;
    ,cast(0.00 as N(12,2)) as Missing3;
    ,cast(0.00 as N(12,2)) as Missing4;
WHERE LOCALIZA=YLOCALIZA ;
ORDER BY CHAVEPAX ;
   INTO TABLE TEMPPAX.DBFAnd an error appeared in the first line (select * FROM PASSAGEIROS.DBF): Not a character expression"
Reply,Copy fields from one table to another,SitesMasstec,"Feb 23, 2025 at 10:22 PM",https://www.tek-tips.com/threads/copy-fields-from-one-table-to-another.1833190/,Doug Lindauer,"You have to put the ""from"" AFTER the field list as in :select *, ;,  ;,   from PASSAGEIROS where ...Note that doing this creates a new table TEMPPAX so if that's what you want, OK.  It overwrites any existing TEMPPAX file.Also if you want to append the selected records into an existing TEMPPAX you don't need to create placeholders for fields that aren't in PASSAGEIROS.  If you use ""append from"" it will match by field name and suck in the records correctly.Also it would be useful to include more clear details of what you're actually trying to do.  You CAN get too long with descriptions but people almost always never include enough details."
Reply,Copy fields from one table to another,SitesMasstec,"Feb 23, 2025 at 10:22 PM",https://www.tek-tips.com/threads/copy-fields-from-one-table-to-another.1833190/,SitesMasstec,"Ok, Doug, now it works, BUT only the first record appeared in the report (it should show 5 records in the Detail band)."
Reply,Copy fields from one table to another,SitesMasstec,"Feb 23, 2025 at 10:22 PM",https://www.tek-tips.com/threads/copy-fields-from-one-table-to-another.1833190/,Doug Lindauer,Perhaps you're missing a key field in the detail table.  Without seeing everything it's hard to know.  Or maybe you have some filter on in the detail table?
Reply,Copy fields from one table to another,SitesMasstec,"Feb 23, 2025 at 10:22 PM",https://www.tek-tips.com/threads/copy-fields-from-one-table-to-another.1833190/,Joe Crescenzi,"Sorry, that code I wrote was more like pseudocode for an example of how to add some extra columns.Yes, you need a FROM clause, and yes, it will erase the target table, so if you want this to append rows into a target, you don't need to do anything to account for the extra columns, just insert into the second table as Doug pointed out.  It doesn't matter if the target has more columns."
Reply,Copy fields from one table to another,SitesMasstec,"Feb 23, 2025 at 10:22 PM",https://www.tek-tips.com/threads/copy-fields-from-one-table-to-another.1833190/,EinTerraner,"SitesMasstec said:I used the command bellow, the records were correctly copied to Table B, but the structure in Table B became with the same structure in table A, that is, the last 4 fields in Table B were lost...Code:SELECT * FROM TableA.DBF WHERE LOCALIZA=YLOCALIZA ORDER BY CHAVEPAX INTO TABLE TableB.DBFClick to expand...with this ""SELECT FROM ... INTO TABLE"" You'll create a new Table.You can useCode:SELECT TableB
APPEND FROM TableA FOR LOCALIZA=YLOCALIZAalterative You can use the SCATTER / GATHER commands"
Reply,Copy fields from one table to another,SitesMasstec,"Feb 23, 2025 at 10:22 PM",https://www.tek-tips.com/threads/copy-fields-from-one-table-to-another.1833190/,Doug Lindauer,"SitesMasstec said:Ok, Doug, now it works, BUT only the first record appeared in the report (it should show 5 records in the Detail band).Click to expand...Did you ever figure out the problem?BTW EinTerraner is certainly right that ""append from ... for "" is a solution.  It's the simplest."
Reply,Copy fields from one table to another,SitesMasstec,"Feb 23, 2025 at 10:22 PM",https://www.tek-tips.com/threads/copy-fields-from-one-table-to-another.1833190/,ggreen61,What if you select the two tables separately in a UNION clause?  Use place holders in the missing fields for the first table.
Reply,Copy fields from one table to another,SitesMasstec,"Feb 23, 2025 at 10:22 PM",https://www.tek-tips.com/threads/copy-fields-from-one-table-to-another.1833190/,SitesMasstec,"Yes, I did what EinTerraner advised, and as Doug said, it is the simplest.Code:USE TEMPPAX EXCLUSIVE 
DELETE ALL
PACK
USE

USE TEMPPAX 
APPEND FROM PASSAGEIROS FOR LOCALIZA=YLOCALIZA
USEThe file TEMPPAX has now 2 records after a filter is applied (it can have maximum 5 records):Now, problem is, The Report shows only the first Detail record:This is the report design:What am I missing?Thank you."
Reply,Copy fields from one table to another,SitesMasstec,"Feb 23, 2025 at 10:22 PM",https://www.tek-tips.com/threads/copy-fields-from-one-table-to-another.1833190/,EinTerraner,"SitesMasstec said:What am I missing?Click to expand...mby a ""GO TOP IN TEMPPAX"" before you run the report"
Reply,Copy fields from one table to another,SitesMasstec,"Feb 23, 2025 at 10:22 PM",https://www.tek-tips.com/threads/copy-fields-from-one-table-to-another.1833190/,SitesMasstec,"Ein, it doesn't work, either (USE TEMPPAX....   GOTO TOP), before running the report."
Reply,Copy fields from one table to another,SitesMasstec,"Feb 23, 2025 at 10:22 PM",https://www.tek-tips.com/threads/copy-fields-from-one-table-to-another.1833190/,EinTerraner,as much as i see here you have only the plain fieldnames in the report.change them to TEMPPAX.fieldname (i.e.TEMPPAX.tarimarbr)
Reply,Copy fields from one table to another,SitesMasstec,"Feb 23, 2025 at 10:22 PM",https://www.tek-tips.com/threads/copy-fields-from-one-table-to-another.1833190/,SitesMasstec,"Yes, Ein, all the fields in the Detail2 of the Report have TEMPPAX. in front of the field name:"
Reply,Copy fields from one table to another,SitesMasstec,"Feb 23, 2025 at 10:22 PM",https://www.tek-tips.com/threads/copy-fields-from-one-table-to-another.1833190/,EinTerraner,"SitesMasstec said:Code:Code:USE TEMPPAX EXCLUSIVE
DELETE ALL
PACK
USE

USE TEMPPAX
APPEND FROM PASSAGEIROS FOR LOCALIZA=YLOCALIZA
USEClick to expand...just saw it now... You're closing the TEMPPAX right after the append.i hope so You open the TEMPPAX before run the report and make sure it's selected likeCode:USE TEMPPAX
SELECT TEMPPAX
REPORT FORM.....is there any code in the beginning of the report?"
Reply,Copy fields from one table to another,SitesMasstec,"Feb 23, 2025 at 10:22 PM",https://www.tek-tips.com/threads/copy-fields-from-one-table-to-another.1833190/,Chriss Miller,"The main report driving workarea is driving the main detail band, detail1, why do you have a detail2 band? Why is everything in detail2? You act against the simplest report principle. A report mainly is about the main inital detail band."
Reply,Copy fields from one table to another,SitesMasstec,"Feb 23, 2025 at 10:22 PM",https://www.tek-tips.com/threads/copy-fields-from-one-table-to-another.1833190/,SitesMasstec,"This is the code, Ein:Code:USE TEMPPAX EXCLUSIVE 
DELETE ALL
PACK
USE

USE TEMPPAX 
APPEND FROM PASSAGEIROS FOR LOCALIZA=YLOCALIZA
USE

YWTOTMARBR = 0.00
YWTOTMARUS = 0.00
YWTOTAERBR = 0.00
YWTOTAERUS = 0.00

USE TEMPPAX
GOTO TOP

DO WHILE NOT EOF()
    * Total Maritimo BR do Passageiro
    YWTOTMARBR = tarimarbr + tpormarbr + tranmarbr + servmarbr
    REPLACE WTOTMARBR WITH YWTOTMARBR

    * Total Maritimo US do Passageiro
    YWTOTMARUS = tarimarus + tpormarus + tranmarus + servmarus
    REPLACE WTOTMARUS WITH YWTOTMARUS

    * Total Aéreo BR do Passageiro
    YWTOTAERBR = tariaerbr + tembaerbr
    REPLACE WTOTAERBR WITH YWTOTAERBR

    * Total Aéreo US do Passageiro
    YWTOTAERUS = tariaerus + tembaerus
    REPLACE WTOTAERUS WITH YWTOTAERUS
    
    SKIP
ENDDO
USE

* ------------------------------------------------------------------------------------
USE TEMPPAX
SELECT TEMPPAX

SET REPORTBEHAVIOR 90     && Necessário para mostrar termo MARÍTIMO rotacionado a 270 graus
REPORT FORM RELATRESERVAS7 FOR LOCALIZA=YLOCALIZA TO PRINTER PROMPT PREVIEW    && era RELATRESERVAS4, sem as linhas acima
SET REPORTBEHAVIOR 80
thisform.release()
RETURN"
Question,Can NOUPDATE prevent a DBF corruption,ajenat,"Feb 23, 2025 at 8:31 PM",https://www.tek-tips.com/threads/can-noupdate-prevent-a-dbf-corruption.1833189/,ajenat,"HiI am wondering, can we prevent a dbf table from corruption (headers) by using it with NOUPDATE (readonly) if I don't need write access."
Reply,Can NOUPDATE prevent a DBF corruption,ajenat,"Feb 23, 2025 at 8:31 PM",https://www.tek-tips.com/threads/can-noupdate-prevent-a-dbf-corruption.1833189/,Chriss Miller,"Well, corruptions only happen when changing a dbf, so when writing. By just reading you'll never corrupt a dbf. So you don't need the NOUPDATE clause. If you use it, you will just ensure there are no changes possible and would identify any code or control (and user interaction with it) that tries to change a record."
Reply,Can NOUPDATE prevent a DBF corruption,ajenat,"Feb 23, 2025 at 8:31 PM",https://www.tek-tips.com/threads/can-noupdate-prevent-a-dbf-corruption.1833189/,Paul Gibson,"I agree with Chriss in that it seems fairly redundant for the specific purpose you are describing but also be aware that if you aren't 100% certain that the table you are opening is only ever read from and you start to open it with NOUPDATE then you are also introducing an extra potential for a crash or crashes and that means you may have to regression test your application or at least do some strenuous searching of the source code.Any writes to a table that has been opened with NOUPDATE will cause an Error 111 Cannot Update the cursors ""x"", since it is read-only.In short, NOUPDATE won't give you the specific protection you are looking for plus if you do write to the table at some point and you just didn't spot it you've now sown the seeds for an Error 111."
Reply,Can NOUPDATE prevent a DBF corruption,ajenat,"Feb 23, 2025 at 8:31 PM",https://www.tek-tips.com/threads/can-noupdate-prevent-a-dbf-corruption.1833189/,igorsandler,"ajenat said:HiI am wondering, can we prevent a dbf table from corruption (headers) by using it with NOUPDATE (readonly) if I don't need write access.Click to expand...Keep in mind the size of the table. Reaching 2GB will corrupt the table permanently"
Reply,Can NOUPDATE prevent a DBF corruption,ajenat,"Feb 23, 2025 at 8:31 PM",https://www.tek-tips.com/threads/can-noupdate-prevent-a-dbf-corruption.1833189/,Chriss Miller,"Paul Gibson said:plus if you do write to the table at some point and you just didn't spot it you've now sown the seeds for an Error 111.Click to expand...But that's also a chance to find places where there is unintentional changes to the DBF that were the cause of earlier corruptions. Also with just reading a table you cannot prevent all errors, anyway. If a table already is corrupt using it won't  do a complete health check of the DBF, in short VFP checks whether the record count that's stored in the table matches the expected size oif the dbf file that is HEADER()+RECCOUNT()*RECSIZE(), essentially. Maybe +1 for an EOF byte or plus some more, you can easily find out on healthy tables how that calculation turns out exactly the file size. But you never have a check which verifies every byte for validity in the corresponding context.What's never checked is if all memo pointers to the FPT file are pointing to correct places, that all index trees are intact and no node points to non existant records, there could be illegal values in the file bytes that store a fields value, and several more problems. You only step upon corruptions when they affect what you want to read, so corruptions can actually exist for a week, month, even longer, as long as you never try read some specific memo, the corruption doesn't surface.It's not that corruptions due to problems of writing to a file are actually immediately detected at that point, otherwise you would always have the actual creattion of a defect reporting itself. Corruptions occur, because VFP assumes what it didi did effect the file as intended, but the file system failed, the network failed and still reported success, for example.If you want to avoid file corruptions of dbfs and their related files, the only way to do that is to use another database.What you can do as precautions is regularly removing deleted records with PACK - needs exclusive access, though. Regularly reindexing the table - with caution when there could be CDX header corruptions that changed the index expression. If there are, you'd have broekn index nodes anyway and need a reindex based on the actually planned index expression, no matter if this is just a basic expression of a field only or an expression combining several fields into one index tag. The recommended recipe for reindexng therefore is storing the meta data about what index tag names and index expressions and index types (primary, regular, candidate, binary) should exist somewhere separate - metadata, and then DELETE TAG ALL and run the necessary indexing commands. Since you can do that, once you take care of storing the index meta data, index corruptions are all fixable, data (in dbf and fpt) that's lost os lost, unless you have frequent enough backups. Index corruptions happening often can still be a PITA, as the recoverability of the indexes is not something you do on the fly on large tables, so all these measures of keeping the data as shrinked as it can be with bloat removed from dbf, fpt and cdx files, you get less problems, but you don't have any chance to get them to a guaranteed 0%, that's never possible with any database, but you can get to better results with a database server in that aspect."
Reply,Can NOUPDATE prevent a DBF corruption,ajenat,"Feb 23, 2025 at 8:31 PM",https://www.tek-tips.com/threads/can-noupdate-prevent-a-dbf-corruption.1833189/,Chriss Miller,"I assume you ask for a reason, and that may be that you have a case where the data exists to drive something, like a dictionary for a grammar checker, so you don't need updates for this data, at least not as regularly as it would be in case of a shop database, as a very common example. There's a similar, yet not idential differentiation with the terms of OLAP vs OLTP.If you're after a way of using DBFs read only the simplest thing is making the files readonly by the readonly attribute, though it doesn't need high priviledges on a file to change the attributes and be able to write, too, the best way to make DBFs (and FPT/CDX, perhaps IDX, secondary CDX) available read only is setting file permissions to read only, that can't be changed that easily, especially when the users are not the file owners, i.e. don't create the DBFs on the fly but you setup a database administratevly where all files and the data directory exist under an owner the users can't be and their premissions are read only, of course. Besides the other obvious possibility: Storing them on read only storage, like CDs, which makes access much slower, though. If you do that, it's possible to ensure all data files to be verified in all their bits, quite literally, and besides ensuring they are unchanged by file access limitations, you can store and verify checksums.If you're not mainly after readonly data but after avoiding defects, then the best way is to make use of data maintenance routines, starting with backups and then essentially all the precautions I mentioned in my previous post."
Reply,Can NOUPDATE prevent a DBF corruption,ajenat,"Feb 23, 2025 at 8:31 PM",https://www.tek-tips.com/threads/can-noupdate-prevent-a-dbf-corruption.1833189/,Paul Gibson,"Chriss Miller said:If you want to avoid file corruptions of dbfs and their related files, the only way to do that is to use another database.Click to expand...100% agree, it is my biggest regret in the main VFP application I manage that the previous developers didn't leave any hope for ever migrating to a different database, short of completely rewriting the application from scratch and that's not really possible because the application is gargantuan.  For this app, its age means it is no surprise to find database code is written at every level/layer.  Calling it a spider's web would be giving the current level of separation a fake description of organisation, a rat's nest is definitely more accurate.  I longed to migrate to another database, not just to reduce the chances of corruption, thankfully that's rare enough, but for things like easier updates when not needing exclusive access to DBFs, but it's just not possible for us, in this app.As such, I've had many years experience dealing with different types of corruption that can happen in a networked VFP app that uses DBFs by opening them over the network.There is corruption, then there is corruption.  Corruption could mean anything but happily it's rare and even when it does happen we only see a few variations.  Thankfully the easiest one to deal with is by far the most common, certainly for us.  The old record count in the file header, not matching the actual total number of records.  In our application we have a formal utility for users to go through to fix that kind, it's quite nice, even if I do say so myself.The utility checks the header to see if that is a problem and if so zips up the DBF, CDX, FPT (where applicable) as a backup, then fixes the header to match the correct total before checking the table again.  If the table can now be opened it deletes the backup zip and if not tells the user to get us involved and we'll download the zip and examine things and sort from there.I'm grateful that probably more than 95% of the corruption our users face is easily fixed with that one utility.  If it is not that, if it's one or more indexes that have gone bad we have a reindex facility which goes through the tables, tearing the indexes down and rebuilding them from scratch.  That does require user downtime but if it is needed then that's better than working with bad tables.  There isn't really a 100|% reliable way to check for bad indexes so we have to use other ways of detecting if unexpected behaviour of the application could be due to an index not working as expected.  It's never easy for that one.The killer though is that memo corruption that you mentioned, mainly because of the reason you stated, it can be a sleeper problem that only raises it's head long after the problem happened in the first place.  This can mean that backups are not viable.  The corruption might not even make the application crash, depending on the form of the corruption that application may continue to operate as if there is no problem, just outputting garbage instead of the correct memo text.  That's definitely a more difficult form of corruption to rectify.We have a tool, FoxFix, which we sometimes use when our own efforts are to no avail and thankfully it is sometimes years between occasions where we need to do that.  As long as our users have robust networks and robust power supplies the frequency of corruption events that we're made aware of is rare and I continually cross my fingers that it stays that way."
Reply,Can NOUPDATE prevent a DBF corruption,ajenat,"Feb 23, 2025 at 8:31 PM",https://www.tek-tips.com/threads/can-noupdate-prevent-a-dbf-corruption.1833189/,Chriss Miller,"Paul Gibson said:This can mean that backups are not viable.Click to expand...Truly a problem, you can reduce that problem by using a rotation scheme like grandfather-father-son backups. Ideally VFP would be transactional, so every state, especially every healthy state of single records is kept so you could always at least get back to the last healthy state."
Reply,Can NOUPDATE prevent a DBF corruption,ajenat,"Feb 23, 2025 at 8:31 PM",https://www.tek-tips.com/threads/can-noupdate-prevent-a-dbf-corruption.1833189/,ajenat,"Thanks everyone for your reply..Chriss, I store index expressions in a reindex program which, when executed, removes cdx files and creates new files.Index files can be checked on starting and recreated if required.I am searching of preventing my data from damage where index file corruption isn't important because it can be recreated by a program on a single click or on next start."
Reply,Can NOUPDATE prevent a DBF corruption,ajenat,"Feb 23, 2025 at 8:31 PM",https://www.tek-tips.com/threads/can-noupdate-prevent-a-dbf-corruption.1833189/,ajenat,"Paul Gibson said:... In our application we have a formal utility for users to go through to fix that kind, it's quite nice, even if I do say so myself.Click to expand...Can you please share it"
Reply,Can NOUPDATE prevent a DBF corruption,ajenat,"Feb 23, 2025 at 8:31 PM",https://www.tek-tips.com/threads/can-noupdate-prevent-a-dbf-corruption.1833189/,Chriss Miller,"If your concern for data loss means you're looking for the kind of seamless recording of the data history as transactional databases log them, the feature to use is index/update/delete triggers. It will require to have a DBC. When using free or legacy DBFs in a legacy software your best bet is on more frequent backups and in that case more in the nature of live backups of any change. Windows offers monitoring file changes with WMI (in more detail WQL notification queries on file creation, modification and deletion events. Well, in case of DBFs mainly the modification events. When doing it that way you don't have the insider knowledge about what actually changed in the DBF, so the triggers are clearly the simpler way of establishing that, as any trigger code starts with the workarea affected and the record affected being the current record pointer in the current workarea, i.e. you can't get better to the point of change, the downside of a trigger is that it happens for every single record, i.e. you have a lot of trigger calls also for batch operations like an APPEND, whereas file modification event notifications can be configured to be monitored within an interval of time, which means you get at most one call every interval. The interval, of course, also becomes the precision of backup, if you call it that, i.e. not every single change is cared for.All this, no matter what feature you use, obviously can itself cause concurrency problems, even though these triggers and notification monitoring will not need readwriteaccess(sorry, read, not write I already was at the second half of the thought), but would write their log information or actual record backups into other files, ideally not even part of the original database. They will still cause any data modifications to slow down write performance.One major disadvantage of doing it with mechanisms from outside the client that does the changes is that locks and transactions hinder you to see changes you want to ensure are getting into a transaction log, so triggers are surely the best thing you can use as they happen from inside of VFP. And not only that, they happen on the client triggering the change, so you have access to buffered yet not committed changed data and the state of data within a transaction, if there is one."
Reply,Can NOUPDATE prevent a DBF corruption,ajenat,"Feb 23, 2025 at 8:31 PM",https://www.tek-tips.com/threads/can-noupdate-prevent-a-dbf-corruption.1833189/,tomk3,"I recommend to switch to CS database, too. We did that with remote views which can be USEed and INDEXed like tables on startup, then we optimized it with where clauses,...Another approach might be to switch to a remote solution (MSTSC, TSPLUS) and run the app on the server with the dbfs"
Question,Better way to install VFP9+Innosetup application?,Vince Wen,"Feb 20, 2025 at 5:51 PM",https://www.tek-tips.com/threads/better-way-to-install-vfp9-innosetup-application.1833160/,Vince Wen,"I have a VFP9 application that uses Inno Setup as its installer. I am facing a challenge because most of our users install the application on a network server. The issue arises because Inno Setup cannot recognize mapped drives when elevated privileges (admin rights) are required during installation. As a result, users must install the application using the UNC share name.Unfortunately, many of our users are not technically savvy leading to a constant stream of support calls for assistance with installing the application to the correct UNC share location.My question is: Is there a better way to handle this situation? I can't be the only one dealing with this issue in a FoxPro application using Inno Setup. I would appreciate any ideas or workarounds that others in the community might have.Additional Note:- After the initial installation, the Inno Setup wizard can prepopulate with the previously installed path (the correct UNC share name). However, due to changes in personnel or computers, users often do not use the same computer for updates each year.- We have a new version released each year which must be installed in the same location each year. Making this a recurring problem.Thanks in advance,Vince"
Reply,Better way to install VFP9+Innosetup application?,Vince Wen,"Feb 20, 2025 at 5:51 PM",https://www.tek-tips.com/threads/better-way-to-install-vfp9-innosetup-application.1833160/,Jeremy H,"Well, if you knew what the unc share path was, you could create a cmd file that would map the drive in the administrator context, and then run the installer. It might need to be created for each customer, but then they could run the cmd file As Administrator, and it would work.You might be able to create a program that would run in the user context and collect the drive mappings, and either store them for the install program, or have it create the cmd ""wrapper"" that would run in the administrator context, and remap the drives."
Reply,Better way to install VFP9+Innosetup application?,Vince Wen,"Feb 20, 2025 at 5:51 PM",https://www.tek-tips.com/threads/better-way-to-install-vfp9-innosetup-application.1833160/,Vince Wen,"Unfortunately, we have too many customers to create individually..."
Reply,Better way to install VFP9+Innosetup application?,Vince Wen,"Feb 20, 2025 at 5:51 PM",https://www.tek-tips.com/threads/better-way-to-install-vfp9-innosetup-application.1833160/,Chriss Miller,"If possible you could start a secondary EXE that acutally requires no elevation and thus runs in the user context, which could have the dialog to chooss the drive letter and determine the UNC path for it, as is necessary for the main setup process.Because when you map a network share you can choose three options:1. Reconnect at sign-in2. Connect using different credentials3. Connect to a website that you can use to store documents and picture (OneDrive, I think not only one drive, also any FTP connection)Well, The first option is the usual one and tells you that mappings are only reestablished at sign in of users. That means you can't get at them. But a process running under the normal user account - therefore actually enforcing no elevation for a helper exe, could see that and then store it from wher the setup can pick it up. This idea still requires the user that has the mappings to start the setup and elevate from there, but software installation might be done by an admin or by software configuration management be assigned to clients, which means you can't rely on a helper exe to see the mappings, necessarily.There could be a simpler way, yet. Simpler? Well, at least with more control on your side and more options on top of that. It's based on what you already have:Vince Wen said:- After the initial installation, the Inno Setup wizard can prepopulate with the previously installed path (the correct UNC share name). However, due to changes in personnel or computers, users often do not use the same computer for updates each year.Click to expand...I assume this prepopulation works, as you store that information somewhere local, llike the registry, where it can be found next time. But only on the same client.Well, so store it on your website for each company, retrieve it from there. It would obviously require the setup to be able to know the company. But instead of knowing or determining that you could ask for entering a registration key during setup, which you hand out and keep uniquely different for different companies but the same for the same company, which indirectly identifies the company. You could also use it for licensing purposes and against software piracy, but it would simply give you a unique identifier to retrieve whatever set of data you want to know from the previous/initial setup, as you store that associated with the registration key as id during the initial setup, any upgrade setup and then get at it again in the current setup. Not finding something stored on your website would idenntify an initial setup, well, or someone trying piracy.Obviously this change requires two iterations, next time to be established to then be used the following time, but as it offers more options, I think it would be worth it, wouldn't it?"
Reply,Better way to install VFP9+Innosetup application?,Vince Wen,"Feb 20, 2025 at 5:51 PM",https://www.tek-tips.com/threads/better-way-to-install-vfp9-innosetup-application.1833160/,Vince Wen,"Thanks Chriss,  I have gone with your first suggestion.  Basically have innosetup call a helper.exe to retrieve UNC path.  I got it to work (mostly).  Thank you.Your second suggestion has the benefit of solving some of our other problems.  It will take a bit more thought, but the main issue is it requires us to be SOC2-type2 compliant due to web services required.  Which is a pain..."
Question,Sum of values in a Report Detail band,SitesMasstec,"Feb 21, 2025 at 11:07 PM",https://www.tek-tips.com/threads/sum-of-values-in-a-report-detail-band.1833174/,SitesMasstec,"Dear colleagues:I have a report which displays values from some records (parent + child):Now I need to calculate some total values, as shown in the above red squares.In a Form, I displayed these total values after calculating them in the Form, Init procedure, but in a Report... I do not know what to do from this point:Of course I need the  (first) variable TotalMarBR = tarimarbr + tpormarbr + tranmarbr + servmarbrThank you."
Reply,Sum of values in a Report Detail band,SitesMasstec,"Feb 21, 2025 at 11:07 PM",https://www.tek-tips.com/threads/sum-of-values-in-a-report-detail-band.1833174/,Steve Yu,"SitesMasstec said:Dear colleagues:I have a report which displays values from some records (parent + child):View attachment 1781Now I need to calculate some total values, as shown in the above red squares.In a Form, I displayed these total values after calculating them in the Form, Init procedure, but in a Report... I do not know what to do from this point:View attachment 1782Of course I need the  (first) variable TotalMarBR = tarimarbr + tpormarbr + tranmarbr + servmarbrThank you.Click to expand...For starter, you will have to move the total variables out of the detail band."
Reply,Sum of values in a Report Detail band,SitesMasstec,"Feb 21, 2025 at 11:07 PM",https://www.tek-tips.com/threads/sum-of-values-in-a-report-detail-band.1833174/,SitesMasstec,Steve: I need to display the total values in places shown. I cannot move these totals to another band.
Reply,Sum of values in a Report Detail band,SitesMasstec,"Feb 21, 2025 at 11:07 PM",https://www.tek-tips.com/threads/sum-of-values-in-a-report-detail-band.1833174/,Jeremy H,"You can create report variables, and do your totaling there. Then, display the variable values where you want.That said, if you are trying to total records which are not part of the report, that gets complicated."
Reply,Sum of values in a Report Detail band,SitesMasstec,"Feb 21, 2025 at 11:07 PM",https://www.tek-tips.com/threads/sum-of-values-in-a-report-detail-band.1833174/,Steve Yu,"SitesMasstec said:Steve: I need to display the total values in places shown. I cannot move these totals to another band.Click to expand...If the totals are for each detail record then you'll have to use (tarimarbr + tpormarbr + tranmarbr + servmarbr), which I assume are data fields, instead of TotalMarBR.To do that, insert a field type in detail band after 'Totals:' and use the expression to define the total you wanted:"
Reply,Sum of values in a Report Detail band,SitesMasstec,"Feb 21, 2025 at 11:07 PM",https://www.tek-tips.com/threads/sum-of-values-in-a-report-detail-band.1833174/,SitesMasstec,"Yes, Steve, good, it works fine. As the values are from a table, I had to explicit them:The child table can have 5 records for this reports. And in the end there must be Grand Totals for these total values.Total variables would be a better solution, but if it's not possible. let's do this way.Thank you."
Reply,Sum of values in a Report Detail band,SitesMasstec,"Feb 21, 2025 at 11:07 PM",https://www.tek-tips.com/threads/sum-of-values-in-a-report-detail-band.1833174/,Steve Yu,"SitesMasstec said:Yes, Steve, good, it works fine. As the values are from a table, I had to explicit them:View attachment 1784The child table can have 5 records for this reports. And in the end there must be Grand Totals for these total values.Total variables would be a better solution, but if it's not possible. let's do this way.Thank you.Click to expand...You know you can have grand totals at the end too, correct ?Just in case, the grand totals can be coded in group footer, outside and after detail band, in similar coding to detail band."
Reply,Sum of values in a Report Detail band,SitesMasstec,"Feb 21, 2025 at 11:07 PM",https://www.tek-tips.com/threads/sum-of-values-in-a-report-detail-band.1833174/,SitesMasstec,"Ok, Steve, I will try to use Group Footer later.So, I am curious about what is this ""Variables"" tab in the Report properties for, bellow?"
Reply,Sum of values in a Report Detail band,SitesMasstec,"Feb 21, 2025 at 11:07 PM",https://www.tek-tips.com/threads/sum-of-values-in-a-report-detail-band.1833174/,Steve Yu,"SitesMasstec said:Ok, Steve, I will try to use Group Footer later.So, I am curious about what is this ""Variables"" tab in the Report properties for, bellow?View attachment 1785Click to expand..."
Reply,Sum of values in a Report Detail band,SitesMasstec,"Feb 21, 2025 at 11:07 PM",https://www.tek-tips.com/threads/sum-of-values-in-a-report-detail-band.1833174/,Steve Yu,"Sorry, that's all I know.Help, anyone ?"
Reply,Sum of values in a Report Detail band,SitesMasstec,"Feb 21, 2025 at 11:07 PM",https://www.tek-tips.com/threads/sum-of-values-in-a-report-detail-band.1833174/,mjcmkrsr,"Hi,Below a demo with 4 cursors to show how to calculate values per record(s), the group(s) footer(s) and the total on the last page footer.hthMarK"
Reply,Sum of values in a Report Detail band,SitesMasstec,"Feb 21, 2025 at 11:07 PM",https://www.tek-tips.com/threads/sum-of-values-in-a-report-detail-band.1833174/,igorsandler,"SitesMasstec said:Dear colleagues:I have a report which displays values from some records (parent + child):View attachment 1781Now I need to calculate some total values, as shown in the above red squares.In a Form, I displayed these total values after calculating them in the Form, Init procedure, but in a Report... I do not know what to do from this point:View attachment 1782Of course I need the  (first) variable TotalMarBR = tarimarbr + tpormarbr + tranmarbr + servmarbrThank you.Click to expand...Maybe I am missing something but if you have the totals already calculated on the form, then you don't need any report totals, just correct groupings on report and display form totals as a variables. Otherwise, you will need to create multiple groupings on the report and create report totals for each group"
Question,Switching between forms in an application,AndrewMozley,"Feb 19, 2025 at 8:52 PM",https://www.tek-tips.com/threads/switching-between-forms-in-an-application.1833141/,AndrewMozley,"This application has a ribbon menu which allows the user to have several forms visible at the same time.For example, a user could be entering a sales invoice for a product, but he may wish to find out what this customer – or another customer – paid last time; or what deliveries of the product are expected.In the present case the user is entering a Sales Invoice (form Salinvoice.scx), but he has another form open which uses the customer table (XCUST.dbf), and that other form may have a particular customer record locked, because he is altering various value for that customer on the screen.On the Sales invoice form, the customer has entered all the details – products & prices &c, maybe some comments. He is ready to post the invoice to the Sales Ledger, and Clicks on aPostbutton.The Salinvoice form needs to add records to several tables in the Sales and Nominal ledgers, but it also needs to update a couple of fields in the XCUST table.For that purpose it needs to RLOCK that particular record.  When that fails, the application displays a MessageBox, inviting the user (if it is him!) to unlock that record or to abandon the transaction.If he decides to unlock the record, I would like the user to be able to click on the Customer Maintenance form (which is on the screen) and Save or Abandon the Edit which he was doing.Unfortunately it seems not to be possible to switch from Salinvoice.frx while its MessageBox is displayed. Would be grateful for guidance on the best way to set about this.Thank you.  Andrew Mozley"
Reply,Switching between forms in an application,AndrewMozley,"Feb 19, 2025 at 8:52 PM",https://www.tek-tips.com/threads/switching-between-forms-in-an-application.1833141/,Chris Miller,"Message boxes are modal, they are the only form selectable when they are displayed, no matter from where they are started. That's the first simple fact.I wonder if you're mixing up things, as you talk of a salesinvoice scx and frx, that's two completely different things. a Report preview window has the same modal nature, you first have to deal with the report preview, either print or cancel printing or, if you added other buttons to the preview toolbar as foxypreviewer allows, save as some file type. Only after that you can go about handling anything else.If you just have several forms and a message box. The situation is solvable after the message box has been answered, so what actually is your problem after knowing that? Maybe even just running a message box, you could instead run your own form designed like a messagebox that you can make non-modal. And in general, to be able to switch forms, don't design them as modal. But no, that's not really the answer.As you actually only need to switch from edit mode then put that functionality in a business class the form uses and you can use from anywhere else, too, without the need to a) activate the form and b) do this interactively. The way you talk about it you locked your own code out of being able to do something that's only available by interaction with a form that you can't switch to, because you step on your own foot with a message box and/or report preview and know nothing about modality. Keep control about what you want you and your code to be able to do.In the core you want to unlock a record, you have the code to do so in a form button click and therefore you think its best to switch to that form. No, it's best to redesign your code so the unlocking of records is not only available in the button click of a form, but in the business class of a table that can be used on a form and elsewhere to be able to call things like locking/unlocking data from anywhere and not be dependent on a single form to offer that functionality. It is good to program something in one place only, but the best place is not intertwined with the UI in one form, as you see for yourself in your current situation. And once something is programmed in one place, in a class, usually, that is available in multiple instances. You have some dependencies, i.e. you can't unlock a record in another datasession, but you don't depend on a button click, if you design your software correctly."
Reply,Switching between forms in an application,AndrewMozley,"Feb 19, 2025 at 8:52 PM",https://www.tek-tips.com/threads/switching-between-forms-in-an-application.1833141/,Chriss Miller,"I don't think you need to learn how to programmatically switch forms, but for sake of completeness, if someone comes across this thread by searching for form activation:1. Having a form reference (oForm, type ""O"", a variable of the form object) you can call oForm.Show()2. You can set focus to a control of the form, thereby activating not only the form itself and whatever was the last current control on it becomes focussed again, but you explicitly set focus to some control, for example the button for leaving edit mode in your case3. You can use Windows API based on Windows HWND, knowing the oForm.HWND integer value using ShowWindow API function.Code:#Define SW_RESTORE 9
DECLARE INTEGER ShowWindow IN user32;
    INTEGER hwnd,;
    INTEGER nCmdShow
ShowWindow(oForm.hwnd, SW_RESTORE) &&for example when a form is maximized or minimized puts it into the normal state, there are further SW constants4. Another way of using the Window API with a HWND is sending the WM_ACTIVATE message to the form to activate with SendMessage.Code:#Define WM_ACTIVATE 6
DECLARE INTEGER SendMessage IN user32;
    INTEGER hWnd,;
    INTEGER Msg,;
    INTEGER wParam,;
    INTEGER lParam
SendMessage(oForm.hwnd,WM_ACTIVATE,1,0)5. Yet other ways with Windows API are calls to SetForegroundWindow and BringWindowToTop. I spare to detail this, you can find necessary DECLARE and usage example onhttps://github.com/VFPX/Win32APIIf you only know the forms name or caption you may go through _screen.forms to find your form and then get it's object reference and hwnd from there.None of that would work when a modal form is active, i.e. the message box or report preview. Such modal state forms have to be responded to and thereby released, before any other form can be activated.You don't need as many options as listed, but anyone of them can come in handy. If you programmed into Show you might have code there you expected to run only once at form start, when you do something along the lines of oForm = createobject(""form"") and oForm.Show() and never use Show again. Show is not only the opposite of Hide, so it does not only make a form visible for the first or repeated time after hiding it, it also activates it. And it is a method, not an event. Form.Activate is an event, not a method on the other hand, and calling oForm.Activate does not activate the form, unless you write code into the event that activates the form, which would be counter productive, as that triggers itself, in the worst case. If you made a design flaw you can, at least, use one of the other ways."
Reply,Switching between forms in an application,AndrewMozley,"Feb 19, 2025 at 8:52 PM",https://www.tek-tips.com/threads/switching-between-forms-in-an-application.1833141/,ggreen61,"I have a similar application with a tab interface for selecting between forms:The first row allows the user to select between different tab groups.  The second row allows a user to open a form into the group's tab interface.   When the user selects a command button to open a popup child form (over the current form), I use an image class to 'cover' over the current form by taking a screen shot of the parent form and using alpha blending to darken the image, then I set the Visible property to False for all the controls, thus leaving the parent form darkened in the background of the popup child form.  The popup child form is always non-modal and linked to the parent form by using the NAME clause on the DO FORM command and assigning it to a property of the parent form (ChildForm).  The image class if clicked on will redirect the user back to the popup child form via the ChildForm property of the parent form.  This keeps the popup child non-modal form in focus for the parent.  When the child form closes, I restore the parent form back to normal appearance.  I use the RAISEEVENT command to pass parameters from the child form back to the parent form.The class for the tab interface takes care of switching between tabs (hiding the appropriate forms and making the selected tab form visible), destroying the associated form (which in turn destroys the child form if present) when the tab is closed, and creating a new tab and positioning the form."
Reply,Switching between forms in an application,AndrewMozley,"Feb 19, 2025 at 8:52 PM",https://www.tek-tips.com/threads/switching-between-forms-in-an-application.1833141/,Chriss Miller,"AndrewMozley said:For that purpose it needs to RLOCK that particular record. When that fails, the application displays a MessageBox, inviting the user (if it is him!) to unlock that record or to abandon the transaction.Click to expand...Actually, if you have an RLOCK, you already have an RLOCK. And an open transaction is only a problem as the user later might revert it, undoing any changes you do for the salesinvoice. Well, you're using transactiona wrong, then. A transaction should start right before saving changes not when starting to edit a record already. To be able to revert a change you must use buffering, not a transaction. I say must, not can, because the point of a transaction is not the same as that of buffering and you're misusing transactions, if you start them at the start of an editing mode.The usage pattern mandatorey for a transaction is starting it in a submit/save changes button, then saving all changes (usually doing several tableupdates to save buffered changes, but can also include any insert/updates/replaces only happening then) and when everything goes through end the transaction, when anything fails rollback the transaction and address the problems.Locking records can be done before starting a transaction and as the first thing in edi mode to actually prepare a flawless transaction, as other clients/forms/users will then know the record is in editing. But once that's done you already have the ownership of that and on the same client you can also make use of that to do anything else in other processes like that of a sales invoice done during editing of a customer record if the involved customer.If you do it as I suggest your only remaining problem is how you detect that it's not the current user that has the lock. I think you is ISRLOCKED to determine the lock status and if that's .F. ask to unlock. Well, that's wrong. Use RLOCK and see, if you can lock, if you already have the lock, that doesn't cause double locking needing double unlocking, it just confirms you have the lock, either you just got it now or you already had it. It'll fail, if another user had the lock. And then you can only tell the user, that the sales invoice can't be completed.Well, and that's the other flaw of your design, if you alrady know from the getgo that a salesinvoice needs a record lock on the customer involved, then get this rlock early on, at the start. Then it doesn't hinder the same user to also access edit mode for the customer to look up information from there, but it locks out other users from both sales invoices from the same customer and editing the customer and you can be sure you get to the end of processing the sales invoice.I'm not really a fan of locking data to ensure such record by recored exclusive access, as everything can be done intertwined with shared access not locking anything, but when you go that route, and I also did for a company that asked for such a policy you also have to care about users leaving work or going for lunch having a long lasting lock that hinders others to contiune working. So that company had to see the bad side oftheir demand and agree on automatic unlocking after too long idle time of a workstation having the lock. That's actually a lesson not really learned by them."
Reply,Switching between forms in an application,AndrewMozley,"Feb 19, 2025 at 8:52 PM",https://www.tek-tips.com/threads/switching-between-forms-in-an-application.1833141/,ggreen61,"My solution to the problem of RLOCK of a record by one user that another user needs access to, is to not use RLOCK.  Instead, I have a table for managing the locks - tablelock.dbf.  When a user selects a customer, supplier, etc. record to be edited, I add the record Id to the tablelock record with the table name and user id in the Init() event of the edit form; if another user is already has a lock (exists in the table), then a message is given to the user that another is editing (I also provide the user name).  When the form is closed, in the Destory() event, I remove the record from the tablelock.dbf table.  I provide an administrative function to override and remove a lock if needed (which has not been needed to be used in over 8 years of the app).  Also, if the user Id is the same for a lock record that already exists, then I return the table lock as successful and allow the edit to proceed.The only time I use the RLOCK function is when I am adding a new record to a table and need the next Id to assign to the record.  For this I have a table tableid.dbf for managing the Id assignment (I use a 5-character Id field size that is a base-36 number)."
Reply,Switching between forms in an application,AndrewMozley,"Feb 19, 2025 at 8:52 PM",https://www.tek-tips.com/threads/switching-between-forms-in-an-application.1833141/,AndrewMozley,"I understand that the MessageBox() is modal. So even during the pause when the message is being displayed – the user cannot click on the form where the Customer record is being edited.So the form which was trying to post the invoice now displays a message to that effect, inviting the user to complete his editing function. It then RETURNS from the Click() method of the “POST” button, allowing the user to complete and Save his edit (or abandon it).Returning to the Invoicing form, the user can now click on the POST” button again; and in this case the invoice is posted successfully.Thank you to several correspondents who have helped in this matter.Andrew Mozley"
Reply,Switching between forms in an application,AndrewMozley,"Feb 19, 2025 at 8:52 PM",https://www.tek-tips.com/threads/switching-between-forms-in-an-application.1833141/,Chriss Miller,"Sounds like you solved the problem. Yet I don't know why you have the problem in itself, as you display the messagebox, don't you? Instead of asking the user to do something in a messagebox, you could do so yourself before and instead of even showing a messagebox. I understand you want to give the user the choice of saving or cancelling the changes, well, that could also be done with a messagebox with a question answered by YES/NO and then be done automatically. But in case you detect a lock that you have yourself, you don't need to ask nor to end the editmode, you can add the changes of posting the sales invoice in the same transaction that saves other changes by the user.And still, all in all, though I don't precisely know what you're doing in code, remember transaction are started right before saving changes, not at start of edit mode, they are the major pain, even a larger pain than locks."
Question,Adding and moving images in a running form,Filip Brnic,"Feb 21, 2025 at 11:44 AM",https://www.tek-tips.com/threads/adding-and-moving-images-in-a-running-form.1833168/,Filip Brnic,"Hello, before i even dug dipper into this because i had an idea, is it even possible to do so.My idea was that i can have a command button that will insert little icons of some characters(depending on the name typed in a corresponding text box) as 30x30 images, and than i could move them around on a form. Is it even possible to afterward save that form and have it layed out the exact same way ive left those images?I know there is probably a better program for doing this but i'd love for it to be done in fox because i have some tables that ill connect to that form later so its easier for me to do it in fox. (if possible)"
Reply,Adding and moving images in a running form,Filip Brnic,"Feb 21, 2025 at 11:44 AM",https://www.tek-tips.com/threads/adding-and-moving-images-in-a-running-form.1833168/,Filip Brnic,And by moving i meant dragging while holding a left mouse click.
Reply,Adding and moving images in a running form,Filip Brnic,"Feb 21, 2025 at 11:44 AM",https://www.tek-tips.com/threads/adding-and-moving-images-in-a-running-form.1833168/,Chriss Miller,"You could do that, but the best way would be to put that as data. Which means each image you put on a form gets a record consisting of image filename, and left and top position and width and height. And then you can recreate a form starting from a blank form (or any base form) by adding these images from the data.You should always first think of data.The good news is that's nothing for which you need a special other programming language, that's totally within VFP capabilities without problem, as data is not a problem, is it?"
Reply,Adding and moving images in a running form,Filip Brnic,"Feb 21, 2025 at 11:44 AM",https://www.tek-tips.com/threads/adding-and-moving-images-in-a-running-form.1833168/,Chriss Miller,"Filip Brnic said:And by moving i meant dragging while holding a left mouse click.Click to expand...drag and drop can be done in VFP in two ways, the OLE drag&drop way and the VFP drag&drop way. How to drag objects is demonstrated in the solutions project."
Reply,Adding and moving images in a running form,Filip Brnic,"Feb 21, 2025 at 11:44 AM",https://www.tek-tips.com/threads/adding-and-moving-images-in-a-running-form.1833168/,Filip Brnic,"Thanks for the fast answer Chriss, i had planned to have like around 150 images in my folder for that one form, and id add a search engine so you can select which one to add next, basically by typing in the textbox, or opening that folder and selecting the image, its not exactly that the images need to carry any data nor be connected to anything, i just kinda need them on the form, and i would need data for other stuff, basically the use of moving images is gonna be just to create like a list, and so when i arrange the images in a certain part of the list, next to it  i would add some text/something that i already have stored in a table. But if its still fine to do what you suggested, could you guide me to some website or where in the visual fox pro help catalogue could i find examples."
Reply,Adding and moving images in a running form,Filip Brnic,"Feb 21, 2025 at 11:44 AM",https://www.tek-tips.com/threads/adding-and-moving-images-in-a-running-form.1833168/,Filip Brnic,"Chriss Miller said:drag and drop can be done in VFP in two ways, the OLE drag&drop way and the VFP drag&drop way. How to drag objects is demonstrated in the solutions project.Click to expand...Hey thanks, i was writting a response for the first comment so i didn't even get this one, ill look into this!"
Reply,Adding and moving images in a running form,Filip Brnic,"Feb 21, 2025 at 11:44 AM",https://www.tek-tips.com/threads/adding-and-moving-images-in-a-running-form.1833168/,Paul Gibson,"All of the adding images and saving the position of them is fairly easy, it's all data.  For example when it comes to saving you can just iterate through all theapplicablecontrols on the form, capturing the position (Left, Top) and storing that in the manner that you require, for loading later.You can drag controls around a form without too much difficulty, if the DragMode property of the control is set to 1 = Automatic Drag then you get the dragging part very easily.  You can then tell the form to reposition controls after the Drag has finished by putting:Code:oSource.Move(nXCoord, nYCoord)...after the parameter statement in the form's DragDrop method.  It only takes about 2 minutes to create a test form, put an image control on it, set the DragMode property accordingly and add that code on the form, save and run and you can see how easily you can drag controls around a form and then you can make it more mature and specific to your requirements.There are some quirks and there is some decent documentation on the subject.  Look in the ""Creating Drag-and-Drop Controls"" topic in the help.  An online copy of that particular topic is here:https://www.vfphelp.com/help/_5wn12p4im.htm"
Reply,Adding and moving images in a running form,Filip Brnic,"Feb 21, 2025 at 11:44 AM",https://www.tek-tips.com/threads/adding-and-moving-images-in-a-running-form.1833168/,ggreen61,"Instead of using a textbox to determine the image, you could provide a lower section of the form that provides the images that are available.  This image list could be scrollable and a user would select an image and then drag to the location desired.  I ditto the use of a table to manage the images selected and the position.  If this is by user (each user can have their own layout) then also include the user Id in the table.  If multiple layouts are possible, then you could still have a single form with a drop-down to select the user's specific layout.  When saving the layout, include a description of the layout."
Question,Adding and moving images in a running form,Filip Brnic,"Feb 21, 2025 at 11:47 AM",https://www.tek-tips.com/threads/adding-and-moving-images-in-a-running-form.1833169/,Filip Brnic,this thread was a typo for the other one!
Reply,Adding and moving images in a running form,Filip Brnic,"Feb 21, 2025 at 11:47 AM",https://www.tek-tips.com/threads/adding-and-moving-images-in-a-running-form.1833169/,Chriss Miller,"Don't explain it, just edit it, or, as you started another thread, delete thiis. As the thread starter you can delete it. And any post can be edited."
Question,SQL query syntax,GTGeek88,"Feb 20, 2025 at 9:39 PM",https://www.tek-tips.com/threads/sql-query-syntax.1833164/,GTGeek88,"Can VFP handle this: I need to query to print an invoice. I need data from the Invoice Header table, the Invoice Details table (the line items on the invoice), and the Inventory table (some details related to the line item part numbers). Left joining the Header table (parent) to the Details table (child) is easy. But using left or right join from the Details table (child) to the Inventory table (grandchild) results in no records. I need a single record with the Header data (invoice number, invoice date, etc). And I need to NVL the fields from the Details table and the Inventory table just to avoid nulls. So far what I get is no records because of the join between the child and grandchild (the child does not exist - no line items on the invoice). This is causing no records to be returned. Is there a syntax within VFP's built-in SQL code to handle this (these are VFP tables). I can kludge a solution but was wanting a SQL query that works when there are detail (child) records and when there aren't."
Reply,SQL query syntax,GTGeek88,"Feb 20, 2025 at 9:39 PM",https://www.tek-tips.com/threads/sql-query-syntax.1833164/,Chriss Miller,"If you do left joins you get NULLS for non existing children/grandchildren. Getting no records points towards not doing a left join but an iner join. Which also happens indirectly, when you put a join condition into where clauses instead of an actual join.It would help to see your query to point out what to change."
Reply,SQL query syntax,GTGeek88,"Feb 20, 2025 at 9:39 PM",https://www.tek-tips.com/threads/sql-query-syntax.1833164/,ggreen61,"I use the following code to do a similar select.  I use NVL() function when the values are to be displayed.Code:SELECT inv.invoicedate, inv.duedate, inv.billto, inv.stataxes, inv.loctaxes, inv.cittaxes, inv.shipping, inv.totaldue, inv.amtpaid, inv.memberid, mbr.membername, ;
       itm.price, itm.discount, itm.quantity, itm.returnitem, itm.materialid, itm.salesordritmid, mat.descriptn, mat.itemnum ;
    FROM soinvhdr AS inv ;
    JOIN soinvitems AS itm ON itm.invoiceid = inv.id ;
    JOIN members AS mbr ON mbr.id = inv.memberid AND mbr.companyid = inv.companyid ;
    JOIN materials AS mat ON mat.id = itm.materialid AND mat.companyid = itm.companyid ;
    WHERE itm.companyid = _VFP.CompanyId ;
        AND inv.id = tcInvoiceId ;
    INTO CURSOR c_soinvitemsprn"
Reply,SQL query syntax,GTGeek88,"Feb 20, 2025 at 9:39 PM",https://www.tek-tips.com/threads/sql-query-syntax.1833164/,GTGeek88,"Chriss Miller said:If you do left joins you get NULLS for non existing children/grandchildren. Getting no records points towards not doing a left join but an iner join. Which also happens indirectly, when you put a join condition into where clauses instead of an actual join.It would help to see your query to point out what to change.Click to expand...I have the left joins in there. There is no doubt about that. I don't see behavior that works when it's Parent --> Child --> Grandchild even when left joining Parent --> Child and left joining Child --> Grandchild. When it's only Parent --> Child, then it's easy."
Reply,SQL query syntax,GTGeek88,"Feb 20, 2025 at 9:39 PM",https://www.tek-tips.com/threads/sql-query-syntax.1833164/,GTGeek88,"ggreen61 said:I use the following code to do a similar select.  I use NVL() function when the values are to be displayed.Code:SELECT inv.invoicedate, inv.duedate, inv.billto, inv.stataxes, inv.loctaxes, inv.cittaxes, inv.shipping, inv.totaldue, inv.amtpaid, inv.memberid, mbr.membername, ;
       itm.price, itm.discount, itm.quantity, itm.returnitem, itm.materialid, itm.salesordritmid, mat.descriptn, mat.itemnum ;
    FROM soinvhdr AS inv ;
    JOIN soinvitems AS itm ON itm.invoiceid = inv.id ;
    JOIN members AS mbr ON mbr.id = inv.memberid AND mbr.companyid = inv.companyid ;
    JOIN materials AS mat ON mat.id = itm.materialid AND mat.companyid = itm.companyid ;
    WHERE itm.companyid = _VFP.CompanyId ;
        AND inv.id = tcInvoiceId ;
    INTO CURSOR c_soinvitemsprnClick to expand...Ok, but in that example you're not left joining, which would be required (or right joining, depending) and you're not using NVL. So that works in my standard case where the invoice has line items, but not in the outlier where there are no invoice line items."
Reply,SQL query syntax,GTGeek88,"Feb 20, 2025 at 9:39 PM",https://www.tek-tips.com/threads/sql-query-syntax.1833164/,igorsandler,"GTGeek88 said:Can VFP handle this: I need to query to print an invoice. I need data from the Invoice Header table, the Invoice Details table (the line items on the invoice), and the Inventory table (some details related to the line item part numbers). Left joining the Header table (parent) to the Details table (child) is easy. But using left or right join from the Details table (child) to the Inventory table (grandchild) results in no records. I need a single record with the Header data (invoice number, invoice date, etc). And I need to NVL the fields from the Details table and the Inventory table just to avoid nulls. So far what I get is no records because of the join between the child and grandchild (the child does not exist - no line items on the invoice). This is causing no records to be returned. Is there a syntax within VFP's built-in SQL code to handle this (these are VFP tables). I can kludge a solution but was wanting a SQL query that works when there are detail (child) records and when there aren't.Click to expand...I am confused by your explanation. If you need a single record from the parent, why would you need any detail in the first place? The only thing you would have from detail or child is some kind of amount if you group and the rest of information from the child will collapse to the last details(child) record but invoice header should have a full amount distributed between detail lines. Maybe I am missing something but, like other comments said, if you have header record=no details or child then there is no records from grandchild table"
Reply,SQL query syntax,GTGeek88,"Feb 20, 2025 at 9:39 PM",https://www.tek-tips.com/threads/sql-query-syntax.1833164/,GTGeek88,"I'm confused by your response, but the simple answer is that I'm printing a blank invoice and the invoice expects something in the fields for line item details. That data can't just not exist. The other simple answer is that I got it working as I'd originally expected."
Reply,SQL query syntax,GTGeek88,"Feb 20, 2025 at 9:39 PM",https://www.tek-tips.com/threads/sql-query-syntax.1833164/,GTGeek88,"Chriss Miller said:If you do left joins you get NULLS for non existing children/grandchildren. Getting no records points towards not doing a left join but an iner join. Which also happens indirectly, when you put a join condition into where clauses instead of an actual join.It would help to see your query to point out what to change.Click to expand...Well, I lied. I got some tunnel vision going. The left joins were in there for the main relationship (invoice header to line items to parts), but there was one other relation to bring in a bit of other, minor you might say, info and I wasn't spotting that as needing a left join."
Question,Report with no Data Environment,SitesMasstec,"Feb 19, 2025 at 1:10 AM",https://www.tek-tips.com/threads/report-with-no-data-environment.1833128/,SitesMasstec,"Hello colleagues!Is it possible to create a report with no Data Environment?That is, I am running a form, and this form has lots of variables read from 2 files.Each field in a file, for example, the field NOMAGENT is stored in the memory variable YNOMAGENT, and then displayed in the form with the command in the Init procedure:Code:thisform.txtNOMAGENT.Value=YNOMAGENTSo, it is Ok for displaying hundreds of data fields in the form.Now I have a print button in the form, and I want to create a Report to display the fields from the form. Is it possible to create a report to display just memory variables?Thank you."
Reply,Report with no Data Environment,SitesMasstec,"Feb 19, 2025 at 1:10 AM",https://www.tek-tips.com/threads/report-with-no-data-environment.1833128/,igorsandler,"As long as those variables are public or global and the report has to be set with default data session. It's a bit weird, quite frankly. I don't see why you can't create a cursor at least with the fields selected on the form but without more details it's hard to day"
Reply,Report with no Data Environment,SitesMasstec,"Feb 19, 2025 at 1:10 AM",https://www.tek-tips.com/threads/report-with-no-data-environment.1833128/,SitesMasstec,"Ok, Igor, but is it possible to create a Cursor to store three hundred memory variables? It seems that a Cursor has the same limit as a table, that is, 255 fields."
Reply,Report with no Data Environment,SitesMasstec,"Feb 19, 2025 at 1:10 AM",https://www.tek-tips.com/threads/report-with-no-data-environment.1833128/,ggreen61,"The variables do not have to be Public/Global.  I do not use global variables at all.  I do have memory variables referenced in reports.  In the form method that will call the report, create the variables as LOCAL variables and they will be in scope when the report is run.  You cannot reference in a report a form control such as a textbox; this being said, it might be possible to use _SCREEN.ActiveForm.txtMyTextBox.Value (I have not tried this and would not recommend doing this...)"
Reply,Report with no Data Environment,SitesMasstec,"Feb 19, 2025 at 1:10 AM",https://www.tek-tips.com/threads/report-with-no-data-environment.1833128/,Joe Crescenzi,"You can definitely create a report doesn't reference any fields in a table, but the report generator expects to be run from the selected table or cursor so it knows where to start and end.That said, there is no rule that any of the content on the page has to exist as a field/column in the selected cursor.I have several reports that do exactly that.  My customers wanted a way to print a number of ""blank"" sales tickets that could be filled in by hand whenever the printer or the system was unavailable.  I originally asked them to just create something in Microsoft Word, but it would look too different from the real tickets, so I created a form that had nothing from the cursor, and lots of placeholders and underscores to fill in the details.As I mentioned, the challenge was that the report generator knows where to start and end based on the position in SOMETHING and not be at the End Of File.  So, I could literally use any table or a temporary cursor and run the report.The trick is that if you want it to be exactly one page, you just need one row in your table or cursor so it stops after the 1st page or you need a filter that ensures it stops after one page.  So you could select top 1 AnyFieldName from AnyTableName into cursor AnyCursorName, then when you use Report Form MyReport it will generate exactly one page, and yes, that page doesn't need anything from the cursor you created.  As a bonus, if you want multiple copies, you can just put exactly that number of rows into your cursor."
Reply,Report with no Data Environment,SitesMasstec,"Feb 19, 2025 at 1:10 AM",https://www.tek-tips.com/threads/report-with-no-data-environment.1833128/,Scott24x7,"Sitesmasstec,This is why we advised you not to do it this way previously.  It's knock on problems as well.If you normalized your data and tables, none of this would be an issue for you."
Reply,Report with no Data Environment,SitesMasstec,"Feb 19, 2025 at 1:10 AM",https://www.tek-tips.com/threads/report-with-no-data-environment.1833128/,Chris Miller,"I agree with Scott, and it's not only data normalization.SitesMasstec, you're so deep and stuck in wrong software architecture that you have problems nobody else has. And that should make you change your ways, but you're not. I set you as ignored member with limited success, as this thread comes to my attention anyway, due to answers of others (I see this thread in my summary of forum activity since Greg answered, not just now that Scott adds his opinion).I do not only second Scott, I have the opinion when someone obviously is on a totally wrong path that should be pointed out. Though I have that strong opinion I even agree since you're so far off from knowing how to do something that of course you need and should get help.But this is not the case of inabilities of a baby that of course is relient on its parents. Let me point out (once more) you already know the answer and you just should look into answers you already had, before starting a new thread:https://www.tek-tips.com/threads/does-a-report-use-the-available-cursor.1830624/#post-7574745.I still had a post after that, but the principle a report is driven by a workarea has already been teached to youandyou stated that you understood that. If I dig, I guess I also find older threads that teached the same. Build up a knowledge base by bookmarking posts from which you learned. Use the forum search and your profile bookmarks to revisit something."
Reply,Report with no Data Environment,SitesMasstec,"Feb 19, 2025 at 1:10 AM",https://www.tek-tips.com/threads/report-with-no-data-environment.1833128/,tomk3,"We had problems using thisform. in a report. You may iterate through the controls collection of the form and add the values (and name or description from TAG) as propertys to a ""printobject"" which you can release on close of form. You may put it in title band and have a dummy cursor with one record (see above).Anyway this is technically possible. I would recommend to think of better data organization"
Reply,Report with no Data Environment,SitesMasstec,"Feb 19, 2025 at 1:10 AM",https://www.tek-tips.com/threads/report-with-no-data-environment.1833128/,EinTerraner,"Otherways You also can create a dataobject likeCode:PUBLIC O_RepData
O_RepData = = CREATEOBJECT(""empty"")
ADDPROPERTY(O_RepData,""YourLabel_1"",<yourvalue_1>)
....
ADDPROPERTY(O_RepData,""YourLabel_n"",<yourvalue_n>)Within the report >ou can access the data like any cursor- or tablefields (O_RepData.YourLabel_n)and use a dummycursor mentioned above with one record"
Reply,Report with no Data Environment,SitesMasstec,"Feb 19, 2025 at 1:10 AM",https://www.tek-tips.com/threads/report-with-no-data-environment.1833128/,igorsandler,"SitesMasstec said:Ok, Igor, but is it possible to create a Cursor to store three hundred memory variables? It seems that a Cursor has the same limit as a table, that is, 255 fields.Click to expand...Well, you have very valid responses from other users and I completely agree with them about this very strange request. Report with 300 fields on one page? That would be pretty hard to implement. But if you still want to do it, the suggestion to create a bogus cursor with a number of records for the number of pages you want and using those variables(I am not sure about locals but I am not saying that wouldn't work, I have never tried that) should work. Another suggestion to normalize the database is also valid, I just don't know your situation and software, if you had inherited it or design it. Regardless to re-write it would take some time, I would imagine"
Reply,Report with no Data Environment,SitesMasstec,"Feb 19, 2025 at 1:10 AM",https://www.tek-tips.com/threads/report-with-no-data-environment.1833128/,Chris Miller,"You could even have thousands of fields, there's no limit once you relate multiple tables and sacrifice one field of each for a relation, you can relate N tables for N*254 fields. Besides normalized data allows you to use mor than one workrea, more than one record per page, etc. I already pointed out the general error about your general design in previous threads, no need to get into details. You also already were teached that this relation principle can extend the number of fields available at the same time, in a manner that SKIP in the main table also skips to the next record of related tables. You forget everything you learned."
Reply,Report with no Data Environment,SitesMasstec,"Feb 19, 2025 at 1:10 AM",https://www.tek-tips.com/threads/report-with-no-data-environment.1833128/,SitesMasstec,"Well, I created the report from zero.The report has data from 2 table (table 1: one filtered record, table 2: till 5 filtered records). So I can have more than three hundred fields in the report.Regarding your answers here, I can take the filtered data from original tables! It may not even be necessary to create Cursor, as I do for the Form.Well, indeed it was my erlier idea, but I do not like to run a report from original tables, so I took the variables from the Form, which displays all the filtered data from the original tables.Thank you all for the advices."
Reply,Report with no Data Environment,SitesMasstec,"Feb 19, 2025 at 1:10 AM",https://www.tek-tips.com/threads/report-with-no-data-environment.1833128/,ggreen61,"To everyone's point that you have to have a table/cursor that drives the page output.  Using variables would cause every page printed to have the same value -- no point to print more than one page.If each page is supposed to have different values, you could create two cursors that contain 150 fields each with a key field.  The key field has to be the same between the two tables so that you can join one table with the other table.  Now you can reference the full field list in the report.  The two tables (cursors) must have an index on the key field.  Set the parent table to the desired output order; set the child table to the key field order.  If the key field name is 'keyfield', you would have the following:Code:SELECT c_child
INDEX ON keyfield TAG keyfield
SET ORDER TO TAG keyfield

SELECT c_parent
SET RELATION TO c_parent.keyfield INTO c_child ADDITIVE

REPORT myreport.frx TO PRINTER"
Reply,Report with no Data Environment,SitesMasstec,"Feb 19, 2025 at 1:10 AM",https://www.tek-tips.com/threads/report-with-no-data-environment.1833128/,SitesMasstec,"Just to clarify:In the Form, Init, I have this code:Code:*   Dados do Passageiro X
    FOR X= 1 TO 5
        strX=STR(X,1)
    
        frase=""thisform.Pageframe1.Page"" + strX + "".paxmarit.txtTKT.Value""
        &frase= YTICKET(X) 
    
        frase=""thisform.Pageframe1.Page"" + strX + "".paxmarit.txtNomePax.Value""
        &frase= YNOMEPAX(X)

* ...  plus lots of similar commands
NEXT XThe above variables (the fields TICKET, NOMEPAX, and many, many others) are read from 2 tables and stored in variables YTICKET(X), YNOMEPAX(X), etcThe Form is fine, it displays data from the 2 tables.I would like to use these already available variables in a Report, just in case the user wants to print its contents.I do not understand why it is not advisible to run a report with variables only. Anyway, I will stick to your advices and try to create a cursor (or a temporary file) with all the data for the report.Thank you."
Reply,Report with no Data Environment,SitesMasstec,"Feb 19, 2025 at 1:10 AM",https://www.tek-tips.com/threads/report-with-no-data-environment.1833128/,Chris Miller,"SitesMasstec said:I do not understand why it is not advisible to run a report with variables only.Click to expand...It's also not advisable to do this with a form, but for a report you've been told multiple times even in this thread and in the post I linked to - a report does only run at all with at least one record of one table. Data is driving the report, the detail band of a report prints once for each record, with zero records it prints zero times, which means it prints not at all.That's how report worked always, this is the case since many decades. You just do a lot of work for nothing as both reports and form controls can be data driven from tables and cursors, there has been no need for transporting data from DBF into variables since you have controlsources and report field expressions, You don't scatter and gather anymore, since the 90ies, at least."
Reply,Report with no Data Environment,SitesMasstec,"Feb 19, 2025 at 1:10 AM",https://www.tek-tips.com/threads/report-with-no-data-environment.1833128/,SitesMasstec,"I want to thank you all my colleagues for your valuable help, so I am accomplishing my task:"
Question,"Polish characters in VFP,",Jureczek13,"Feb 16, 2025 at 4:02 AM",https://www.tek-tips.com/threads/polish-characters-in-vfp.1833096/,Jureczek13,"Is there any way to display Polish characters in VFP, like ą, ć, ę, ł, ń, ó, ś, ż, ź (to type this characters outside VFP, I use right ALT + letter)When I type them in VFP, I'getting this:When I copy these funny characters outside VFP, I'm getting them back: ą, ć, ę, ł, ń, ó, ś, ż, ź"
Reply,"Polish characters in VFP,",Jureczek13,"Feb 16, 2025 at 4:02 AM",https://www.tek-tips.com/threads/polish-characters-in-vfp.1833096/,herbstgy,there should be a CODEPAGE= row in your config.fpw file.CODEPAGE=AUTO means Foxpro follows your machine international setting.CODEPAGE=1250 would mean Eastern European settings. then you should be able to see your national characters.(you should also see your COLLATE parameter which sets the national sort ordering)
Reply,"Polish characters in VFP,",Jureczek13,"Feb 16, 2025 at 4:02 AM",https://www.tek-tips.com/threads/polish-characters-in-vfp.1833096/,Chris Miller,"It's already the essential answer. To add: When you have no config.fpw the codepage VFP uses is the same as with CODEPAGE=AUTO and it will only depend on the language setting of Windows. You'll see what codepage VFP uses with CPCURRENT() and when that doesn't match the Windows language setting, that is always shown with CPCURRENT(1) you should look why and how this is overridden. CPCURRENT(2) will show MSDOS codepage, for sake of completeness.I think config.fpw is one way, another is within registry keys and a third way within foxuser.dbf. Not sure, but generally those are the three places settings can be changed and maybe it's even done in two of them and in a contradicting way.Before digging anywhere, the easiest way to the codepage including Polish letters is setting the Windows language to Polish. If there is a reason Windows is English or something else, then you have to override VFPs codepage choice to be able to write code and comments and anything else with the ansi codepage that contains Polish letters, 1250 for Windows and 852 for DOS."
Reply,"Polish characters in VFP,",Jureczek13,"Feb 16, 2025 at 4:02 AM",https://www.tek-tips.com/threads/polish-characters-in-vfp.1833096/,Jureczek13,"Thanks for answers. But still didn't work.But there is another question. Let's assume that it did work on my computer.Can I be sure that when I compile my program to .exe, and send to my friends, will it work on any computer regardless their settings.I think it won't work. In this case, I have to stop and have my programs written in English.Thanks again for your effort."
Reply,"Polish characters in VFP,",Jureczek13,"Feb 16, 2025 at 4:02 AM",https://www.tek-tips.com/threads/polish-characters-in-vfp.1833096/,mJindrova,How to change the display language for non-Unicode programs The window:https://activenetwork.my.salesforce...cle/Setting-Language-for-Non-Unicode-Programs--- Do not check UTF-8
Reply,"Polish characters in VFP,",Jureczek13,"Feb 16, 2025 at 4:02 AM",https://www.tek-tips.com/threads/polish-characters-in-vfp.1833096/,Chris Miller,"For the final exe, besides the setting Martina Jindrova suggests, you have the already mentioned CODEPAGE=something in a config.fpw you can provide externally or embedded within the EXE, and you have all the different language/region resource DLLs in C:\Program Files (x86)\Common Files\Microsoft Shared\VFP from VFP9rchs.dll to VFP9rrus.dll for distribution. The dll will be picked automatically according to Windows regional setting, you can override that, as said and then you can also force one of them with the command line option -LFileName where Filename is the filename of such a DLL. You can provide all of them so the automatic region dependency kicks in. You can't expect everything to switch to the DLL language, though, for further internationalization the best option is to use the INTL Toolkit from Steven Black. Before digging into that, look at the help chapters about international applications, there are some topics about that in the VFP help.Sidenote & essence of that: It's totally possible to write applications in any specific language, if not even supporting multiple languages with or without the INTL Toolkit.What did you try and what do you expect? The VFP9 IDE itself will stay English, that won't switch to Polish by changing the codepage, but with codepage 1250 you will be able to write polish letters in your code, in comments, in texts, in label and form captions, etc. and they also show up as Polish for clients using your final EXE, provided you set to codepage 1250 for them, too. It will also be the automatic setting when they run the final EXE on a Polish Windows or MUI Windows set to Polish region/language, just like the command line option -L also works for your EXEs, not only for VFP9.exe - so these mechanism are not IDE only mechanisms.This all also works correspondingly for VFP6-8, which version of VFP are you using? And which version of  Windows? MUI (multiple language user interface) was introduced with Windows 2000, I hope you're not using Win95/98 with FPDOS, or all these recommendations are not working, of course."
Reply,"Polish characters in VFP,",Jureczek13,"Feb 16, 2025 at 4:02 AM",https://www.tek-tips.com/threads/polish-characters-in-vfp.1833096/,Chris Miller,"Jureczek13 said:I use right ALT + letterClick to expand...Specifically on that topic. I don't know why you would do that, if you mean the way to make use of holding down ALT while entering a unicode codepoint, that will result in unicode characters that don't at all match an ansi codepage, neither the wrong nor the right one. Googling Polish keyboard layout I find this:http://kbdlayout.info/KBDPL/Which tells me many of the polish letters are even just plain keys, or SHIFT+key for upper case, as it is with the usual 26 latin letters and then you get some letters with AltGr, like AltGr+D, for example.The Unicode characters won't help you, whatever you set the codepage to.It makes me think, whether you have defined and automatically loaded keyboard macros in a previous VFP version, which went missing now, where you defined ALT+letters to result in certain polish letters, which don't usually result from ALT+letter, though. Have you upgraded VFP recently? Do you have FKY files that store such macro definitions? Also seehttps://hackfox.github.io/section4/s4g193.html"
Reply,"Polish characters in VFP,",Jureczek13,"Feb 16, 2025 at 4:02 AM",https://www.tek-tips.com/threads/polish-characters-in-vfp.1833096/,Chris Miller,"For testing I just installed the Polish language pack and keyboard layouts. (Still downloading)Using an English keyboard layout with codepage 1250 does not lead to polish letters, both have to match.Do you have a polish keyboard layout installed and set as current keyboard configuration? It should show in the systray, if you activate the language bar:Here Polish 214.Here the Programmers layout.You can add these without changing the main Windows language."
Reply,"Polish characters in VFP,",Jureczek13,"Feb 16, 2025 at 4:02 AM",https://www.tek-tips.com/threads/polish-characters-in-vfp.1833096/,Chris Miller,"...breaking news...My final experience with this is, that neither setting CODEPAGE=1250 nor having a polish keyboard layout nor both at the same time was sufficient to get Polish letters displayed in the VFP9 IDE. Martina Jindrova has the major point, in the administrative tab of Windows language settings the system locale has to be set to ""Polish (Poland)"" to get this going, the CPCURRENT(1) codepage then becomes 1250.Here's a screenshot demonstrating it then works (fontsize set to 20 for a clear distintion from lower case l and upper case L).On the other hand that's also the usual situation for a Polish Windows user without making that setting and when the locale is Polish you also don't need a config.fpw that sets CODEPAGE=1250, instead CPCURRENT() and CPCURRENT(1) is 1250 in that situation. Also, this combines with Windows display language set to another, if that's something you still need.I didn't need ALT for these letters, I wonder what specific letters you thought of, as the keyboard layout shows most Polish letters simply are normal keys in the Polish layouts."
Reply,"Polish characters in VFP,",Jureczek13,"Feb 16, 2025 at 4:02 AM",https://www.tek-tips.com/threads/polish-characters-in-vfp.1833096/,Chris Miller,"Final thoughts:It's true that other applications (Unicode capable applications) allow using the polish keyboard layout and input with them without having the system locale set to Polish (Poland). What I take from this that Windows makes a differrence of input language and display language, the VFP CODEPAGE=1250 setting is only covering the display language, which does not help to provide a polilsh application that displays Polish texts but doesn't support Pollish input. So it's not only a developer problem, but also an end user problem. We have to live with this downside of ANSI applications. It shouldn't be a problem with Polish users that also set their system locale to Polish, though.The remaining questions are in the direction what problems you have with your development system, if you are a Polish developer with a Polish Windows, VFP should work for you even without any specific settings as the system locale should be Polish already. I can only assume you're either dealing with ealier Windows and/or VFP versions."
Reply,"Polish characters in VFP,",Jureczek13,"Feb 16, 2025 at 4:02 AM",https://www.tek-tips.com/threads/polish-characters-in-vfp.1833096/,ggreen61,"What is the source of the Polish text being displayed?  If it is a cursor (from a SELECT-SQL command) and bound to the control, then the table CodePage should be set to 1250.  By default, it will be set to VFP default value.  In the create command for a cursor you can set the CodePage value.  Example:Code:CREATE CURSOR c_polish CODEPAGE=1250 (field1 C(50), ...)

&&  do your field binding to the control(s)

SELECT field1, ... FROM textsource INTO CURSOR c_temp
SELECT c_polish
ZAP IN c_polish        && remove any from a previous COPY FROM...
COPY FROM DBF('c_temp')
USE IN SELECT('c_temp')This might give you what you need to see the characters correctly."
Reply,"Polish characters in VFP,",Jureczek13,"Feb 16, 2025 at 4:02 AM",https://www.tek-tips.com/threads/polish-characters-in-vfp.1833096/,wOOdy-Soft,"And just as another tidbid: Almost every control in VFP's forms also has a FONTCHARSET property. If you set this to your desired codepage, then VFP will use that for displaying your data. That way you can even display different languages on a single form: the english original, a russian, bulgarian, polish textbox with proper foreign characters. etc.  They will stil get saved as one of the 255 possible characters of the Ansi alphabet, and looking in browse window will show the standard character representation, but with the proper FontCharSet it will show as desired.wOOdy"
Reply,"Polish characters in VFP,",Jureczek13,"Feb 16, 2025 at 4:02 AM",https://www.tek-tips.com/threads/polish-characters-in-vfp.1833096/,Chris Miller,"Displaying something is not the only problem, though. The input is driven by the system locale, no matter if you set other keyboards. Switching to POL 214 I got ³ (superscript 3) instead of ł, for example. But in Unicode aware applications like Notepad++ the keyboard layout worked, as the system locale codepage for non Unicode application does, well, only apply for non Unicode applications, and I wonder how many other programming platforms even still create ANSI executables."
Reply,"Polish characters in VFP,",Jureczek13,"Feb 16, 2025 at 4:02 AM",https://www.tek-tips.com/threads/polish-characters-in-vfp.1833096/,wOOdy-Soft,"Chris Miller said:Displaying something is not the only problem, though. The input is driven by the system locale, no matter if you set other keyboards. Switching to POL 214 I got ³ (superscript 3) instead of ł, for example. But in Unicode aware applications like Notepad++ the keyboard layout worked, as the system locale codepage for non Unicode application does, well, only apply for non Unicode applications, and I wonder how many other programming platforms even still create ANSI executables.Click to expand...Since that FontCharSet also works in Text- and Editboxes, you can enter polish characters on the fly. At least if you know the threeletter-AltCode (i.e.the Position in the 255 char Ansi table) or if you have the polish keyboard driver activated. Windows always uses Unicode, but converts the entered 2Byte chars to the corresponding 1Byte char if possible. That mappingtable is set to the current activated codepage for our NonUnicodeApp. That's done either by that global Windows setting, withe the Codepage setting in config.fpw or with our FontCharSet on a PerControl base.Then there's another codepage setting for DBFs, but this isn't involved here, it just maps reading and writing data; mostly in a multi-environment setup, where different OS (like DOS, Win, Linux) are using the same tables with different Ascii codings."
Reply,"Polish characters in VFP,",Jureczek13,"Feb 16, 2025 at 4:02 AM",https://www.tek-tips.com/threads/polish-characters-in-vfp.1833096/,Chris Miller,"wOOdy, I have to try the effect of the FontCharset on controls, but when I start an editor with (for example) MODIFY COMMAND main.prg AS 1250 and have the Polish keyboard layout activated and still don't get the Polish letters from they keys that should give them, I still only see Martina's solution to set the locale for non-Unicode applications as the only working one for the developer writing code and forms and texts in labels, etc.I don't see the effect of the automatic Unicode to Ansi translation in VFP. I see the keyboard layout and keys working as expected in Notepad++, as that is a Unicode capable application, but that's not helping in the VFP IDE. Jureczek13 did not only address problems end user's might have, but also his own development within the IDE. So as Polish developer you need a Windows with Polish language pack, set the locale for Polish and then everything works as expected on that level. I don't see this working without the locale set to Polish, though.So unless you don't add in something like keyboard makros or any tool that makes the necessary mappings, I don't see Windows doing that without setting the locale for non Unicode applications, i.e. I don't see that  Windows converts the entered 2Byte chars to the corresponding 1Byte char within the VFP IDE in the code ediitor windows."
Question,Timer doesn't trigger when run under Windows Task Scheduler,Rajesh Karunakaran,"Feb 18, 2025 at 7:48 AM",https://www.tek-tips.com/threads/timer-doesnt-trigger-when-run-under-windows-task-scheduler.1833116/,Rajesh Karunakaran,"In my application with UI, I have a timer.  It checks, if the hour of time is 9, 10, 11... and so on and if matches, ie at each hour, process something and upload to an Ftp.If I run this in pc as usual the UI displays and the timer correctly does the process at each hour.When I set a Task in Windows Task Scheduler, to start when the PC starts, it shows 'Running' and I can see it in the Task Manager.  However, it doesn't do the process and upload.Earlier, I had the Timer1.Enabled = .T. in the form's Activate.  Then I shifted it to the Init method thinking maybe in Task Scheduler, it doesnt get activated as there's no UI. But still, it doesn't run the process code.The Timer is added onto the form by control drag/drop.  Should I add it programmatically?  Will that solve the problem?Anyone has any idea?"
Reply,Timer doesn't trigger when run under Windows Task Scheduler,Rajesh Karunakaran,"Feb 18, 2025 at 7:48 AM",https://www.tek-tips.com/threads/timer-doesnt-trigger-when-run-under-windows-task-scheduler.1833116/,Chris Miller,"How's Task scheduler configured? Usually task scheduler does not start an EXE immediately, but by a time schedule, and if that is set to full hours, the exe will start shortlyafterfull hours. Or do you only use it to autostart your exe once at every Windows startup? It ma only start after a Windows login.I wonder about your statement it runs without UI. Without you also have no form init, do you?You can easily find out what actually happens in the exe with SET COVERAGE."
Reply,Timer doesn't trigger when run under Windows Task Scheduler,Rajesh Karunakaran,"Feb 18, 2025 at 7:48 AM",https://www.tek-tips.com/threads/timer-doesnt-trigger-when-run-under-windows-task-scheduler.1833116/,Rajesh Karunakaran,"Hi Chris,Yes, I meant, when the app runs through Task Scheduler, it doesn't show UI.In that case, as you said, no form Init as well!So, I think, I need to add the Timer as a public control in my startup PRG file, not inside the form.Let me check that.Will come back here."
Reply,Timer doesn't trigger when run under Windows Task Scheduler,Rajesh Karunakaran,"Feb 18, 2025 at 7:48 AM",https://www.tek-tips.com/threads/timer-doesnt-trigger-when-run-under-windows-task-scheduler.1833116/,Chris Miller,"If you scheduled the task to system start before a user logs in and you start a form then this might trigger an error and stops, right away. Regarding the Enabled property, that can be set .T. in a timer class at design already, so it starts the first timer event Interval milliseconds after its creation.Edit: After testing, a simple VFP executable showing its _Screen won't trigger an error, even when the scheduled task is triggered by system start, hidden and before user logs in, where it starts in session 0. If you have that configuration (You didn't answer my question about how your scheduled task is configured) the only restriction is that you can't have access to mapped drives, as the drive mapping will only be done after login. So you can only access local drives, for example. If anything errors the timer stops working, of course. So establish an error handler logging errors to see what goes wrong."
Reply,Timer doesn't trigger when run under Windows Task Scheduler,Rajesh Karunakaran,"Feb 18, 2025 at 7:48 AM",https://www.tek-tips.com/threads/timer-doesnt-trigger-when-run-under-windows-task-scheduler.1833116/,Rajesh Karunakaran,"Chriss,This is solved.I just need to enter the folder of my application under Actions -> Settings -> 'Start in (optional):'Then it started, it creates my log file and now I am just waiting for it to trigger at the next Run Hour.Will update the status here."
Reply,Timer doesn't trigger when run under Windows Task Scheduler,Rajesh Karunakaran,"Feb 18, 2025 at 7:48 AM",https://www.tek-tips.com/threads/timer-doesnt-trigger-when-run-under-windows-task-scheduler.1833116/,Rajesh Karunakaran,"Dear all,Yes, that worked!Now, the timer triggers at each hour, generates the files and uploads them.Thank you all."
Reply,Timer doesn't trigger when run under Windows Task Scheduler,Rajesh Karunakaran,"Feb 18, 2025 at 7:48 AM",https://www.tek-tips.com/threads/timer-doesnt-trigger-when-run-under-windows-task-scheduler.1833116/,Chris Miller,"Indeed, if you don't specify ""start in"", the default start directory is C:\Windows\System32, not the EXE directory.Dependency on EXE path should alsways be programmed by using SYS(16), or you set the start in directory for a scheduled task or in a shortcut link. But whenever a user double clicks an EXE the default start path is not necessarily that of the EXE, so I always have a routine determining the EXE path by JUSTPATH(SYS(16,0)). That way you don't depend on a start path at all, as you can CD or SET DEFAULT there."
Reply,Timer doesn't trigger when run under Windows Task Scheduler,Rajesh Karunakaran,"Feb 18, 2025 at 7:48 AM",https://www.tek-tips.com/threads/timer-doesnt-trigger-when-run-under-windows-task-scheduler.1833116/,ggreen61,Glad to see that you got it working.  I wrote a custom timer class based on the Win32 API.  See attached.  The DeclareWinAPI.prg should be added as a library:Code:SET LIBRARY TO DeclareWinAPI.prg ADDITIVEThe class works pretty much the same way as the VFP control.
Question,ChilkatVFP 1.42 Released,Bill Anderson,"Feb 18, 2025 at 12:07 AM",https://www.tek-tips.com/threads/chilkatvfp-1-42-released.1833109/,Bill Anderson,https://github.com/billand88/ChilkatVFPCompatibility with Chilkat version 10.1.2. No other changes.Bill Anderson
Reply,ChilkatVFP 1.42 Released,Bill Anderson,"Feb 18, 2025 at 12:07 AM",https://www.tek-tips.com/threads/chilkatvfp-1-42-released.1833109/,GTGeek88,"It seems the Chilkat library can do things with PDFs, but not create them. Is that correct?"
Reply,ChilkatVFP 1.42 Released,Bill Anderson,"Feb 18, 2025 at 12:07 AM",https://www.tek-tips.com/threads/chilkatvfp-1-42-released.1833109/,Bill Anderson,"GTGeek88 said:It seems the Chilkat library can do things with PDFs, but not create them. Is that correct?Click to expand...That’s correct.Bill Anderson"
Question,Generate a qr code on a report.,Filip Brnic,"Feb 12, 2025 at 4:43 PM",https://www.tek-tips.com/threads/generate-a-qr-code-on-a-report.1833061/,Filip Brnic,"Hello, does anyone have experience with QR codes in visual fox pro, if so, how can i generate a QR on the report?We need this because the people that have our other program requested if we could somehow add the QR code to the receipts, so i was wondering if there is a way to link tables individual records and make it into a QR code (it should be an jpg/bmp or something similar)Also I'm simply just translating what my programmer told me, and he mentioned that there is a large amount of receipts created at once so he thought it would be smarter to beforehand prepare the QR codes in some kinda field of each individual record, and then during printing just insert that same record.But for now we just wanna generate the QR code in any way shape or form.Id appreciate a link to a guide or just a simple example code."
Reply,Generate a qr code on a report.,Filip Brnic,"Feb 12, 2025 at 4:43 PM",https://www.tek-tips.com/threads/generate-a-qr-code-on-a-report.1833061/,GriffMG,"Code:m.LOFBC = CREATEOBJECT(""FoxBarcodeQR"")
                                                    m.BARCODEIMAGE = """"  && the code you want in the QR image
                                                    m.BARCODESIZE = 2
                                                    m.BARCODEFILE = m.TEMPDIR+""qrcode.jpg""
                                                    m.LOFBC.QRBARCODEIMAGE(m.BARCODEIMAGE, m.BARCODEFILE, m.BARCODESIZE, 1)
                                                    m.LOFBC = NULLAbove makes a .jpg file... in the folder specified in m.TEMPDIR using the FoxBarcodeQR barcodelibrary.dll you can puthttps://mywebsite.com/process.asp?image=xyyin the code image"
Reply,Generate a qr code on a report.,Filip Brnic,"Feb 12, 2025 at 4:43 PM",https://www.tek-tips.com/threads/generate-a-qr-code-on-a-report.1833061/,Filip Brnic,"GriffMG said:Code:m.LOFBC = CREATEOBJECT(""FoxBarcodeQR"")
                                                    m.BARCODEIMAGE = """"  && the code you want in the QR image
                                                    m.BARCODESIZE = 2
                                                    m.BARCODEFILE = m.TEMPDIR+""qrcode.jpg""
                                                    m.LOFBC.QRBARCODEIMAGE(m.BARCODEIMAGE, m.BARCODEFILE, m.BARCODESIZE, 1)
                                                    m.LOFBC = NULLAbove makes a .jpg file... in the folder specified in m.TEMPDIR using the FoxBarcodeQR barcodelibrary.dll you caam puthttps://mywebsite.com/process.asp?image=xyyin the code imageClick to expand...Hey Griff thanks for the code, would you mind going in a visual fox pro and creating like an example and taking a screenshot, Right now i don't have access to visual fox pro because my device is being repaired away from me, and i'm currently working from home, could you perhaps make a little report with that QR and just send a screenshot of the code and that QR code?Thanks in advance"
Reply,Generate a qr code on a report.,Filip Brnic,"Feb 12, 2025 at 4:43 PM",https://www.tek-tips.com/threads/generate-a-qr-code-on-a-report.1833061/,Paul Gibson,"This won't be the only way to do it but what we do is have a program which can be called from anywhere in the application, in a routine for generating the QR codes, or on a picture object on the report layout.  For us the program is called get_qrcode, we pass in the data required to generate the URL which is embedded in the QR code, know where to store it and the program returns the full path to the QR code file on the network, which upon generation is an image, a PNG file stored in an appropriate place for the system to pick up each time is required.There's plenty of specifics that are particular to us that you may not need to do but as a quick summary, the QR codes that we put on reports are for a vehicle catalogue for cars, vans, etc that are up for auction, the QR code has the URL for consumers of the catalogue to scan and be taken to the web page of that auction listing.  For us that means 1 QR code per vehicle in the database, it doesn't need to change during the lifetime of that database record.  That in turn means that the location where the image is stored on the network doesn't change.  This means that when the QR code is generated the first time, each subsequent time the get_qrcode program is called, if it is for a vehicle where the image already exists the program can simply return the path of the already existing image, which is obviously faster than re-generating it each time it is required.If the image doesn't exist yet for the required vehicle, the program calls the appropriate method for generating it.  Our method of QR code generation has changed over time.   The first method used Google charts API, something along the lines of:Code:https://chart.googleapis.com/chart?cht=qr&chs={dimensions}&chld=Q&chl={dataToEmbed}...and we'd use the WinAPI URLDownloadToFile to call that URL and download the result to a file.  We've also integrated FoxBarcodeQR as another method, I can't remember if it was just for redundancy or if we had a problem calling the Google Charts API but regardless, when you rely on a Google API it's always good to have a backup plan as Google have a terrible reputation for deprecating or changing their APIs.So that's it: Call program with necessary details, program looks for existing image and returns path if it exists, if not it generates the image by calling one of the integrations (either Google Charts or FoxBarcodeQR) and storing the file for current and future use."
Reply,Generate a qr code on a report.,Filip Brnic,"Feb 12, 2025 at 4:43 PM",https://www.tek-tips.com/threads/generate-a-qr-code-on-a-report.1833061/,Filip Brnic,"Thanks Paul, I'm not the best at fox but I'm sure my programmer will be able to learn from this greatly!I think it resembles the same logic we are aiming to achieve."
Reply,Generate a qr code on a report.,Filip Brnic,"Feb 12, 2025 at 4:43 PM",https://www.tek-tips.com/threads/generate-a-qr-code-on-a-report.1833061/,atlopes,"Filip,You may have a look athttps://github.com/atlopes/zintbarcode.The class is documented and includes various demo programs that cover your use cases."
Question,QR generated by FoxBarcodeQR doesn't contain the full content,Rajesh Karunakaran,"Feb 10, 2025 at 12:17 PM",https://www.tek-tips.com/threads/qr-generated-by-foxbarcodeqr-doesnt-contain-the-full-content.1833033/,Rajesh Karunakaran,"Dear friends,I'm using the community library FoxBarcodeQR for generating qr codes.Using the below commandsCode:loQr = CREATEOBJECT(""FoxBarcodeQR"")
s=REPLICATE('X',950)+'...'
lcQRImage = loQr.QRBarcodeImage(s, lpath + ""qrimage5.png"", 5, 2)

But the result qr code when scanned doesn't show the full 953 characters."
Reply,QR generated by FoxBarcodeQR doesn't contain the full content,Rajesh Karunakaran,"Feb 10, 2025 at 12:17 PM",https://www.tek-tips.com/threads/qr-generated-by-foxbarcodeqr-doesnt-contain-the-full-content.1833033/,Chris Miller,"I think there is an upper limit of what can be encoded into what size of QR image, specifically what number of QR squares. I think some of the parameters are about the size. If you already used the largest size then you're asking for too much. A finite size always can only encode a finite number of bytes or characters, obviously. I'd also try with something like REPLICATE('1234567890',95)+'abc', for easier verification of the scan result.Edit: Looking athttps://github.com/VFPX/FoxBarcodeQRyou can go up from 5 for 165x165 to 12 for 396x396.Documentation speaks of more than 255 characters - which it does, obviously, because that was a limitation of an earlier version. It doesn't mean the upper limit is now unrestricted, but it doesn't provide information about the upper limits. I guess it varies with the necessary number of bits and the bits used for correction bits and so the correction level."
Reply,QR generated by FoxBarcodeQR doesn't contain the full content,Rajesh Karunakaran,"Feb 10, 2025 at 12:17 PM",https://www.tek-tips.com/threads/qr-generated-by-foxbarcodeqr-doesnt-contain-the-full-content.1833033/,Rajesh Karunakaran,"This is actually for an e-Invoice.  The qr data is base64 encoded and is JWT.  The sample qr code has 953 characters and that's why I am testing with a 953 characters string.  I am scanning with my mobile phone's qr scanner.  When scanning the sample one, I can see the full content.  When I generate qr of my data for qr with the library, the result qr when scanned shows truncated data.  I tried with all sizes but truncates the same way.  I think, there is something, maybe a setting, that I'm missing."
Reply,QR generated by FoxBarcodeQR doesn't contain the full content,Rajesh Karunakaran,"Feb 10, 2025 at 12:17 PM",https://www.tek-tips.com/threads/qr-generated-by-foxbarcodeqr-doesnt-contain-the-full-content.1833033/,Rajesh Karunakaran,"Chriss, I am using an older version it seems.I have the new version 2.10.  Let me try that.Will update status here."
Reply,QR generated by FoxBarcodeQR doesn't contain the full content,Rajesh Karunakaran,"Feb 10, 2025 at 12:17 PM",https://www.tek-tips.com/threads/qr-generated-by-foxbarcodeqr-doesnt-contain-the-full-content.1833033/,Rajesh Karunakaran,"[SOLVED]Chriss,The new version gives the complete content.I guess, the old version was not supporting above 255 charactersThanks for your support"
Reply,QR generated by FoxBarcodeQR doesn't contain the full content,Rajesh Karunakaran,"Feb 10, 2025 at 12:17 PM",https://www.tek-tips.com/threads/qr-generated-by-foxbarcodeqr-doesnt-contain-the-full-content.1833033/,Chris Miller,"Just as sidenote: In case the QR code can't encode the data you plan to encode, you can always encode a URL that points to the data that's too large to encode, so storing JWTs in a db and retriving them bywww.yourdomain.in/jwts/?id=qrcodecould work with far smaller QR codes, too. if the QR code only encodes the lookup id(entifier) and even with only 255 bytes allows 2^2048 different JSON web tokens."
Question,Westwind Web Connection server on LAN:  can SPT (MS SQL) work ?,Steve Yu,"Jan 30, 2025 at 3:27 PM",https://www.tek-tips.com/threads/westwind-web-connection-server-on-lan-can-spt-ms-sql-work.1832929/,Steve Yu,"Hello colleagues,We have a working Web Connection server on a LAN (internal web) that employs .dbf and .idx only currently.Is it possible to add SPT coding to access the MS SQL tables that are on the same LAN concurrently ?This is our effort to expand exiting desktop applications to include access from the web.Help appreciated.Steve Yu"
Reply,Westwind Web Connection server on LAN:  can SPT (MS SQL) work ?,Steve Yu,"Jan 30, 2025 at 3:27 PM",https://www.tek-tips.com/threads/westwind-web-connection-server-on-lan-can-spt-ms-sql-work.1832929/,Chris Miller,"Yes, in very short. There's no reason to exclude an SQL Server running on the same server as a web server and so there's even less problem, if you only want them to run in the same LAN. Besides, even if an SQL Server would be outside of the LAN somewhere else in the internet (cloud) you could make a connection.For the performance of the whole system you may need to redimension (i.e. extend) the server to run both a web and SQL Server on it, but you could also split the roles.And both the web server and clients could even connect to the SQL Server, you're not limited to making the web server a middle tier between clients with the frontend UI and a database server, even though that's the usual 3 tier architecture of a web solution, there's nothing ruling out the client as a ""thick"" client desktop application also does correctly work on an SQL Server backend on top of the web backend you also have, because you don't have to restrict your desktop solution to the frontend browser tier/role, only."
Reply,Westwind Web Connection server on LAN:  can SPT (MS SQL) work ?,Steve Yu,"Jan 30, 2025 at 3:27 PM",https://www.tek-tips.com/threads/westwind-web-connection-server-on-lan-can-spt-ms-sql-work.1832929/,Steve Yu,"Chris Miller said:Yes, in very short. There's no reason to exclude an SQL Server running on the same server as a web server and so there's even less problem, if you only want them to run in the same LAN. Besides, even if an SQL Server would be outside of the LAN somewhere else in the internet (cloud) you could make a connection.For the performance of the whole system you may need to redimension (i.e. extend) the server to run both a web and SQL Server on it, but you could also split the roles.And both the web server and clients could even connect to the SQL Server, you're not limited to making the web server a middle tier between clients with the frontend UI and a database server, even though that's the usual 3 tier architecture of a web solution, there's nothing ruling out the client as a ""thick"" client desktop application also does correctly work on an SQL Server backend on top of the web backend you also have, because you don't have to restrict your desktop solution to the frontend browser tier/role, only.Click to expand...Thanks for the confirmation, Chris.Actually, and it may not make any difference, our web server and the SQL server where MS SQL is installed are on separate hardware physically but on the same LAN and currently they operate totally independently of each other.You did not mention West Wind in your response; but I assume SPT would work alongside current .dbf and .idx structure.Just wonder how to code the SPT in West Wind; it'd be much different from desktop applications in that, I assume, I'll have to initiate the MS SQL connection each time a page is called on the web vs just one time when the desktop application is started.Steve Yu"
Reply,Westwind Web Connection server on LAN:  can SPT (MS SQL) work ?,Steve Yu,"Jan 30, 2025 at 3:27 PM",https://www.tek-tips.com/threads/westwind-web-connection-server-on-lan-can-spt-ms-sql-work.1832929/,Chris Miller,"Steve Yu said:I assume, I'll have to initiate the MS SQL connection each time a page is called on the web vs just one time when the desktop application is started.Click to expand...Yes, and that's not unusal for a web application. Even if you don't work in PHP and look at beginner tutorials for PHP web scripts with a MySQL backend making the connection at the PHP script start is normal, and closinit when the script end is even automatic. So for performance of that, usually the SQL Server will make use of a feature of connection pooling, so that the next web request making a ddb connection will actuall get it's connection handle from a pool of handles the server kept open. I remember you ha to explicitly do somethign to get there in classic ASP using VB, but that's long long ago.Well, the point it, this is not at all unusual and also works flawless."
Reply,Westwind Web Connection server on LAN:  can SPT (MS SQL) work ?,Steve Yu,"Jan 30, 2025 at 3:27 PM",https://www.tek-tips.com/threads/westwind-web-connection-server-on-lan-can-spt-ms-sql-work.1832929/,Chris Miller,"The task at hand will be adding permissions to the database server for the web server account, usually, as the client account doesn't necessarily loops through to the sql backend server. In the analogy of PHP and MySQL the PHP server side processing very often connects as root (equal to MSSQL sa) user with MySQL."
Reply,Westwind Web Connection server on LAN:  can SPT (MS SQL) work ?,Steve Yu,"Jan 30, 2025 at 3:27 PM",https://www.tek-tips.com/threads/westwind-web-connection-server-on-lan-can-spt-ms-sql-work.1832929/,Steve Yu,"Chris Miller said:The task at hand will be adding permissions to the database server for the web server account, usually, as the client account doesn't necessarily loops through to the sql backend server. In the analogy of PHP and MySQL the PHP server side processing very often connects as root (equal to MSSQL sa) user with MySQL.Click to expand...We use root account only for MS SQL login and control access within the applications based on Active Directory login names.It'd be extremely cumbersome and not practical to configure permissions for near 100 users."
Reply,Westwind Web Connection server on LAN:  can SPT (MS SQL) work ?,Steve Yu,"Jan 30, 2025 at 3:27 PM",https://www.tek-tips.com/threads/westwind-web-connection-server-on-lan-can-spt-ms-sql-work.1832929/,Chris Miller,"Steve Yu said:We use root account only for MS SQL login and control access within the applications based on Active Directory login names.It'd be extremely cumbersome and not practical to configure permissions for near 100 users.Click to expand...Surely you'd not do this on a per user basis, but define usergroups as roles. That's managable."
Reply,Westwind Web Connection server on LAN:  can SPT (MS SQL) work ?,Steve Yu,"Jan 30, 2025 at 3:27 PM",https://www.tek-tips.com/threads/westwind-web-connection-server-on-lan-can-spt-ms-sql-work.1832929/,Steve Yu,"Chris Miller said:Surely you'd not do this on a per user basis, but define usergroups as roles. That's managable.Click to expand...We followed the advise of our consultant to simplify the access; we certainly don't want to make it more complicated than it needs to - keep in mind we converted to MS SQL from simple .dbf VFP where no access check whatsoever is done. All security has been built into the applications.BTW, our SQL server is hosted inside multiple firewalls; the idea of access across public space is palpable from technology point of view but not ideal if you consider the current state of Internet environment."
Reply,Westwind Web Connection server on LAN:  can SPT (MS SQL) work ?,Steve Yu,"Jan 30, 2025 at 3:27 PM",https://www.tek-tips.com/threads/westwind-web-connection-server-on-lan-can-spt-ms-sql-work.1832929/,Chris Miller,"I'm just saying what's possible and practiced in other companies. If you stick to using sa access, I'd recommend not do do so from desktop clients directly, in that case, but only through the web server as the middle tier for that."
Reply,Westwind Web Connection server on LAN:  can SPT (MS SQL) work ?,Steve Yu,"Jan 30, 2025 at 3:27 PM",https://www.tek-tips.com/threads/westwind-web-connection-server-on-lan-can-spt-ms-sql-work.1832929/,GTGeek88,WWWC has built-in code to query back-end databases.
Reply,Westwind Web Connection server on LAN:  can SPT (MS SQL) work ?,Steve Yu,"Jan 30, 2025 at 3:27 PM",https://www.tek-tips.com/threads/westwind-web-connection-server-on-lan-can-spt-ms-sql-work.1832929/,Steve Yu,GTGeek88 said:WWWC has built-in code to query back-end databases.Click to expand...Please kindly provide a link.
Reply,Westwind Web Connection server on LAN:  can SPT (MS SQL) work ?,Steve Yu,"Jan 30, 2025 at 3:27 PM",https://www.tek-tips.com/threads/westwind-web-connection-server-on-lan-can-spt-ms-sql-work.1832929/,Steve Yu,"GTGeek88 said:WWWC has built-in code to query back-end databases.Click to expand...Never mind, I found it in the client toolbox, Class wwSQL.Did not know there is one.Thanks for the reminder."
Reply,Westwind Web Connection server on LAN:  can SPT (MS SQL) work ?,Steve Yu,"Jan 30, 2025 at 3:27 PM",https://www.tek-tips.com/threads/westwind-web-connection-server-on-lan-can-spt-ms-sql-work.1832929/,Chris Miller,"Of course, even if there wouldn't be, you can do SQLCONNECT or SQLSTRINGCONNECT in your VFP code, why should SPT functions not work in Web Connection?Well, I actually came back here to add to arguments against your doubts: No matter if a database server is on the same server as a webserver or these roles have dedicated servers, the actual hardware servers (or VMs, too) are typically direct neighbors, so connection times are almost zero. That's far better than the connection time desktop clients have. Most of the time to connect to SQL Server from a desktop client goes in forwarding the request to the servers database engine, MSSQL has its browser service to listen for incoming connection requests to SQL Server instances and provides informations about the instances for faster connection handling. When going for the three tier architecture of a web server script making a connection you may not even need this service as you'd connect to a direct neihgbor, if not on the same machine.There's also one advantage you typically make use of as a developer when webserver and database server are both running on your developer machine: The db connection can use shared memory, the fastest lane to the database. The only advantage to separation of the web and db server is not needing one single highly dimensioned server with enough capacities to process all incoming requests, even if you could count database requests to the web requests, when there wouldn't be concurrent uses of the database server not originating in web requests. As a developer you're the only user of your machine and there it's not a concern, but if you can manage to have that architecture the web application can profit from that, it only becomes a disadvatage again, if the load is very heavy, like millions/billions of users, thousands or even hundreds of thousands concurrently, as it's for Facebook, Google, etc. You're likely not in that boat, though.For on premise solutions for a few hundred users, perhaps thousand, of which you'd have a few tens concurrently acting, the only disadvantage of having many roles on the same server is safety against services getting down or slow. From the perspective of an application driven by web connection it's not helpful if only web or database server are available, the application becomes unusable when only one of them is down. too. So that architecture of separate roles only has advantages if there's anything that can continue to work woth only one of them."
Reply,Westwind Web Connection server on LAN:  can SPT (MS SQL) work ?,Steve Yu,"Jan 30, 2025 at 3:27 PM",https://www.tek-tips.com/threads/westwind-web-connection-server-on-lan-can-spt-ms-sql-work.1832929/,tomk3,"Hello,just one thing : AFAIK you cannot run MS-SQLserver on a domain controller"
Reply,Westwind Web Connection server on LAN:  can SPT (MS SQL) work ?,Steve Yu,"Jan 30, 2025 at 3:27 PM",https://www.tek-tips.com/threads/westwind-web-connection-server-on-lan-can-spt-ms-sql-work.1832929/,Chris Miller,"Makes me wonder, but I never tried, anyway. If someone would use a Windows Server Essential Edition that's limited to 1 CPU socket with at max 10 cores. That would sound like much when compared to what I started with in the 80s/90s, but is not something I'd use for SQL Server anyway. So when you'd not use this even in a small environment for small buisinesses, it's surely never an option in any company. As a stand alone freelancer you could run everything on one server, though. You'd even be able to do without a domain controller and do everything on a laptop. I don't think there's a technical limitation, it's just not the roles you combine in one server, domain controller and database server."
Reply,Westwind Web Connection server on LAN:  can SPT (MS SQL) work ?,Steve Yu,"Jan 30, 2025 at 3:27 PM",https://www.tek-tips.com/threads/westwind-web-connection-server-on-lan-can-spt-ms-sql-work.1832929/,Steve Yu,"Chris Miller said:Of course, even if there wouldn't be, you can do SQLCONNECT or SQLSTRINGCONNECT in your VFP code, why should SPT functions not work in Web Connection?Well, I actually came back here to add to arguments against your doubts: No matter if a database server is on the same server as a webserver or these roles have dedicated servers, the actual hardware servers (or VMs, too) are typically direct neighbors, so connection times are almost zero. That's far better than the connection time desktop clients have. Most of the time to connect to SQL Server from a desktop client goes in forwarding the request to the servers database engine, MSSQL has its browser service to listen for incoming connection requests to SQL Server instances and provides informations about the instances for faster connection handling. When going for the three tier architecture of a web server script making a connection you may not even need this service as you'd connect to a direct neihgbor, if not on the same machine.There's also one advantage you typically make use of as a developer when webserver and database server are both running on your developer machine: The db connection can use shared memory, the fastest lane to the database. The only advantage to separation of the web and db server is not needing one single highly dimensioned server with enough capacities to process all incoming requests, even if you could count database requests to the web requests, when there wouldn't be concurrent uses of the database server not originating in web requests. As a developer you're the only user of your machine and there it's not a concern, but if you can manage to have that architecture the web application can profit from that, it only becomes a disadvatage again, if the load is very heavy, like millions/billions of users, thousands or even hundreds of thousands concurrently, as it's for Facebook, Google, etc. You're likely not in that boat, though.For on premise solutions for a few hundred users, perhaps thousand, of which you'd have a few tens concurrently acting, the only disadvantage of having many roles on the same server is safety against services getting down or slow. From the perspective of an application driven by web connection it's not helpful if only web or database server are available, the application becomes unusable when only one of them is down. too. So that architecture of separate roles only has advantages if there's anything that can continue to work woth only one of them.Click to expand...Thanks for the elaboration.Our doubt: 'devil is in the details'. Let me explain: with our currently in-production desktop applications, we have a fairly elaborate routine of setting up MsSQL connectivity that is run one time at the start of an application, including a number of shared SQL functions (for example DC_autoupdate(&arcust,""c_alias"") that will sync cursor c_alias with SQL table 'arcust01' field by field ); my question is where do I place this startup routine in my WWWC, or any web server ?On separation of web and database servers, there is no issue here. Our MSSQL is installed on a Windows server with max processing power but the web server serves a very minor role and is installed on a regular PC on the same LAN as other servers for product browsing only. We are just trying to replicate one desktop function (maybe more later) that can be performed from a web page on a cell phone. And that is where SPT comes into play."
Reply,Westwind Web Connection server on LAN:  can SPT (MS SQL) work ?,Steve Yu,"Jan 30, 2025 at 3:27 PM",https://www.tek-tips.com/threads/westwind-web-connection-server-on-lan-can-spt-ms-sql-work.1832929/,Chris Miller,"Steve Yu said:the web server serves a very minor role and is installed on a regular PCClick to expand...Well, that's not a good decision. Web is stateless, so you don't keep a connection open. If the web server is not on the same server as MSSQL, it should still run on a server, or needing to reconnect with every request becomes a pita, all aspects aside that make it feasible, still.And you shouldn't take it as challenge to make your web server stateful, the web is stateless by intentional design, not as a design flaw.Admitted: Someone with web application development experience might say I'm telling bullshit, and isn't even wrong, as the stateless nature of the http protocol doesn't mean that no states are kept. A clear example you experience as a web user is that you only log in once, and then a session is established until you either log out or the session times out. There is a state that's kept, but then it's also not kept up as the state of a desktop application that is the process it is and runs until the user exits or shuts down the computer.There are mainly two modes of operations regarding sessions: Eithter the login sets a session coookie in the users browser and that is repeatedly sent over to the server with each request so the server can look up what user the request comes from or there's a bearer token, that's likewise sent to the server with every subsequent request after the login. The two options are quite well descirbed here:https://www.criipto.com/blog/session-token-based-authentication1. I don't think you ever thought about that and now you're at programming the user frontend to that you're not getting all that automatically, as the browser does, but would need to program it into your frontend.2. These mechanisms keep a state, the user reidentification. Look into the details of the linked article and you see the more recent modern bearer token approach is still described as having a stateless nature. Because every request has to contain the info, session id or bearer token, to know who made that request. There's the oAuth 1.0a scheme where every subsequent request is signed and there's not just a constant value to reassure which user the request is from, the signature uses a key pair mechanism and allows the verification that's a prove of authantic request and not just proving to know a token or session id that could be stolen.3. Still, most any usual web scripts open and close a database connection for every request, you don't keep a connection open.Now you can ask, why not keep a connection open that's not even specific to a user but just a general connection to the database server. Well, the way a web request is handled is the PHP script or your web connection script ending, there's no variable kept, no state kept, so what you would need to introduce is a persistent object or process that does so. I doubt you get that much of it, I don't have used web connection myself to know or tell you whether something like that may be foreseen, but it's not the normal nature of a web application to have anything that's kept running aside from the web server itself to receive and forward requests to the single scripts executed that respond and finally close down again.There's the relativela new concept of web workers, that's a client side (JS) feature, not a server side feature, though. So if you want to keep something up and running that keeps a SQL Server connection the only feasible mechanism you have, I think is running a COM Server EXE on the web server PC in paralle to IIS that could be started like an OLE automatable appication could be started and that you ""connect"" to by a web connection script via GetObject() instead of CreateObject(), that would only always instanciate a new COM object instance. The stability of that depends on how stable that COM Server would be and the security of it, too, how you enable any process to attach to it that way or require some means of authentication, too. And overall, you're going through more hoops, just to have an SQL connection handle kept open. Which is the reason for 3, again, server side code just is there to answer one request with a response and then ""die"".What's commonly saved are the responses, ie. you cache a response when it is potentially the same result for a time out, if no forever, and cache it, there's a lot about cahing mechanism, but you don't keep open a database connection for convenience. What's happening on that level is what I also already described in my firs post, the connection pooling, making it faster to reconnect."
Reply,Westwind Web Connection server on LAN:  can SPT (MS SQL) work ?,Steve Yu,"Jan 30, 2025 at 3:27 PM",https://www.tek-tips.com/threads/westwind-web-connection-server-on-lan-can-spt-ms-sql-work.1832929/,Steve Yu,"Chris Miller said:Well, that's not a good decision. Web is stateless, so you don't keep a connection open. If the web server is not on the same server as MSSQL, it should still run on a server, or needing to reconnect with every request becomes a pita, all aspects aside that make it feasible, still.And you shouldn't take it as challenge to make your web server stateful, the web is stateless by intentional design, not as a design flaw.Click to expand...All we are trying to do here is to replicate one desktop function on a web platform so people with a cell phone can perform the same desktop function within the range of our wifi coverage area.VFP question on web: what is the effect and scope of 'Set procedure to ...' ? Can I make it shared by all requests ?"
Reply,Westwind Web Connection server on LAN:  can SPT (MS SQL) work ?,Steve Yu,"Jan 30, 2025 at 3:27 PM",https://www.tek-tips.com/threads/westwind-web-connection-server-on-lan-can-spt-ms-sql-work.1832929/,Chris Miller,"The web connection framework is catching all requests coming in from IIS, will determine a handler, a class you write, create a new instance of that class and run a method of it, that's where your code comes in. You have nothing to rely on you get forwarded a request object that gives you access to the request, parameters passed in etc.The point is the instance of your class is new, anything that you store in properties of your class instance will not exist in the next request.I get the impression you never used web connect before, though you start saying you have a web connection server running and using DBF based data. I can only suggest you wet your feet and go into writing something starting from what you already have."
Reply,Westwind Web Connection server on LAN:  can SPT (MS SQL) work ?,Steve Yu,"Jan 30, 2025 at 3:27 PM",https://www.tek-tips.com/threads/westwind-web-connection-server-on-lan-can-spt-ms-sql-work.1832929/,Steve Yu,"Chris Miller said:The web connection framework is catching all requests coming in from IIS, will determine a handler, a class you write, create a new instance of that class and run a method of it, that's where your code comes in. You have nothing to rely on you get forwarded a request object that gives you access to the request, parameters passed in etc.The point is the instance of your class is new, anything that you store in properties of your class instance will not exist in the next request.I get the impression you never used web connect before, though you start saying you have a web connection server running and using DBF based data. I can only suggest you wet your feet and go into writing something starting from what you already have.Click to expand...Our version of  the WWWC server is very heavily modified and I do see some shared logic by all sessions; not sure how that all tie together. We've been doing it on the fly and it has worked well so far. Let me try adding the SQL logic and will report back to you shortly.Always appreciate your help."
Question,selected marking of target,gbcpastor,"Feb 4, 2025 at 1:05 PM",https://www.tek-tips.com/threads/selected-marking-of-target.1832968/,gbcpastor,"I need to mark the first 3 records in a field called TARGET when the field called MAILCODE contains ""123ABC""Then repeat the process for each value in the MAILCODE field.Please help!"
Reply,selected marking of target,gbcpastor,"Feb 4, 2025 at 1:05 PM",https://www.tek-tips.com/threads/selected-marking-of-target.1832968/,Scott24x7,"What do you mean by ""mark""?  Mark them how?"
Reply,selected marking of target,gbcpastor,"Feb 4, 2025 at 1:05 PM",https://www.tek-tips.com/threads/selected-marking-of-target.1832968/,Chris Miller,"First threee of a group of the same mailcode, I assume. Then by which order, first three requires an order to tell what's the first three in some specific order.If you mean by physical order, then the straight forward xbase code would beCode:* determine all unique mailcodes

SELECT DISTINCT MAILCODE as mailcode from yourtable INTO CURSOR mailcodes
* go through each of them
SELECT yourtable
SET ORDER TO mailcode

SELECT mailcodes
SCAN
   SELECT yourtable
   SET KEY TO mailcodes.mailcode
   SCAN NEXT 3
      *do whatever - mark records as found/relevant, process them
   ENDSCAN
ENDSCAN"
Reply,selected marking of target,gbcpastor,"Feb 4, 2025 at 1:05 PM",https://www.tek-tips.com/threads/selected-marking-of-target.1832968/,gbcpastor,"Chris Miller said:First threee of a group of the same mailcode, I assume. Then by which order, first three requires an order to tell what's the first three in some specific order.If you mean by physical order, then the straight forward xbase code would beCode:* determine all unique mailcodes

SELECT DISTINCT MAILCODE as mailcode from yourtable INTO CURSOR mailcodes
* go through each of them
SELECT yourtable
SET ORDER TO mailcode

SELECT mailcodes
SCAN
   SELECT yourtable
   SET KEY TO mailcodes.mailcode
   SCAN NEXT 3
      *do whatever - mark records as found/relevant, process them
   ENDSCAN
ENDSCANClick to expand...Perfect Chris, thank you so much for your help."
Question,VFP File Lock Issues with Windows Server,rbeitler,"Jan 29, 2025 at 10:43 PM",https://www.tek-tips.com/threads/vfp-file-lock-issues-with-windows-server.1832914/,rbeitler,"About 2.5 weeks ago we starting seeing issues with file locks.  Typically getting error 1705 ""File access is denied"".  We have an internal VFP app that runs in 3 locations, each with its own server, and started seeing this at all locations.  For the most part, this is code that has been running fine for years with no issues.The code in particular where these issues happen do have some things in common:If a dbf is open shared, but then needs to be opened exclusive, the error will happen even in no one else is using the dbf (usually temporary tables)Calling FOPEN on a log file during a loop where is is repeatedly doing FOPEN and FCLOSE on the same file.So in both cases it seems to be tripping on itself so to speak.The files are accessed over the network via Windows Server.  We tried to disable oplocks using the set-smbshare and setting the LeasingMode to none. Every time we reboot the server everything works for a day or two.  Then issues start to come back.  We tried disabling antivirus, no joy.We are in the process of refactoring our code to avoid this situation, like open exclusive the first time, keep log files open, etc.Has anyone else who still uses VFP seen any similar behavior?"
Reply,VFP File Lock Issues with Windows Server,rbeitler,"Jan 29, 2025 at 10:43 PM",https://www.tek-tips.com/threads/vfp-file-lock-issues-with-windows-server.1832914/,mmerlinn,"rbeitler said:So in both cases it seems to be tripping on itself so to speak.Click to expand...Tripping on itself? That suggests timing issues.Try inserting some timing delays in your code to see if that solves the problem.  If it does, then you will have a better idea how to attack the problem."
Reply,VFP File Lock Issues with Windows Server,rbeitler,"Jan 29, 2025 at 10:43 PM",https://www.tek-tips.com/threads/vfp-file-lock-issues-with-windows-server.1832914/,Joe Crescenzi,"rbeitler said:So in both cases it seems to be tripping on itself so to speak.The files are accessed over the network via Windows Server.  We tried to disable oplocks using the set-smbshare and setting the LeasingMode to none. Every time we reboot theClick to expand...Years ago we had terms for this scenario, ""Deadlock"" and ""The Deadly Embrace"", which was a situation where you have two resources competing for access.  In some cases one process is waiting for another process to complete before moving on, yet the second process could, in fact, be waiting for the first process to complete, hence the deadlock.To avoid a Deadlock, you should consider trapping those situations so they are not locking something while waiting to get access to something else that is locked because it's possible that the other task is doing likewise waiting for whatever locks you already have.@mmerlinnis correct, timing plays a big role.  You should try to limit the amount of time you need exclusive use of anything, whether it's a record or a file.  Personally, I only open DBFs in shared mode unless I am reindexing or altering the structure, but if you have no workaround, you need to keep those exclusive uses as short as possible and release the exclusive use as quickly as possible.Back in the 80s, before true shared networking was possible what people did was work in batches.  You wrote your information to a temp file, which you had exclusive use of, then had a way to combine your temp file with the live master later.You can use the same idea with the log file.  If an FOPEN is trying to write to a log the entire time, see if you can save it to a temp file, which is always exclusive and then append the resulting file to the complete log at the end, so instead of keeping the full log open the whole time, it only needs to open it for a fraction of a second while your temporary log is appended.HOWEVER, if the system has worked all these years, and you've never needed any of these techniques before, there's still a chance it's from a hanging lock from an aborted session.  Simply stated. if there are no other people using a file, it should never block you from opening it exclusively.One scenario I've seen is that a user may have a file open, then their system goes into suspend or hibernate mode, or even reboots or shuts down unexpectedly, and somehow the server doesn't realize they are no longer there.  Another scenario I've seen is where a client had a web portal that allowed people to view some of the data online.  The web server typically keeps those files open long after the web session closes.  Lastly, I've seen backup systems that interfere with file access.If you have a traditional Windows shared folder, you should be able to see what files are open at any given time and by which account(s) and even know if there are any record locks in use.  If nothing else, once you identify who the system thinks is using the file you can determine whether it's even somebody who is no longer logged in."
Reply,VFP File Lock Issues with Windows Server,rbeitler,"Jan 29, 2025 at 10:43 PM",https://www.tek-tips.com/threads/vfp-file-lock-issues-with-windows-server.1832914/,Chris Miller,"Are you using views in a shared dbc, too? You did explicitly tal about dbfs, I know, and log files, that are neither views. I mention it because for views it's a known issue, that in the moment a view is opened, an error 1705 can happen, and the solution to that is to let every user have thier own copy of a view dbc and only share a dbc with dbfs.rbeitler said:If a dbf is open shared, but then needs to be opened exclusive, the error will happen even in no one else is using the dbf (usually temporary tables)Click to expand...Why use temp tables instead of cursor? I guess there is a reason. But then are they created locally or in the share? Everything you create for a single user, that's used in a report, for example, should not even get a remote chance of causing trouble with other users creating the same temp file in the same place. There's TEMP for temp files.Is Terminal server involved? MS does give user sessions each a separate local TEMP folder on the terminal server, which avoids double usage of the same temp file, of course, but if you set temp files in your application to something else than the OS this could cause double usage of the same file again on different user sessions running in the same terminal server. I therefore strongly recommend using the Windows TEMP folder always, even if you're not using terminal server right now, it makes the transition a lot easier, if it would ever be considered.If you have a dbf for which the lock problem occurs most often, it pays to use procmon for file monitoring to see what has file handles on files and see what's happening on the dbfs, whether it's really the same client tripping over its own usage.Both local AV and server side AV could potentially act on share files, the server AV because it's examining all server side files an also shares, local AV could because a process is opening files of a server share. So AV still might being the issue."
Reply,VFP File Lock Issues with Windows Server,rbeitler,"Jan 29, 2025 at 10:43 PM",https://www.tek-tips.com/threads/vfp-file-lock-issues-with-windows-server.1832914/,Chris Miller,"By the way, doing some experimenting:Using one VFP IDE (process) with one datasession:Using a dbf shared or exclusive in one workarea, then tryingUSE thesame.dbf EXCLUSIVE leads to error 3, not 1705Which also means you can even use the same dbf twice in the same datasession with another alias name,i.e.USE thesame.dbf EXCLUSIVE ALIAS othername AGAIN IN 0 works.Using one VFP IDE (process) with two datasessions:Trying USE thesame.dbf EXCLUSIVE also triggers error 3, not 1705.Using a second VFP IDE (process):Trying USE thesame.dbf EXCLUSIVE triggers error 1705.It's exhaustive enough for me, but you might consider further cases, like exclusive access with other alias name and AGAIN clause in a second datasession (but still the same process). I'm also currently only using a notebook not joined to a network. So actual network challenges are untested, actual multi users, too.I'm quite sure, though,  that the same user could only trip on its own usage with error 1705 in a separate process, like the same application started twice. If your application logic doesn't consider that case, it's not really the same user for the file system, if it's a second process, even when that runs on the same Windows user account on the same client PC.Otherwise it should be a second user or process access to the same file, also possibly by AV running clientorserver side or both. As you say this is happening on multiple locations each with their own server, it's pointing towards a windows update causing that, but I'm not aware of a new general locks problem in networking than the over a decade old oplocks problem. A new user starting the application multiple times to do things in parallel, for example, would also only be a new ""pattern"" on one location, not on all three locations at the same time, very unlikely, unless a new feature is making that a logical solution to users. The least probable, but still also a scenario I wouldn't encounter for the first time is usage of an old feature for the first time, even though it's already old. That means, a feature that never worked, but was just also never used. Also quite unlikely in three locations, so perhaps rather a newer feature, have you introduced something in the time the problem began to occur?"
Reply,VFP File Lock Issues with Windows Server,rbeitler,"Jan 29, 2025 at 10:43 PM",https://www.tek-tips.com/threads/vfp-file-lock-issues-with-windows-server.1832914/,rbeitler,"Thank you for all of the replies.Few things:We are not using views or dbc.  Just dbf ""free"" tables.The ""temporary"" dbfs that get zapped, we like them to persist on the shared disk so that users can see the information from the last batch and reprint etc.We have a global error handler that presents the user with the error and the option to ""Retry"".  If they choose this, the RETRY command is issued.  When this access denied issue started, using this retry option let's the program continue successfully.  In the case of the USE EXCLUSIVE, this is a one time event and everything works.  But in the case of a loop writing to the log file, it can cause repeated errors and if the user presses retry over and over, it will eventually get through ok.I am also suspecting a windows update that changed the behavior of SMB.I am refactoring as much of the problematic code to be more resilient (not a bad thing anyway)We are also looking at moving the whole application to be run from the server using RDS or APP-V or whatever it is called now"
Reply,VFP File Lock Issues with Windows Server,rbeitler,"Jan 29, 2025 at 10:43 PM",https://www.tek-tips.com/threads/vfp-file-lock-issues-with-windows-server.1832914/,Chris Miller,"rbeitler said:The ""temporary"" dbfs that get zapped, we like them to persist on the shared disk so that users can see the information from the last batch and reprint etc.Click to expand...That has contradicting aspects, doesn't it. It only remains until the next user reuses these temp dbfs, doesn't it? If you want to keep last printed data, then either do so locally or when in the global share, let each user have a directory so that concurrent usage also is avoided, not only rarely happening. If you only use one set of DBFs because reports data environments have these in them, well, think about using USE commands in the report dataenvironment event code and use GETENV(""USERNAME"") or ID() for the per user aspect."
Reply,VFP File Lock Issues with Windows Server,rbeitler,"Jan 29, 2025 at 10:43 PM",https://www.tek-tips.com/threads/vfp-file-lock-issues-with-windows-server.1832914/,Chris Miller,"On the topic of locks overall, it's not only a problem to USE a dbf exclusive, if you do everything shared you also get locking problems, even without any manual locks, because there's always the need to have at least temporary exclusive access to a file in a FAT or NTFS file system to write to a file. That's not a VFP mechanism or need, that's based on the file system philosophy and by design. Concurrent writing to DBFs will usually trigger error 108 (""File is in use by another user"") in contrast to 1705 (""Fie acccess is denied""). Both errors can be resolved by RETRY, indeed, but it could take much too long. It's recommended to let VFP retry at least, that's configurable with SET REPROCESS.If a file really is in use by another user, that's usually a reason to do something else instead until the file becomes available for exclusive access, again, but regarding some shared files for reports, that's not necessary with what I suggested already. The other common suggestion is to drive reports by cursors prepared before the report run and let those reports have NO private datasession to let them access the prepared cursors. Those don't have to be at a specific shared folder, they only have to exist and have specific alias names. To still be able to redo a report, debug report issues, etc. you can persist cursors simply using COPY TO. The persisted data can both be standaone free DBFs or DBC based DBFs, and so the usage of cursor doesn't contradict your needs, too. You'd never have a concurrency problem about the cursors, only about readong from source DBFs into cursors, of coursse, and later when writing to the same DBF files instead of a per user structure of data or other means of shared report data storage you could design.Anyway both 1705 and 108 point out concurrency by at least a different process, and likely another user, not tripping on the own foot."
Reply,VFP File Lock Issues with Windows Server,rbeitler,"Jan 29, 2025 at 10:43 PM",https://www.tek-tips.com/threads/vfp-file-lock-issues-with-windows-server.1832914/,rbeitler,"One of the things we are testing to help this issue is instead of running the vfp app on each client and accessing dbf over SMB, we have one user set up to use RDP into the file server and run the vfp app directly on the server.  After cleaning up some file path issues, it is running well.  Actually extremely well.  Speed when processing files is an order of magnitude better.  This makes sense as they are on the local hard drive (SSD) vs going over the network through SMB.So at this point we are planning to move everyone to that setup by enabling remote desktop services so we can have more than 2 people connected.But I have seen more seamless ways to do this with Citrix, or Microsoft RemoteApp.  Did a little research and RemoteApp seems like it would be the way to go.  So we are going to give this a shot.Any caveats implementing RemoteApp with a VFP application?"
Reply,VFP File Lock Issues with Windows Server,rbeitler,"Jan 29, 2025 at 10:43 PM",https://www.tek-tips.com/threads/vfp-file-lock-issues-with-windows-server.1832914/,Chris Miller,"Fine, if that helps. Well, the first topic to think about running a VFP exe remotely on a server: All users now use that one server (Windows Terminal Server could provide a better basis and also allow runnning multiple servers). The server is running multiple user sessions and so it has to be dimensioned with enough RAM and cpu cores as if you have a PC with 2,5,10, 100 users sitting in front of it with them logged in in parallel, not only one session active at a time, but all of them. Each user will only see its desktop on the remote client, but that's one of as many desktops as you run concurrent users. VFPs runtime RAM need is noly a few MB on GB RAM systems, so that's most of the time not the bottleneck, but all in all the server has to be dimensioned with enough RAM and all other resources used by as many users as you want to be able to serve concurrently."
Reply,VFP File Lock Issues with Windows Server,rbeitler,"Jan 29, 2025 at 10:43 PM",https://www.tek-tips.com/threads/vfp-file-lock-issues-with-windows-server.1832914/,Chris Miller,"The second thing to notice is that the user client is not running the software anymore, and also the server running your EXE is not getting a drive letter of a thumb drive a user inserts, for example, or any other attached hardware. RDP (Rmeote Desktop) allows to define that drives are forwarded in the form of \\tsclient\$Driveletter, so \\tsclient\$H for a USB drive mapped with drive letter H: at the client. Other things mnot available on the server obviously are local printers, so you'll use network printers. Overall , there are such things that require changes in your application. One sin is to have code using local drives that usually with every user having their own PC/client would not collide, say on drive C:\yourapp\somedata\, but now are a shared directory for all users on the servers C:\ drive. So anything you relied on to be exclusive to the user on his own local drives is not exclusive anymore, any hardware,printer atc of clients is not attached to the server, of course.Also look into what you get from ID(), GETENV(""TEMP"") and other such environment variables when running on the server vs. on the client."
Question,SQL Server data processing with VFP 8,bharons,"Jan 23, 2025 at 7:28 AM",https://www.tek-tips.com/threads/sql-server-data-processing-with-vfp-8.1832848/,bharons,"good morning experts...Please correct my code below, because only one line of data appears:Code:m.tanggal = thisform.txtTanggal.value
lnResult = SQLExec(Thisform.nHandle, ""select top (20) * from dbo.detail where tanggal = ?m.tanggal"", ""detailku"")
lnResult = SQLExec(Thisform.nHandle, ""select top (20) * from dbo.debitur where norekening = ?detailku.norekening"", ""debiturku"")
lnResult = SQLExec(Thisform.nHandle, ""select top (20) * from dbo.nasabah where cif = ?debiturku.cif"", ""nasabahku"")
lnResult = SQLExec(Thisform.nHandle, ""select top (20) * from dbo.jaminan where norekening = ?detailku.norekening"", ""jaminanku"")

select    debiturku.norekening,detailku.tanggal,nasabahku.nama,jaminanku.keterangan ;
from     detailku ;
join     debiturku on detailku.norekening = debiturku.norekening ;
join     nasabahku on debiturku.cif = nasabahku.cif ;
join     jaminanku on detailku.norekening = jaminanku.norekening ;
where     detailku.sandi = 3 group by 1,2,3,4 order by 1 ;
into cursor templunas readwriteand if I browse detailku it shows a lot of data as shown in the image below"
Reply,SQL Server data processing with VFP 8,bharons,"Jan 23, 2025 at 7:28 AM",https://www.tek-tips.com/threads/sql-server-data-processing-with-vfp-8.1832848/,Chris Miller,"Simple reason...After the first query you have a bunch of records in the VFP cursor detailku.Your second query has the where clause ""where norekening = ?detailku.norekening"". That will only put in the value of detailku.norekening in the first row of detailku.SQL Server has no access to the VFP cursors. Even if it would, you don't join detailku in your second query, so you only get the data for one detailku.norekening value.Why are you getting all the cursors, if you finally want the result of your VFP query, do that on the level of the SQL Server with one query in SQL Server and you'd have your final result in one go."
Reply,SQL Server data processing with VFP 8,bharons,"Jan 23, 2025 at 7:28 AM",https://www.tek-tips.com/threads/sql-server-data-processing-with-vfp-8.1832848/,bharons,"in second query i use this :Code:lnResult = SQLExec(Thisform.nHandle, ""select top (20) * from dbo.debitur join detailku on norekening = detailku.norekening"", ""debiturku"")it is give me massage box that need to enter value for debiturku.cif (view parameter).."
Reply,SQL Server data processing with VFP 8,bharons,"Jan 23, 2025 at 7:28 AM",https://www.tek-tips.com/threads/sql-server-data-processing-with-vfp-8.1832848/,bharons,"Chris Miller said:Simple reason...After the first query you have a bunch of records in the VFP cursor detailku.Your second query has the where clause ""where norekening = ?detailku.norekening"". That will only put in the value of detailku.norekening in the first row of detailku.SQL Server has no access to the VFP cursors. Even if it would, you don't join detailku in your second query, so you only get the data for one detailku.norekening value.Why are you getting all the cursors, if you finally want the result of your VFP query, do that on the level of the SQL Server with one query in SQL Server and you'd have your final result in one go.Click to expand...well i try this code :Code:lnResult =  SQLExec(Thisform.nHandle, ""select top (20) detail.norekening, detail.tanggal, jaminan.keterangan from dbo.detail join dbo.debitur on detail.norekening = debitur.norekening join dbo.jaminan on detail.norekening = jaminan.norekening where detail.tanggal = ?m.tanggal"", ""debiturku"")it is give me the record, while i create join with dbo.jaminan. i got massage that ""command contains unrecognized phrase / keyword.""Code:lnResult =  SQLExec(Thisform.nHandle, ""select top (20) detail.norekening, nasabah.nama, detail.tanggal, jaminan.keterangan from dbo.detail join dbo.debitur on detail.norekening = debitur.norekening join dbo.nasabah on debitur.cif = nasabah.cif join dbo.jaminan on detail.norekening = jaminan.norekening where detail.tanggal = ?m.tanggal"", ""debiturku"")can you tell me which one missing on my code.."
Reply,SQL Server data processing with VFP 8,bharons,"Jan 23, 2025 at 7:28 AM",https://www.tek-tips.com/threads/sql-server-data-processing-with-vfp-8.1832848/,Chris Miller,"You're trying to ride a dead horse. No matter how you shift it around, a parameter within SQLExecs cSQLCommand parameter is only a single value, it can't be a whole table/workarea/cursor nor a whole column of a table, it's always a single value.Your idea is not working.Instead of getting several cursors you finally join within VFP, do the SQL that's necessary overall to get the final result within SQL Server."
Reply,SQL Server data processing with VFP 8,bharons,"Jan 23, 2025 at 7:28 AM",https://www.tek-tips.com/threads/sql-server-data-processing-with-vfp-8.1832848/,Chris Miller,"I don't know what you actually need sepcifically to your database, but as generalization, you might adapt a FoxPro application that was DBF based to SQL Server and are used to not just having a joined resultset, but the two, three or more tables with their separate records, i.e. not all order data joined into one result but 1 order record in one order cursor and all orderitems in an orderitems cursor. That to not talk about the situation you would usually have in a dbf based solution of simply opening orders in one workarea and orderitems in another, meaning having access to all orders and all orderitems of all orders, no filtering at all.The last and very usual VFP scenario doesn't work well, it doesn't scale well at all, when using an MS SQL (or other server) backend, just doing SELECT * FROM SERVERTABLE instead of USING DBFTABLE will give you access to all records, too, but selecting all data from a server actually copies them over, USEing a DBF does not load all it's data, you can browse it and scroll down to the end and read all data that way, but the USE itself just positions you on record 1 and only perhaps for a caching strategy, VFP or the filesystem will fetch more than that first one record. Surely it will never fetch all data, though. That's also a misconception some Fox developers have. But take that aside, unimportant. As that does not scale well, it will just take a lot of time to read in a lot of data you don't need at all.An adaption to a server backend will always require you to rethink data access and not just hammer it into a way all VFP code can continue to work as is, once the same workarea names are populated. When you work on an order, you only need the one order record and only the orderitems that elong to that order. You don't need the zillion other records you may have. So don't fetch them.Now comes the advice on how to get there, even in one SQLEXEC. You cannot only execute a single query, when you have multiple queries in the cSQLCommand parameter, you get multiple results either in one go or with the help of SQLMORERESULTS() - look at it in the VFP help.Here's a short breakdown. Depending on whether you SQL connection works in batchmode or not, you will be able to get all in one SQLEXEC or get one of the results with SQLMORERESULTS.To give an example, assume a database with three tables ""drives"" (hard disk drives), ""directories"" and ""files"". Then this SQL Script will query these tables separately instead of joining them into one result:Code:h = SQLConnect(""mssql"") && however you connect. Here it's done by DSN.

Text To cSQL noshow
Select drives.* from drives
   where driveletter='C'

Select directories.* from drives
   left join directories on directories.driveid = drives.id
   where driveletter='C'

Select files.* from drives
   left join directories on directories.driveid = drives.id
   left join files on files.directoryid = directories.id
   where driveletter='C'
EndText

* in batch mode an sql batch with multiple results fetches all of them
SQLSetProp(h,""BatchMode"",.T.)
nResult = SQLExec(h,cSQL,""overalldata"",aDriveCursors)
* In this case you will get cursors ""overalldata"" (drives), ""overalldata1"" (directoriess) and ""overalldata2"" (files)

* Turning batch mode off, VFP will only fetch the first result of an sql batch with multiple results
SQLSetProp(h,""BatchMode"",.F.)

* So now you need the SQLExec and two further SQLMoreResults calls:
nResult = SQLExec(h,cSQL,""drive"",aDriveCursors)
nResult = SQLMoreResults(h,""directories"")
nResult = SQLMoreResults(h,""files"")
* one advantage of this is that you have control about the three cursor names.
Do While nResult<2
   nResult = SQLMoreResults(h,""dummy"")
EndDo""Wait"", you'll say, ""didn't you say no joins?""Look at the selected columns, the first query only selects drives columns (drives.*) the second only directories columns (directories.*) and the third only files columns (files.*), the joins are necessary to be able to use the general where clausewhere driveletter='C'.And the while loop at the end ensures VFP will know the batch terminated. While you know, in this case, that there are always exactly 3 results in the SQL script batch, there's no point fur further SQLMoreResults, VFP does not know. For VFP the batch only finishes when SQLMoreResults returns 2, and that will only be the case, when you ask it for one further result. It's important VFP realizes that, because you can only make the next SQLExec call, otherwise you get the error message ""Invalid call issued while executing a SQLMORERESULTS() sequence.""So that's the downside of SQLMoreResults, the end of the batch does (not necessarily) come back when you fetch the last result, but when you ask for a further result when there isn't one more.Anyway you do it (in Batchmode=.T. or .F.) - it's an example of how to get at the subsets of interest, which is very generally what you need to do when changing from a DBF backend to a server backend.Remark: I choose a sample that's intuitively understoof of hdd drives with their directories and files. The structure obvóusly has a drives table as root/head, then a directories table and finally files (drives->directories->files).All files of drive C:\ could be too much data to fetch, that's not making this a good example of reducing the data amount to something managable, but this was just to illustrate how to get multiple sql results either in one go in batchmode or by using SQLMoreResults. And for that I considered the intuitive understanding is more important than how realistic it is. I intentionally gave no actual data schema and data for this. This is not for copy&paste execution, this is for understanding the principles and then adapting it to whatever concrete data subset you'd be interested in from your specific database."
Reply,SQL Server data processing with VFP 8,bharons,"Jan 23, 2025 at 7:28 AM",https://www.tek-tips.com/threads/sql-server-data-processing-with-vfp-8.1832848/,Chris Miller,"To add to the sql script example:Code:Select drives.* from drives
   where driveletter='C'

Select directories.* from drives
   left join directories on directories.driveid = drives.id
   where driveletter='C'

Select files.* from drives
   left join directories on directories.driveid = drives.id
   left join files on files.directoryid = directories.id
   where driveletter='C'Not only could 'C' be a parameter, you could use declaration of SQL variables, in MS SQL Server done withDECLARE @varname as datatype, which includes using table valued variables - kind of temp tables or cursors, but within variable space, not in the temp database. Which, on the other side, you can also use. You can do a lot of things, it just requires to dive deeper into the SQL language of the Server, like T-SQL is for MSSQL. It pays to do that."
Reply,SQL Server data processing with VFP 8,bharons,"Jan 23, 2025 at 7:28 AM",https://www.tek-tips.com/threads/sql-server-data-processing-with-vfp-8.1832848/,Chris Miller,"Another even simpler example for the sql script batch that's less theoretical:SQL:Select * From orders where id=?orderid;

Select * From orderitems where orderid=?orderid;Here, due to the flatter hierarchy, you don't need Select orderitems.* from orders left join orderitems on orderitems.orderid=orders.id where orders.orderid=?orderid. As the orderitems table has the orderid itself, so you don't need to join up to orders as was necessary for a where clause like driveletter='C' which is a condition you can only test when reading the drive record.The more important point is now: Altough that's the major subset of the data of an order, for a form to modify an order you likely don't just want to be able to delete order items or change their quantity, you might want to add an orderitem or change one to another specific product, but for that you also need the full products table. No problem to add in aSELECT * FROM products, but initially you only needCode:Select products.* from orderitems left join products on orderitems.productid = products.id
where orderitems.orderid = ?orderidThat would only give you the products within that one order, not any other.Now it's up to you. But in the sense of not fetching all data of any table ever, except perhaps for very short tables, you should change the design of an application that previously simply USE Products for that feature and have a view or query that can fetch products starting with (at minimum) the first 3 letters of the product name or something like that. The product choice may also be changed to a two step process of first selecting a product category and then only fetch products of that category. The major idea is still the same: Have queries with a high selectivity. That means the opposite of what it sounds like, high selectivity means a simple filter condition already is very selective and only addresses a small subset of the data. It always boild down to keep the amount of data managable, that goes through the network bottleneck. An orderid is such a thing, as each order - even a big order with 100s of items - is a small subset of all orders and orderitems in the database.In a web application the bottleneck differs to that of a desktop application, by the way, as a web application usually will have data local to the web server or at least in a network neighborhood with high bandwidth to it, while what's transferred to the end user interface is only a small subset of that. You can still do that wrong and have a HTML list of products with all products, that also blows up the usage of the small bottleneck between web server and client browser."
Reply,SQL Server data processing with VFP 8,bharons,"Jan 23, 2025 at 7:28 AM",https://www.tek-tips.com/threads/sql-server-data-processing-with-vfp-8.1832848/,bharons,"dear Chriss my great lecturer..this is my sampling sql server database in format excel..I use the coding below, to produce data that has the maximum value based on the criteria of the norekening column, the selisih column (number of days)..The question is whether the coding I used is wrong...Code:TEXT TO m.lcSQL noshow
select n.cif, d.norekening, n.nama, d.nomor,
d4.tanggal, d4.ke, d4.tanggal_lunas, d4.ke_lunas, d4.jenis,
d4.agunan, d4.kunci, d4.sandi, d4.selisih
from dbo.debitur d inner join
(select d3.norekening, d3.tanggal, d3.ke, j1.tanggal_lunas,
j1.ke_lunas, j1.jenis, j1.agunan, j1.kunci, j1.sandi,
datediff(day,tgl_jt, tanggal) as selisih
from dbo.detail d3 inner join
(select j.norekening, d2.tanggal as tanggal_lunas,
d2.ke as ke_lunas, j.jenis, j.keterangan as agunan,
iif(j.jenis = 1, j.nomesin, j.shm_no) as kunci, d2.sandi
from dbo.jaminan j inner join
(select norekening, tanggal, ke, sandi
from dbo.detail where tanggal = ?m.tanggal and sandi = 3) d2
on j.norekening = d2.norekening) j1
on j1.norekening = d3.norekening) d4
on d.norekening = d4.norekening inner join dbo.nasabah n
on d.cif = n.cif
group by n.cif, d.norekening, n.nama, d.nomor,
d4.tanggal, d4.ke, d4.tanggal_lunas, d4.ke_lunas, d4.jenis,
d4.agunan, d4.kunci, d4.sandi, d4.selisih
having max(d4.selisih) = d4.selisih
ENDTEXT

m.tanggal = thisform.txtTanggal.value
lnResult = SQLExec(Thisform.nHandle, m.lcSQL, ""templunas"")   
    
If m.lnResult < 0
    Aerror(aWhy)
    Messagebox(aWhy[2])
    SQLDisconnect(0)
    Return .F.
Else
select templunas
browse
endifThank you before and after for your understanding, attention and enlightenment.."
Question,Cleaning fields with zeroes,SitesMasstec,"Jan 27, 2025 at 9:48 PM",https://www.tek-tips.com/threads/cleaning-fields-with-zeroes.1832893/,SitesMasstec,"Hello colleagues!I have this in a form:I have used a way to blank the field in the third column (when there are zeroes):Code:FOR NF=1 TO 12
    strNF=STR(NF,2)
    IF SUBSTR(strNF,1,1)="" ""
        strNF=""0""+SUBSTR(strNF,2,1)
    ENDIF
    
*  Some commands here

    frase=""thisform.txtNFAVRPg"" + strNF + "".ForeColor""

    IF YNFAVRPG(NF)<>0.00  
        &frase=RGB(0,0,0)          && Black color
    ELSE
        &frase=RGB(255,255,255)     && White color
    ENDIF
NEXT NFIs there a neater way to achieve the same result?Thanks."
Reply,Cleaning fields with zeroes,SitesMasstec,"Jan 27, 2025 at 9:48 PM",https://www.tek-tips.com/threads/cleaning-fields-with-zeroes.1832893/,Chris Miller,"1. Set Textbox.Format=""Z"" to display zeros as blank.You keep forgettinhg things you already knew. We had that - between many other things - in your thread ""Numeric data entry from right""https://www.tek-tips.com/threads/numeric-data-entry-from-right-to-left.1829384/post-7568899You said you set Format to Z in that post. Even without being asked to do so. That's displaying zero values as blank."
Reply,Cleaning fields with zeroes,SitesMasstec,"Jan 27, 2025 at 9:48 PM",https://www.tek-tips.com/threads/cleaning-fields-with-zeroes.1832893/,SoftwareRT,"Your code is fine.How about this:Code:FOR NF = 1 TO 12
    * Format NF as a two-digit number
    strNF = TRANSFORM(NF, ""@L 99"")

    * Build the object name dynamically
    txtFieldName = ""thisform.txtNFAVRPg"" + strNF

    * Set the ForeColor property directly
    IF YNFAVRPG(NF) <> 0.00
        EVALUATE(txtFieldName).ForeColor = RGB(0, 0, 0)  && Black color
    ELSE
        EVALUATE(txtFieldName).ForeColor = RGB(255, 255, 255)  && White color
    ENDIF
NEXT NFReplaced &frase with EVALUATE() -- safer property setting.Used TRANSFORM() to format NF into a two-digit string, making the code cleaner.Using EVALUATE() as a direct object reference avoids the need to construct a command string (""frase = ""thisform.txtNFAVRPg"" + strNF + "".ForeColor""&frase = RGB(255, 255, 255)"" <-- Your code is converting a string and then interpreting it at runtime. This is prone to errors if the dynamically constructed string isn't correct."
Reply,Cleaning fields with zeroes,SitesMasstec,"Jan 27, 2025 at 9:48 PM",https://www.tek-tips.com/threads/cleaning-fields-with-zeroes.1832893/,SitesMasstec,"Oh, yes Chris!Format: ZI had forgotten.Thank you."
Reply,Cleaning fields with zeroes,SitesMasstec,"Jan 27, 2025 at 9:48 PM",https://www.tek-tips.com/threads/cleaning-fields-with-zeroes.1832893/,Chris Miller,"Actually all you need isCode:Thisform.Setall(""Format"",""Z"",""Textbox"")Or set it at designtime. When you have the time to add 1000 textboxes instead of a gird, you also have the time to set their properties.As you surely have other textboxes apart from the ones in the column that you want to display blank for zeros, you should make use of the third parameter of SetAll to only set it to specific textbox classes, like a numerictextbox class you should design. And then you also wouldn't even need this one line of code, as Format=""Z"" could be a setting for the numeric textbox class and then you need no code at all.Also: Use a grid here. In a grid you have to only set Text1.Format=""Z"" for the column that displays the numeric values. Besides displaying multiple rows just by setting a cursor to the grid."
Reply,Cleaning fields with zeroes,SitesMasstec,"Jan 27, 2025 at 9:48 PM",https://www.tek-tips.com/threads/cleaning-fields-with-zeroes.1832893/,SitesMasstec,"Chris: I use textboxes for data entry and Grid only for displaying data, because I have read about Grid is for data entry (there is a chapter im Kilofox about its complexities), so it's not for me.Thank you."
Reply,Cleaning fields with zeroes,SitesMasstec,"Jan 27, 2025 at 9:48 PM",https://www.tek-tips.com/threads/cleaning-fields-with-zeroes.1832893/,Chris Miller,"You meant grid isnotfor data entry. That's not a black&white truth, and not using a grid, which easily repeats rows, by actually using single controls repeatedly in a form is the bigger sin, if you ask me, than using this excuse to never use the grid for data entry.Let me make this one step clearer: Even if you take it for granted you only use a grid for displaying data, then you can do a grid for picking the row to edit and give the user the editing in a region of the form next to the grid, just the controls for one record. Picking the row could even be possible with fewer columns per row, when you argue that takes up to much space, or a user could pick from a combobox, which makes it less comfortable but more compact.Yet another idea: Display the current row in a container you position on top of the grid row having the single set of controls to edit/enter data in there. For the user it could even look, as if there is nothing special about this grid row, though it's not the grid row itself but something put in front of it.So you can both live by these rules and still not do the sin of having extensive repeats of controls on your form at all."
Reply,Cleaning fields with zeroes,SitesMasstec,"Jan 27, 2025 at 9:48 PM",https://www.tek-tips.com/threads/cleaning-fields-with-zeroes.1832893/,JackTheC,What about the command Blank field <fieldname>BLANK CommandBLANK [FIELDS FieldList] [DEFAULT [AUTOINC]] [Scope] [FOR lExpression1][WHILE lExpression2] [NOOPTIMIZE] [IN nWorkArea | cTableAlias]
Question,Some projects compiled by Net run in VFP,iswithzhz,"Jan 17, 2025 at 2:08 AM",https://www.tek-tips.com/threads/some-projects-compiled-by-net-run-in-vfp.1832785/,iswithzhz,"I have uploaded it tohttps://github.com/iswithzhzBut these are all in Chinese, and I will translate them into English when I have time."
Reply,Some projects compiled by Net run in VFP,iswithzhz,"Jan 17, 2025 at 2:08 AM",https://www.tek-tips.com/threads/some-projects-compiled-by-net-run-in-vfp.1832785/,iswithzhz,"Of course, none of this is free. If you are interested, you can run it in the VFP9 development environment, but releasing an EXE requires my authorization, and this applies in China as well.Leveraging the .NET ecosystem resources might be the best solution for ensuring the most stable commercial use of VFP."
Reply,Some projects compiled by Net run in VFP,iswithzhz,"Jan 17, 2025 at 2:08 AM",https://www.tek-tips.com/threads/some-projects-compiled-by-net-run-in-vfp.1832785/,Chris Miller,"If you want that, you should reconsider your Copyright Notice and don't associate this GitHub repository  with the MIT license.I'm not saying by once choosing and mentioning the MIT license in GitHub you're now forever bound to the terms. It's your repository, your choice.But the condition you want to have is contradicting the MIT license.I assume you picked MIT provisionally just as you had to specify a license to create the repos, but now better choose another license or define your own terms and conditions."
Reply,Some projects compiled by Net run in VFP,iswithzhz,"Jan 17, 2025 at 2:08 AM",https://www.tek-tips.com/threads/some-projects-compiled-by-net-run-in-vfp.1832785/,Chris Miller,"That said, I looked into your webview2 repository and within your sample project it seems much simpler to me than Christof Wollenhauptshttps://github.com/cwollenhaupt/fpCefSharp.I'm not yet in the details of it, but it seems a better candidate to me as an alternative to the Microsoft Web Browser OLE Control aka Shell.Explorer aka SHDocView of the ieframe.dllNice work!"
Reply,Some projects compiled by Net run in VFP,iswithzhz,"Jan 17, 2025 at 2:08 AM",https://www.tek-tips.com/threads/some-projects-compiled-by-net-run-in-vfp.1832785/,iswithzhz,"Chris Miller said:If you want that, you should reconsider your Copyright Notice and don't associate this GitHub repository  with the MIT license.I'm not saying by once choosing and mentioning the MIT license in GitHub you're now forever bound to the terms. It's your repository, your choice.But the condition you want to have is contradicting the MIT license.I assume you picked MIT provisionally just as you had to specify a license to create the repos, but now better choose another license or define your own terms and conditions.Click to expand...To associate with the MIT License and indicate that this encapsulation does not involve infringement, since WebView2 itself is under the MIT License, and because you are unaware of what I have encapsulated or what it might involve, it is declared that the encapsulation of WebView2 follows the MIT License. Additionally, if the encapsulated component is to be used in VFP (Visual FoxPro), it is important to reference the license of the source you are using. However, it should be noted that there is no explicit declaration stating that this is not a free project, and distributing the EXE may require proper authorization."
Reply,Some projects compiled by Net run in VFP,iswithzhz,"Jan 17, 2025 at 2:08 AM",https://www.tek-tips.com/threads/some-projects-compiled-by-net-run-in-vfp.1832785/,iswithzhz,"You can take a look at another project, NetChart, and compare its performance and features with the original FoxCharts project."
Reply,Some projects compiled by Net run in VFP,iswithzhz,"Jan 17, 2025 at 2:08 AM",https://www.tek-tips.com/threads/some-projects-compiled-by-net-run-in-vfp.1832785/,Chris Miller,"You got that wrong. The MIT license is not a perpetual license like the GNU GPL.MIT licenses allow commercial use. Users do not have to provide any other source code when releasing new software. Including the attributions and original MIT license in the reused code will suffice. And you don't need to put your own derivitive work under the MIT license.But if you do (as of know) you allow the same usage of your work for everyone and don't restrict usage of your work, as you want to only allow authorized usage. So, well, take it from the good news side: Making the attribution about including the WebView2 under the MIT license does not inject it into your project, i.e. and you can do that duty without putting your work under the MIT license too, but if you do, you refrain from the authorization, you can only claim a license fraud, if work derived from your work has no attribution. But you want more than that, it seems to me.So again, if you want that, you should change your legal notice quite a bit."
Reply,Some projects compiled by Net run in VFP,iswithzhz,"Jan 17, 2025 at 2:08 AM",https://www.tek-tips.com/threads/some-projects-compiled-by-net-run-in-vfp.1832785/,iswithzhz,"What I mean is roughly this: The MIT license allows for commercial use. When releasing new software, users are not required to provide additional source code. In VFP development mode, no authorization from me is needed to learn and understand what WebView2 is and what it can do for you. If you find it commercially valuable and believe it can create value for you, then you must obtain my authorization to package and call it in your EXE project. In the world of C#, there are many open-source resources available for use, but that doesn't mean you can use all of them for commercial purposes. You don't even know the license of the source I referenced—could it infringe on rights? Who would dare use it? By stating that the MIT license allows commercial use, I am clarifying that my reference to WebView2 falls under this license. For example, ""DevExpress"" can be used, and you can even package it into a DLL for VFP to call, but is that legal? Just because it can be called by VFP, does that make it legal?"
Reply,Some projects compiled by Net run in VFP,iswithzhz,"Jan 17, 2025 at 2:08 AM",https://www.tek-tips.com/threads/some-projects-compiled-by-net-run-in-vfp.1832785/,Chris Miller,"I think I have a btter understanding of this, but I think I finish this with warnings have been given and it's your choice to do it as you want. The MIT license explicitly grants more rights to anyone coming across your repositories as you want to grant.. So the way you write your The way you di it, you refrain from rights you want to claim, that's how I see it.Maybe it's all just about you naming your webview2 project just like the WebView2 itself, just once small case, once in camel case, you should just clarify that very explicitly.Edit: Just to illustrate the impression, it seems to me you're getting the opposite of what I try to bring over to you. I don't want to urge you into a free software license, I understand you don't want that, but the phrasing you have is not as clear as it could be, also given the risk of confusion."
Reply,Some projects compiled by Net run in VFP,iswithzhz,"Jan 17, 2025 at 2:08 AM",https://www.tek-tips.com/threads/some-projects-compiled-by-net-run-in-vfp.1832785/,ggreen61,"iswithzhz--​I am curious as to your use of ExcelGrid.  From the demo, it opens the xlsx file and displays in the screen -- what is the difference than using directly Excel to view the file?  Can VFP interact with the cell values directly in ExcelGrid by reading the cell values or writing new values to the cells?  Can ExcelGrid save the changes to the existing file or to a new file?"
Reply,Some projects compiled by Net run in VFP,iswithzhz,"Jan 17, 2025 at 2:08 AM",https://www.tek-tips.com/threads/some-projects-compiled-by-net-run-in-vfp.1832785/,iswithzhz,"In NetOffice v1.55, ExcelGrid supports saving changes to an existing file or saving as a new file by altering the save path.The purpose of designing ExcelGrid is to address the limitations of VFP FRX reports that cannot be printed, by rendering them in xlsx documents for print preview and printing. It also allows using existing xlsx documents as templates to populate data and generate reports. Additionally, it involves synchronizing cursor movements in VFP forms when interacting with business-specific xlsx documents, enabling real-time display of VFP application data during user interactions.The ExcelOperate class is designed to handle reading and writing VFP (Visual FoxPro) data without requiring Microsoft Office to be installed. It manages xlsx document formatting elements such asborders,font sizes, and other styling properties. The supported features include:Functionality List:​Cell Range-> OKCell StylesBorders (BorderStyle) -> OKColors (BackColor) -> OKFills (FillStyle) -> OKFonts (FontSize) -> OKNumber Formats (Format) -> OKAlignment -> OKCharts-> OKImages-> OKShapes-> PendingComments-> OKTables (Rows, Columns)-> OKProtection (Lock)-> OKEncryption-> OKCompression Level-> OKPivot Tables-> PendingData Validation-> PendingConditional Formatting-> PendingFormula Calculation-> OKFrx2Excel-> PendingFrx2PDF-> Refer to theWebView2 project.Notes:Pending: Indicates features under development or not fully implemented.Frx2PDF: Relies on the WebView2 component for PDF rendering and export.Let me know if further adjustments are needed!"
Question,PDF to text converter for batch folder processing,KarenLloyd,"Jan 10, 2025 at 10:47 PM",https://www.tek-tips.com/threads/pdf-to-text-converter-for-batch-folder-processing.1832719/,KarenLloyd,"Hello my Tek-Tips Gurus. It has been a while...I could use your insight once again please.I need to find a PDF to text converter that can be run on batches of files for the purpose of importing supplier invoices.The objective is to automate import of text (invoice lines & values) from PDF invoices, where suppliers do not have an e-invoicing system. I will match points in the format to find a job number or PO No that links into the VFP data.Of course, there will be differences according to supplier - headers / logos, reference sections formats, etc to handle and/or ignore - but by identifying key points in each document type, I hope to map each invoice format by source in order to pull in the data I need. (Starting with maybe 5-10 high volume suppliers)...Do you have any experience / recommendations for PDF to Text converter software please?Bearing in mind the following criteria:-This cannot be an online / manual upload process-There will be several hundred invoices to process each month- It needs to be an executable process, shell (maybe) or command line (!Run) process- I am still using VFP6 (limited resources meant I never managed to get VFP9 in time!)- The client will want three or four licenses ( though a free evaluation period would be grand for me! )The software solution doesn't need to be free, or even cheap - it just needs to do the job well.Any suggestions please?Thank you, in advance."
Reply,PDF to text converter for batch folder processing,KarenLloyd,"Jan 10, 2025 at 10:47 PM",https://www.tek-tips.com/threads/pdf-to-text-converter-for-batch-folder-processing.1832719/,GriffMG,"This will be a bit negative. Sorry in advance.Suppliers will give you a full time job keeping up with changes to their system.Forgive me, do not waste your time."
Reply,PDF to text converter for batch folder processing,KarenLloyd,"Jan 10, 2025 at 10:47 PM",https://www.tek-tips.com/threads/pdf-to-text-converter-for-batch-folder-processing.1832719/,KarenLloyd,"Hiya Griff! I know it's a big ask.I have a customer hoping to save time on their staff typing invoices into the system & matching them to the jobs.I'm hoping some firms will be able to provide spreadsheets/csv reports to support the billing, those I can deal withBut it doesn't hurt to ask.Glad to see you're still [Smile]ingThanks for replying"
Reply,PDF to text converter for batch folder processing,KarenLloyd,"Jan 10, 2025 at 10:47 PM",https://www.tek-tips.com/threads/pdf-to-text-converter-for-batch-folder-processing.1832719/,SoftwareRT,"I can do this in python. It would be a .exe. Essentially, it would work like this:A supplier saves their version of invoice as a .pdf.They launch the .exe, it reads the pdf file and parses out the sections.The sections will likely be wrong the first scan, so the pdf owner interacts with the application to fine-tune it and confirm data points.Fine tuning is saved against that pdf format name.Then, from that point forward, that pdf format name will parse out the same info in the a .csv, a .xlsx or a sqlite3 database.Let me know if you're interested and I'll get a sample .exe ready this weekend.C."
Reply,PDF to text converter for batch folder processing,KarenLloyd,"Jan 10, 2025 at 10:47 PM",https://www.tek-tips.com/threads/pdf-to-text-converter-for-batch-folder-processing.1832719/,EinTerraner,"I actually have a similar request on my to-do list. But I haven't tackled it yet because it's still a low priority.Just every month in a year I need to convert a PDF file into a plain text file, which I can store in a MEMO field.At the moment i just open the PDF with Chrome and CopyPaste it into my memofield."
Reply,PDF to text converter for batch folder processing,KarenLloyd,"Jan 10, 2025 at 10:47 PM",https://www.tek-tips.com/threads/pdf-to-text-converter-for-batch-folder-processing.1832719/,EinTerraner,KarenLloyd said:- I am still using VFP6 (limited resources meant I never managed to get VFP9 in time!)Click to expand...CheckWoodys-Blog. I'm sure you will sucessfully upgrade to VFP9. it's reallyUSEFULL
Reply,PDF to text converter for batch folder processing,KarenLloyd,"Jan 10, 2025 at 10:47 PM",https://www.tek-tips.com/threads/pdf-to-text-converter-for-batch-folder-processing.1832719/,ggreen61,Take a look athttps://www.xpdfreader.com/-- there are some tools for PDF extraction to text.   I have not used them so I can't give any insight to how well they work.
Reply,PDF to text converter for batch folder processing,KarenLloyd,"Jan 10, 2025 at 10:47 PM",https://www.tek-tips.com/threads/pdf-to-text-converter-for-batch-folder-processing.1832719/,xinjie,"KarenLloyd said:Hello my Tek-Tips Gurus. It has been a while...I could use your insight once again please.I need to find a PDF to text converter that can be run on batches of files for the purpose of importing supplier invoices.The objective is to automate import of text (invoice lines & values) from PDF invoices, where suppliers do not have an e-invoicing system. I will match points in the format to find a job number or PO No that links into the VFP data.Of course, there will be differences according to supplier - headers / logos, reference sections formats, etc to handle and/or ignore - but by identifying key points in each document type, I hope to map each invoice format by source in order to pull in the data I need. (Starting with maybe 5-10 high volume suppliers)...Do you have any experience / recommendations for PDF to Text converter software please?Bearing in mind the following criteria:-This cannot be an online / manual upload process-There will be several hundred invoices to process each month- It needs to be an executable process, shell (maybe) or command line (!Run) process- I am still using VFP6 (limited resources meant I never managed to get VFP9 in time!)- The client will want three or four licenses ( though a free evaluation period would be grand for me! )The software solution doesn't need to be free, or even cheap - it just needs to do the job well.Any suggestions please?Thank you, in advance.Click to expand...Hi,KarenLloydI discussed your question with a friend (Chinese). He is sure it can be solved in VFP6. However, I don't know how to establish a connection between you and him because the forum doesn't allow to leave an e-mail address. Do you have a good suggestion?"
Reply,PDF to text converter for batch folder processing,KarenLloyd,"Jan 10, 2025 at 10:47 PM",https://www.tek-tips.com/threads/pdf-to-text-converter-for-batch-folder-processing.1832719/,Chris Miller,"Xinjie, you can click on Karen Loyds user name and then click ""start conversation"" and tell her the contact mail, because that conversation is private between you and her only. Karen will see a red notification dot on the envelope icon in the top right."
Reply,PDF to text converter for batch folder processing,KarenLloyd,"Jan 10, 2025 at 10:47 PM",https://www.tek-tips.com/threads/pdf-to-text-converter-for-batch-folder-processing.1832719/,xinjie,"Chris Miller said:xinjie, you can click on Karen Loyds user name and then click ""start conversation"" and tell her the contact mail, because that conversation is private between you and her only and Karen will see a red notification dot on the envelope icon in the top right.Click to expand...Hi, Chris MillerThank you!"
Reply,PDF to text converter for batch folder processing,KarenLloyd,"Jan 10, 2025 at 10:47 PM",https://www.tek-tips.com/threads/pdf-to-text-converter-for-batch-folder-processing.1832719/,Steve Meyerson,"Karen,Another possibility might be Adobe Acrobat Pro DC (64-bit). Using the Scan & OCR feature, it will convert a pdf to several formats including plain text. You would of course need to rearrange the text to fit your form. My sample test showed it to be pretty accurate.Not sure how much, if any, you could do within VFP.Steve"
Reply,PDF to text converter for batch folder processing,KarenLloyd,"Jan 10, 2025 at 10:47 PM",https://www.tek-tips.com/threads/pdf-to-text-converter-for-batch-folder-processing.1832719/,giannit,"Try Balabolka Text Extract Utility, I have used it in a similar situation as yours.Balabolka / Text Extract UtilityThe utility works from the command line.Gianni"
Reply,PDF to text converter for batch folder processing,KarenLloyd,"Jan 10, 2025 at 10:47 PM",https://www.tek-tips.com/threads/pdf-to-text-converter-for-batch-folder-processing.1832719/,trial03,"xinjie said:Hi,KarenLloydI discussed your question with a friend (Chinese). He is sure it can be solved in VFP6. However, I don't know how to establish a connection between you and him because the forum doesn't allow to leave an e-mail address. Do you have a good suggestion?Click to expand...Can share the idea.Thanks"
Reply,PDF to text converter for batch folder processing,KarenLloyd,"Jan 10, 2025 at 10:47 PM",https://www.tek-tips.com/threads/pdf-to-text-converter-for-batch-folder-processing.1832719/,trial03,"SoftwareRT said:I can do this in python. It would be a .exe. Essentially, it would work like this:A supplier saves their version of invoice as a .pdf.They launch the .exe, it reads the pdf file and parses out the sections.The sections will likely be wrong the first scan, so the pdf owner interacts with the application to fine-tune it and confirm data points.Fine tuning is saved against that pdf format name.Then, from that point forward, that pdf format name will parse out the same info in the a .csv, a .xlsx or a sqlite3 database.Let me know if you're interested and I'll get a sample .exe ready this weekend.C.Click to expand...Hi,Sound good.Can share me 1 copy of exe to test.Thanks."
Reply,PDF to text converter for batch folder processing,KarenLloyd,"Jan 10, 2025 at 10:47 PM",https://www.tek-tips.com/threads/pdf-to-text-converter-for-batch-folder-processing.1832719/,tomk3,"Hello,we use(d) thisPDF Text Extractor Command Line: Convert Acrobat PDF to Text. [A-PDF.com]https://www.xpdfreader.com/pdftotext-man.html(download the toolspackage)and had a look on (not cheap)PDF to TXT Converter – Extract and copy text from PDFPDF to TXT Converter is used for convert PDF to plain text files. It also can convert HTML, MS Word and RTF to plain text.www.verypdf.comMost of the work is changing the parser when invoice layout changes"
Reply,PDF to text converter for batch folder processing,KarenLloyd,"Jan 10, 2025 at 10:47 PM",https://www.tek-tips.com/threads/pdf-to-text-converter-for-batch-folder-processing.1832719/,Chris Miller,"KarenLloyd said:I will match points in the format to find a job number or PO No that links into the VFP data.Click to expand...You're all making it a bit too complicated, as this requirement is loer than extracting all necessary invoice information. Detail data is already available and can be compared to extracted text once a job number or PO is found that already uniquely identifies hat invoice this should be by job number or PO.It's not said hat's done afterards, once all invoice PDFs are assigend to expected invoice data with a job number or PO or anything further, the rest could be dealt ith manually. While you're at text extraction, you could compare the data of expected invoices with extracted text even without training on PDF formats per company or things like that.I'd concentrate on just assigning PDFs to data and then for the next step to raise quality verify you have no double assignments, no missing assignments or such things, then you can upgrade with further PDF text to data extraction for better matching and as end goal as little manual intervention as necessary. But as small or large a company I have, I'd never just automatically pay invoices ithout any manual validation except perhaps for very small amounts to pay. So I'd say manual validation will be done anyay and automating too much and too detailed just has unjustifiable costs."
Reply,PDF to text converter for batch folder processing,KarenLloyd,"Jan 10, 2025 at 10:47 PM",https://www.tek-tips.com/threads/pdf-to-text-converter-for-batch-folder-processing.1832719/,mintjulep,"I'd try Goolge's NotebookLM for this.There's an API, so you can interact programmatically."
Reply,PDF to text converter for batch folder processing,KarenLloyd,"Jan 10, 2025 at 10:47 PM",https://www.tek-tips.com/threads/pdf-to-text-converter-for-batch-folder-processing.1832719/,xinjie,trial03 said:Can share the idea.ThanksClick to expand...I'm sorry because I didn't get it either because I'm just so new to this field.
Reply,PDF to text converter for batch folder processing,KarenLloyd,"Jan 10, 2025 at 10:47 PM",https://www.tek-tips.com/threads/pdf-to-text-converter-for-batch-folder-processing.1832719/,KarenLloyd,Thanks to all for your replies - I do appreciate you taking the time and giving your input.Sorry it's taken almost a week for me to respond.I will try out the packages suggested and give feedback for each.
Reply,PDF to text converter for batch folder processing,KarenLloyd,"Jan 10, 2025 at 10:47 PM",https://www.tek-tips.com/threads/pdf-to-text-converter-for-batch-folder-processing.1832719/,iswithzhz,I guess what you need is this
Question,ChilkatVFP Version 1.41 Released,Bill Anderson,"Jan 21, 2025 at 9:52 PM",https://www.tek-tips.com/threads/chilkatvfp-version-1-41-released.1832830/,Bill Anderson,"Folks,This release is a bug fix version of the 1.40 release.https://github.com/billand88/ChilkatVFP1) Chilkat Events can be set again.The rest is ""other stuff""...2) An additional CallBack*.PRG was added in 1.40, but never called. Fixed.3) Secrets class added to the list of Chilkat objects that can have an event handler.4) Removed the three deprecated properties/methods from the BaseChilkat class. Went through the framework to remove all references. At least two classes (One of them HTTPRequest) couldn't instantiate in version 1.40 without this fix.5) Added m. (m dot) prefixes to the BaseEventHandler class and subclasses.6) Other random fixes.Bill Anderson"
Question,Position form in another form when radio clicked,TheLazyPig,"Jan 17, 2025 at 6:09 AM",https://www.tek-tips.com/threads/position-form-in-another-form-when-radio-clicked.1832787/,TheLazyPig,Hi!Can I position my form (frmchecks.scx) to appear inside another form (branch.scx) when the radio button is clicked? It works when I change the Top and Left but if I do this will it stay in the position even if the device changes?<--changes depend on the radio buttonfrmchecks.scxshould be in the yellow square below.Thanks for the replies.
Reply,Position form in another form when radio clicked,TheLazyPig,"Jan 17, 2025 at 6:09 AM",https://www.tek-tips.com/threads/position-form-in-another-form-when-radio-clicked.1832787/,tomk3,"Hello,why not put the content of form frmchecks inside a container and put in mainform and make it visible .t. / .f. depending on radio buttons ?If it has own buttons, disbale maiform buttons/controls if container is visibleWhat do you mean with ""device changes"" ? Moving mainform to other screen with different resolution ?"
Reply,Position form in another form when radio clicked,TheLazyPig,"Jan 17, 2025 at 6:09 AM",https://www.tek-tips.com/threads/position-form-in-another-form-when-radio-clicked.1832787/,mJindrova,"TheLazyPig said:Hi!Can I position my form (frmchecks.scx) to appear inside another form (branch.scx) when the radio button is clicked? It works when I change the Top and Left but if I do this will it stay in the position even if the device changes?View attachment 1523View attachment 1524<--changes depend on the radio buttonfrmchecks.scxshould be in the yellow square below.View attachment 1525Thanks for the replies.Click to expand...Yes, it's possibly, but how as Tom... Why?!?PUBLIC m.poFormMain, m.poFormChildm.poFormMain=CREATEOBJECT(""_formMain"")m.poFormMain.Name=""MAINFORM""m.poFormChild=CREATEOBJECT(""_formChild"")m.poFormChild.Name=""CHILDFORM""SHOW WINDOW (""CHILDFORM"") IN WINDOW (""MAINFORM"")m.poFormChild.ChangePosByParent(m.poFormMain)m.poFormMain.Visible=.T.suspDEFINE CLASS  _formMain AS FORMName=""_formMain""Height=500Width=500PROCEDURE Resizem.poFormChild.ChangePosByParent(m.poFormMain)ENDPROCENDDEFINEDEFINE CLASS _formChild AS FORMName=""_formChild""Height=250Width=500PROCEDURE InitThis.AddObject(""Label1"",""Label"")This.Label1.Caption=""Child form""This.Label1.Visible=.T.ENDPROCPROCEDURE ChangePosByParentLPARAMETERS m.loFormThis.Move(0, m.loForm.Height/2, m.loForm.Width-SYSMETRIC(3)*2, m.loForm.Height/2-SYSMETRIC(4)*2-SYSMETRIC(9))ENDPROCENDDEF"
Reply,Position form in another form when radio clicked,TheLazyPig,"Jan 17, 2025 at 6:09 AM",https://www.tek-tips.com/threads/position-form-in-another-form-when-radio-clicked.1832787/,Premal Vala,"For me Ideal solution will be to put Page Frame control and convert all your radio buttons to Pages. This will be more clear, easy and simpler solution to implement.Please explore Page Frame control and that should solve your issue. Your page frame could look like below with individual page having required fields:"
Reply,Position form in another form when radio clicked,TheLazyPig,"Jan 17, 2025 at 6:09 AM",https://www.tek-tips.com/threads/position-form-in-another-form-when-radio-clicked.1832787/,Chris Miller,"I second Premal Vala. But is there any reason you have all separate forms? If there is any reason, like all of them having a private datasession and separation of data from the main form, then the normal way to use them is as a satellite/popup form.You may have the idea popup forms are bad, as they are suppresed by Browsers, for example, but that has it's own reasons. Spare the free area of your main form, put buttons or a commanfbutton group on it to start the different child forms and let the user decide here they want to move it, display it nonoverlapping, for example, and the user may even steart two or three of the smaller satellite forms, it could even be useful to have multiple of them side by side. That way you also have the least need for changes.On top of that you could offer dockable forms. That won't allow a head area that stays visible, but adds a pageframe interface without needing to rearrange anything. Maybe only allow the popup forms to dock into each other and keep the main form undockable and not allowing docking, then you have the always present main form as header to all the other forms."
Reply,Position form in another form when radio clicked,TheLazyPig,"Jan 17, 2025 at 6:09 AM",https://www.tek-tips.com/threads/position-form-in-another-form-when-radio-clicked.1832787/,GTGeek88,"Yes, my first thought was a pageframe. And if you don't want to use the tabs, you can turn them off and have the radio buttons activate the appropriate one."
Reply,Position form in another form when radio clicked,TheLazyPig,"Jan 17, 2025 at 6:09 AM",https://www.tek-tips.com/threads/position-form-in-another-form-when-radio-clicked.1832787/,Chris Miller,"I already gave my advice and don't see any benefits of having an empty area in a form just to be able to position a form there. The sstraight forward way to have child forms (forms within forms) is creating a parent form that's capable to have child forms in it. In VFP that kind of parent form is a top level form. The property to set is ShowWindow. Setting a form ""As Top Level Form"" (2) it should become clear what ""In Top Level Form"" (1) means. Starting a form (DO FORM or CREATEOBJECT(""formclass"") - the way doesn't matter) from code of a top level form, an ""In Top Level Form"" then will become a child form that will be movable within the top level form only and that will move along with the top level form.The use case that is what you use by default: Forms that all show in the VFP Screen (aka _SCREEN) form where the screen is usually empty (perhaps a background and acts as a desktop for all the application forms. Or instead of desktop (that should be reserved for the Windows Desktop, of course) it's just a parent form for all forms of the applicaiton, which keeps all the windows of one application together. I'd not consider it a good design to reserve a space for child forms, though. They still have a titlebar and are movable. And that's actually the major design of Windows itself. That's giving it the name. You have Windows and you're usually (within some rules about child windows containied within parents) free to move and arrange them as you like. That's what users expect of Windows applications. So a straight forward comple Winddows application design is to offer all forms to be movable anywhere on the Windows desktop, not confined to anything and not fixed into some predefined space, only. What you want is either a pageframe or container, not a form in a form."
Reply,Position form in another form when radio clicked,TheLazyPig,"Jan 17, 2025 at 6:09 AM",https://www.tek-tips.com/threads/position-form-in-another-form-when-radio-clicked.1832787/,xinjie,"TheLazyPig said:你好！单击单选按钮时，是否可以将我的表单 （frmchecks.scx） 定位为显示在另一个表单 （branch.scx） 中？当我更改 Top 和 Left 时它起作用，但如果我这样做，即使设备发生变化，它也会保持在原位吗？View attachment 1523View attachment 1524<--更改取决于单选按钮frmchecks.scx应位于下面的黄色方块中。View attachment 1525谢谢你的回复。Click to expand...You can use Foxhwnd.ocx for this purpose if you stick to the original design. Foxhwnd.ocx can be found in the VFP6 installer, and details of how to use it can be found in the help file."
Reply,Position form in another form when radio clicked,TheLazyPig,"Jan 17, 2025 at 6:09 AM",https://www.tek-tips.com/threads/position-form-in-another-form-when-radio-clicked.1832787/,Chris Miller,"Not sure what foxhwnd.ocx is needed for. I found a mention of foxhwnd from Tamar mentioning it can be used as an image control by feeding it a picture you load with LOADPICTURE(). Overall foxhwnd seems to be an ActiveX container, that's now just the Olecontrol. Or it's lending the hwnd access to you, which now every form has as a property anyway. So overall I think it has been introduced in VFP5 just to be replaced by integrating it into VFP forms and the Ole(bound)control.Anyway, hwnd can be used in the API call SetParent to force a window to be parent window. That's unnecessary as I said you can make use of the Top Level and In Top Level forms, but it's also a straight forward option. I just wouldn't recommend it.I'd still like to hear about your motivation, ""TheLazyPIg"". Clearly you have all the forms you'd rather need as containers or pages of a pageframe, as the majority of answers recommend. I gave you the laziest option to just make it a feature instead of a bug or flaw to not be able to position a window inside another window and argue with the philosophy of the Windows OS, you'd just need to shrink your form to give room to the separate windows. And (I repeat myself) make use of the docking feature in one or the other way.You can also get containers from your forms by opening them, use CTRL+A to select all form content and then use Save As Class from the main VFP IDE menu to save containers instead of the forms. You could then use these containers both as the only control in new empty forms or inside a page of a pageframe. And you then have a central place to modify these things and both change the mainform in which you embed them and the separate forms which each only consist of one such container class on them.What you do all depends on the motivation for this. I think you have the stand alone forms for a reason and want to continue to offer them not only as a page of a pageframe in the new mainform, then just keeping them as separate forms also in context with your main form is still the simplest solution requiring the least work of changes. Creating containers from the forms with the ""Save as Class"" feature has not only the work to create all these container classes, it also means any code referring to THISFORM within any control will need to change to refer to the container. So there's more work to have this working and that's why you perhaps seek for the simple form in form solution. It can look llike seamless integration, if you remove the border and titlebar of the embedded form, it's still clunky in terms of the integration into the tab order of things and you still activate/deactivate forms, i.e. change from mainform to embedded form and back in focus and it's all not ideal to hack it that way. The only really lazy solution is to keep forms as forms outside the main form and have consistent UI in concordance with Windows guidelines, too. It's also sensible.Here's one thing that can help as a compromise of just having a separate form appear anywhere for the user to arrange. You could position the form under the main form instead of at the footer area you kept empty (So still the same idea to not reserve that area and just display separate forms). But you could make it seem like magnetic borders, so the separate form moves with the main form. And even make that a general feature of another way of docking ""magnetically"" when two form borders come close enough and align good enough. If you're interested I could share code doing that feature both just programmatically and as a general UI feature a user could use to snap forms together at borders."
Reply,Position form in another form when radio clicked,TheLazyPig,"Jan 17, 2025 at 6:09 AM",https://www.tek-tips.com/threads/position-form-in-another-form-when-radio-clicked.1832787/,mJindrova,FoxPro for DOS has simply way how to shoe window inside another window: SHOW WINDOW [window_name] IN WINDOW [window_name]. This old command works within VFP forms too.
Reply,Position form in another form when radio clicked,TheLazyPig,"Jan 17, 2025 at 6:09 AM",https://www.tek-tips.com/threads/position-form-in-another-form-when-radio-clicked.1832787/,TheLazyPig,"Premal Vala said:For me Ideal solution will be to put Page Frame control and convert all your radio buttons to Pages. This will be more clear, easy and simpler solution to implement.Please explore Page Frame control and that should solve your issue. Your page frame could look like below with individual page having required fields:View attachment 1526Click to expand...I didn't use it because I hadn't tried it before and wanted to re-create the original UI of the program. Thank you I'll learn it from now."
Reply,Position form in another form when radio clicked,TheLazyPig,"Jan 17, 2025 at 6:09 AM",https://www.tek-tips.com/threads/position-form-in-another-form-when-radio-clicked.1832787/,TheLazyPig,"tomk3 said:Hello,why not put the content of form frmchecks inside a container and put in mainform and make it visible .t. / .f. depending on radio buttons ?If it has own buttons, disbale maiform buttons/controls if container is visibleWhat do you mean with ""device changes"" ? Moving mainform to other screen with different resolutionClick to expand...Oh, I didn't know about containers... I've never really explored all the tools. Thank you this might be the one the programmer used in the project. Will check this out too.What do you mean with ""device changes"" ? Moving mainform to other screen with different resolutionClick to expand...Yes, screen resolution."
Reply,Position form in another form when radio clicked,TheLazyPig,"Jan 17, 2025 at 6:09 AM",https://www.tek-tips.com/threads/position-form-in-another-form-when-radio-clicked.1832787/,TheLazyPig,The real problem is the project itself doesn't have the .pjx file and the other forms I needed so I have to re-create the program itself.
Reply,Position form in another form when radio clicked,TheLazyPig,"Jan 17, 2025 at 6:09 AM",https://www.tek-tips.com/threads/position-form-in-another-form-when-radio-clicked.1832787/,TheLazyPig,"Chris Miller said:I second Premal Vala. But is there any reason you have all separate forms? If there is any reason, like all of them having a private datasession and separation of data from the main form, then the normal way to use them is as a satellite/popup form.You may have the idea popup forms are bad, as they are suppresed by Browsers, for example, but that has it's own reasons. Spare the free area of your main form, put buttons or a commanfbutton group on it to start the different child forms and let the user decide here they want to move it, display it nonoverlapping, for example, and the user may even steart two or three of the smaller satellite forms, it could even be useful to have multiple of them side by side. That way you also have the least need for changes.On top of that you could offer dockable forms. That won't allow a head area that stays visible, but adds a pageframe interface without needing to rearrange anything. Maybe only allow the popup forms to dock into each other and keep the main form undockable and not allowing docking, then you have the always present main form as header to all the other forms.Click to expand...The form changes because of the radio button the content is not the same that's why I have separate forms."
Reply,Position form in another form when radio clicked,TheLazyPig,"Jan 17, 2025 at 6:09 AM",https://www.tek-tips.com/threads/position-form-in-another-form-when-radio-clicked.1832787/,TheLazyPig,"Premal Vala said:For me Ideal solution will be to put Page Frame control and convert all your radio buttons to Pages. This will be more clear, easy and simpler solution to implement.Please explore Page Frame control and that should solve your issue. Your page frame could look like below with individual page having required fields:View attachment 1526Click to expand...How did you put the Documents from and Others tab in the second row?"
Reply,Position form in another form when radio clicked,TheLazyPig,"Jan 17, 2025 at 6:09 AM",https://www.tek-tips.com/threads/position-form-in-another-form-when-radio-clicked.1832787/,mjcmkrsr,"Hi,The form changes because of the radio button the content is not the same that's why I have separate forms.Click to expand...How did you put the Documents from and Others tab in the second row?Click to expand...You may want to have a look at the demo code below - not very fancy, but it might give you an idea.Code:oForm = CREATEOBJECT(""clsMainForm"")
oForm.Visible = .T.
oForm.SHOW()

Read EVENTS

CLOSE ALL

CLEAR ALL

RETURN
        
*!*    Define Main Form Class

Define CLASS clsMainForm AS FORM

    Caption = ""Test Pageframe""
    Left = 12
    Top = 12
    Height = _screen.Height - 24
    Width = _screen.Width - 24 && 1680
    BorderStyle = 2
    WindowState = 2
    WindowType = 0
    BackColor = RGB(210, 210, 210)
    Themes = .F.

*!*    ADD exitbutton to form

    Add OBJECT cmdExit AS COMMANDBUTTON WITH;
          Caption = ""Exit"", ;
          FontSize = 12, ;
          FontBold = .T., ;
          Backcolor = RGB(192,192,192), ;
          ForeColor = RGB(255,0,0), ;
          Left = ThisForm.Width - 120, ;
          Top = ThisForm.Height - (48 + 24), ;
          Width = 120, ;
          Height = 48, ;
          Alignment = 2
          
*!*    ADD label to form

    ADD OBJECT lblIntro as label WITH ;
        Left = 240, Top = 48, autosize = .T., Caption = ""Whatever you want"", FontBold = .T., FontItalic = .T., FontSize = 24
        
*!*    ADD optiongroup to form

    ADD OBJECT opgPages as OptionGroup WITH ;
        Left = 12, Top = 42, ButtonCount = 6, Autosize = .T.
        
        PROCEDURE opgPages.Init()
            FOR i = 1 TO This.ButtonCount
                WITH This.Buttons(i)
                    .AutoSize = .T.
                    .Caption = ""Click to activate page "" + ALLTRIM(STR(i))
                ENDWITH
            ENDFOR
        ENDPROC
        
        PROCEDURE opgPages.Click()
            LOCAL lni
            
            lni = This.Value
            
            WITH ThisForm.pgfMain
                    .ActivePage = lni
                    .Click
            ENDWITH 
        ENDPROC
        
    ADD OBJECT chkTabs as Checkbox WITH ;
        Top = 142, Left = ThisForm.Width - 180, Value = .F., AutoSize = .T., Caption = ""Show Tabs of PageFrame""
        
        PROCEDURE chkTabs.Click
            WITH ThisForm
                .opgPages.Value = ThisForm.pgfMain.ActivePage
                .opgPages.Enabled = !(This.Value)
                .pgfMain.Tabs = This.Value
                .Refresh()
            ENDWITH
        ENDPROC
            
*!*    Add pageframe to Form

    ADD OBJECT pgfMain AS PageFrame WITH ;
        PAGECOUNT = 6, ;
        LEFT = 12, ;
        TOP = 184, ;
        WIDTH = THISFORM.WIDTH - 12, ;
        HEIGHT = THISFORM.HEIGHT - 272, ;
        Tabs = .F.
    
        PROCEDURE pgfMain.Init()
            LOCAL loPage as Object
                
            FOR i = 1 TO This.pageCount
                loPage = This.Pages(i)
                
                WITH loPage
                    .Caption = ICASE(i = 1, ""Page One"", i = 2, ""Page Two"", i = 3, ""Page Three"", i = 4, ""Page Four"", ;
                                    i = 5, ""Page Five"",""Page Six"" )
                    .FontBold = .T.
                    .FontName = ""Verdana""
                    .FontSize = 12
                    .Forecolor = ICASE(i = 1, RGB(0,0,255), i = 2, RGB(0,0,0), i = 3, RGB(0,0,255), ;
                                    i = 4, RGB(128,64,64), i = 5, RGB(0,128,0), RGB(255,128,0))

                    .Addobject(""lblPage"", ""lblLabel"")
                    .lblPage.Top = 120
                    .lblPage.Left = i * 210
                    .lblPage.Caption = ""This is label on page"" + "" "" + ALLTRIM(STR(i))
                ENDWITH
            ENDFOR
        ENDPROC

    PROCEDURE cmdExit.CLICK
        CLEAR Events
    ENDPROC
    
    PROCEDURE Destroy()
        This.cmdExit.Click()
    ENDPROC
      
ENDDEFINE

**********

DEFINE CLASS lblLabel as Label
    Visible = .T.
    Left = 12
    Top = 24
    Height = 48
    FontSize = 18
    FontName = ""Verdana""
    BorderStyle = 1
    Backcolor = RGB(255,255,128)
    Caption = ""Label""
    Autosize = .T.
ENDDEFINE         

*********hthMarK"
Reply,Position form in another form when radio clicked,TheLazyPig,"Jan 17, 2025 at 6:09 AM",https://www.tek-tips.com/threads/position-form-in-another-form-when-radio-clicked.1832787/,Chris Miller,"TheLazyPig said:The form changes because of the radio button the content is not the same that's why I have separate forms.Click to expand...That's not a reason to create forms, that's a reason for having a pageframe. Especially when you created forms to display in that area, that's nonsensical design, just look back at the answer of Premal Vala with a screenshot of the tabs a pageframe could have that replace your radio buttons. Since tabs can span multiple lines you don't even need to shorten the captions, they can be 1:1 the captions of your radio buttons.If you want to save space, then you could also make a combobox for choosing the page and make the tabs invisible and switch to the page number associated with the selection of a combobox. Or as I suggested, since you now have the forms, make it a feature, not a bug, to display them separately."
Reply,Position form in another form when radio clicked,TheLazyPig,"Jan 17, 2025 at 6:09 AM",https://www.tek-tips.com/threads/position-form-in-another-form-when-radio-clicked.1832787/,TheLazyPig,"Chris Miller said:That's not a reason to create forms, that's a reason for having a pageframe.Click to expand...That's because I wanted to re-create the original UI and thought that he used forms. I'm already changing it to pageframe now."
Reply,Position form in another form when radio clicked,TheLazyPig,"Jan 17, 2025 at 6:09 AM",https://www.tek-tips.com/threads/position-form-in-another-form-when-radio-clicked.1832787/,TheLazyPig,FYI this is the program I'm re-creating.It was created in 2007.
Reply,Position form in another form when radio clicked,TheLazyPig,"Jan 17, 2025 at 6:09 AM",https://www.tek-tips.com/threads/position-form-in-another-form-when-radio-clicked.1832787/,Chris Miller,"Okay, but the first thing that should come to your mind to do something similar in VFP is a container, not a form. Why did you go for forms immediately? You see a bunch of controls in a reserved free area. The designer of that old program should have used a pageframe, too, by the way, but he was likely using containers at that place, he made visible=.T. or .F. It's not a nice way also to design and maintain this. A pageframe also has it's pages at designtime and you can also switch between them to design and modify them. It's the simplest way to have a set of areas to display at the same place.If you like the choices to be on the side, instead of the top, there are the pageframeproperties taborientation, where you can decide whether tabs are on the top (normal default), bottom, left or right, tabstretch, which determines whether you have a single row of tabs or - better in your case with the many options you have - multiple rows, and finally tabstyle, which determines whether tabs all have just the size necessary for the caption and there's free space after the last tab or whether the tabs always extend over the whole width or height of the pageframe and the captions are displayed justified within the tabs (each tab caption centered).As others and I have also said, you could also use a pageframe with no tabs, just set the pageframe.tabs property .F. - and then have your radio buttons (in VFP an option group) to pick an option or a button group to have a staple of buttons looking like page tabs with their caption still horizontal (pageframe taborientations left and right have tabs with captions written vertically). So you could easily adapt to what you see there, but even with the argument the user acceptance is best when the new application just looks, feels, reacts and works exactly the same: Why even bother to recreate it then? You should improve what you're able to improve to more normal UI designs, like a pageframe is. If that gives you the idea to create forms and not  even simply containers or - as most here got the same idea - a pageframe. It doesn't require to start a form and position it in a prereserved space, it consists of pages which are at the prereseved spaces, you can - if ou llike that for a start - have an empty page, too, then user pick a page by tab and that appears - without any code. It's exactly what you want and does not even require creating a container and place it thereDo you not knew the pageframe? What controls of VFP are you using regularly? No pageframe? No grid? No combobox, listbox? Too complicated? Take a look at a project called solution:Code:Modify Project (_samples+""solution\solution.pjx"")And then switch to the ""Code"" tab of the project manager (by the way, a good example of a pageframe you certainly know and use, too) and start main.prg with the Run button. Then ou can search and pick examples also about things like the VFP controls and how they work, with demonstration and source code (as the whole project source code is)."
Question,Set a TAG for a field programmaticaly,SitesMasstec,"Jan 7, 2025 at 10:27 PM",https://www.tek-tips.com/threads/set-a-tag-for-a-field-programmaticaly.1832689/,SitesMasstec,"Hello colleagues!I have a free table named ETIQUETA.DBF:Now I want to create a TAG (ascending) for the field CCIDA, butprogrammaticaly.I tried many commands likeCode:ALTER TABLE ETIQUETA ... TAG CCIDA, but I failed.Is it possible?In fact, I want this for another table, derived from another table. The above table is just to simplify the problem."
Reply,Set a TAG for a field programmaticaly,SitesMasstec,"Jan 7, 2025 at 10:27 PM",https://www.tek-tips.com/threads/set-a-tag-for-a-field-programmaticaly.1832689/,Paul Gibson,"Look at the INDEX command, for example:Code:INDEX ON CCIDA TAG CCIDAThe default order isASCENDINGso you don't need to specify that but as the help says:By default, Visual FoxPro displays and accesses records in ascending order. However, you can includeASCENDINGas a reminder of how records are displayed."
Reply,Set a TAG for a field programmaticaly,SitesMasstec,"Jan 7, 2025 at 10:27 PM",https://www.tek-tips.com/threads/set-a-tag-for-a-field-programmaticaly.1832689/,GriffMG,"It's probably not related, but your example has the table opened read only?"
Reply,Set a TAG for a field programmaticaly,SitesMasstec,"Jan 7, 2025 at 10:27 PM",https://www.tek-tips.com/threads/set-a-tag-for-a-field-programmaticaly.1832689/,EinTerraner,"If you use this index temporary for a view and/or printing issue, you also can use the SQL SELECT.Code:SELECT * from ""ETIQUETA"" ;
  INTO CURSOR CursorName ;
  [WHERE any filters ;] && optional
  ORDER BY CCIDAAs your picture schown is the table readonly, then you can't any index-tags"
Reply,Set a TAG for a field programmaticaly,SitesMasstec,"Jan 7, 2025 at 10:27 PM",https://www.tek-tips.com/threads/set-a-tag-for-a-field-programmaticaly.1832689/,SitesMasstec,Griff: the table is opened as EXCLUSIVE (not Read Only).
Reply,Set a TAG for a field programmaticaly,SitesMasstec,"Jan 7, 2025 at 10:27 PM",https://www.tek-tips.com/threads/set-a-tag-for-a-field-programmaticaly.1832689/,Premal Vala,"Hi,Tag is not part of table structure in VFP, you need to use INDEX ON Command for any Tag you want to create. So, for your example above, once you open the table (exclusive) you need to add following command:Code:INDEX ON CCIDA TAG CCIDA(as Paul has already mentioned)This will create you index and going forward you can use it with your table asCode:USE ETIQUETA ORDER CCIDAThanks,PREMAL"
Reply,Set a TAG for a field programmaticaly,SitesMasstec,"Jan 7, 2025 at 10:27 PM",https://www.tek-tips.com/threads/set-a-tag-for-a-field-programmaticaly.1832689/,Mike Lewis,"You mentioned that this is a free table. Although you can use ALTER TABLE to create an index and assign it a tag, you can only do that if the table is part of a database.From the VFP Help:ALTER TABLE - SQL CommandYou can useALTER TABLEto modify the structure of a table that has not been added to a database. However, Visual FoxPro generates an error if you include theDEFAULT,FOREIGN KEY,PRIMARY KEY,REFERENCES, orSETclauses when modifying a free table.Click to expand...For free tables, you would do this:Code:INDEX ON  <some expression> TAG <tag name>Mike"
Reply,Set a TAG for a field programmaticaly,SitesMasstec,"Jan 7, 2025 at 10:27 PM",https://www.tek-tips.com/threads/set-a-tag-for-a-field-programmaticaly.1832689/,Chris Miller,"Do you know how you can revisit your old questions? In the top right you see your name. there's a dropdown when you click on that, and there you find ""Your content"", which is all your posts.You have been told how to create indexes programmatically in previous threads:Create a table with Tag indexes - Microsoft: FoxProHello colleagues!  I know how to create a free table programatically: CREATE TABLE RESERVAS (LOCALIZA C(12))           && Cod.Localizador USE  ALTER TABLE RESERVAS ADD COLUMN EMISSAO D        && Data de Emissão da Reserva ALTER TABLE RESERVAS ADD COLUMN DOLAR N(8,5)     && Cotação do Dolar ALTER...www.tek-tips.comINDEX versus TAG - Microsoft: FoxProHello colleagues!  I would like to have your opinion about INDEX clause when opening a file (free table only).  I have the following in a PRG file to add a new record, update or delete records:   SELECT 1 USE CLIENTES INDEX...www.tek-tips.com"
Reply,Set a TAG for a field programmaticaly,SitesMasstec,"Jan 7, 2025 at 10:27 PM",https://www.tek-tips.com/threads/set-a-tag-for-a-field-programmaticaly.1832689/,SitesMasstec,"Premal & Mike:ETIQUETA.DBF is a free table (I have not used VFP Database in this life, yet)In a some parts of the program I have:Code:INDEX ON NOVOCNOME TAG NOVOCNOME
...
IF XQualOrdem=""A""
     Ordem=""NOVOCNOME""
ENDIF
...
USE ETIQUETA ORDER &OrdemChris: Yes, in the first post you mentioned (""Create a table with Tag indexes"") Steve Yu had answered:Code:index on LOCALIZA + str(codagente,6) tag anytagnameI will pay more attention next time. Thanks."
Reply,Set a TAG for a field programmaticaly,SitesMasstec,"Jan 7, 2025 at 10:27 PM",https://www.tek-tips.com/threads/set-a-tag-for-a-field-programmaticaly.1832689/,Mike Lewis,"One further point ...You say you have the INDEX IN ... in ""some parts of the program"". Do you know that you only need to create a given index tag once (for a given table). Once it has been created, it stays in existence until explicitly deleted, even after you close the table or terminate the program.Mike"
Reply,Set a TAG for a field programmaticaly,SitesMasstec,"Jan 7, 2025 at 10:27 PM",https://www.tek-tips.com/threads/set-a-tag-for-a-field-programmaticaly.1832689/,SitesMasstec,"Oh, yes Mike, I know.I let you dear colleagues misunderstood me. I would mean:In one part of the program I have the command:Code:INDEX ON NOVOCNOME TAG NOVOCNOMEIn another part of the program I have the command:Code:IF XQualOrdem=""A""
     Ordem=""NOVOCNOME""
ENDIFAnd in another part I have:Code:USE ETIQUETA ORDER &OrdemJust once each command.Sorry."
Reply,Set a TAG for a field programmaticaly,SitesMasstec,"Jan 7, 2025 at 10:27 PM",https://www.tek-tips.com/threads/set-a-tag-for-a-field-programmaticaly.1832689/,Chris Miller,"Your question was how to create an index tag programmatically, that's done with the INDEX command. Even if you didn't revisit your old threads that should be clear by now, but your listing of the three program code lines almost shouts out you have the code but don't kno what lines does what.The importance of what Mike Lewis points out is that by redoing INDEX ON you're wasting time, energy, effort, patience of users. Once an index is created it's created and grows and shrinks with the data. The only reason Mike points that out is that legacy index types in IDX files don't have that behavior, but it's still in legacy developers habits to repeteadly do INDEX data, though that's just a waste of time once it's done in the major CDX file of a table.It's also no virtue to only have one place in all your code to USE a table ordered by a tag nor to only have one place in code that decides which order tag to use. Regarding that, you could even spare to first set a variable but use the table ordered by the tag you know you want to use or SET ORDER to it.It's not even a virtue to only have one line of  INDEX ON... in your code, because that doesn't tell anything about how many times it's executed. You usually generate tables at design time, during development and include them in a setup that just puts them on the end users computer, there's not even the necessity to have any INDEX ON line of code, therefore. There are good reasons to programmatically create new tables including their indexes and not only use table files you generate during development, but the number of search results will never tell you anyhthing about the quality of code regarding that.Besides, most of all these things have been told to you in the threads I quoted. It's watering down a knowledge base if you add the same answers to the same questions into a forum."
Reply,Set a TAG for a field programmaticaly,SitesMasstec,"Jan 7, 2025 at 10:27 PM",https://www.tek-tips.com/threads/set-a-tag-for-a-field-programmaticaly.1832689/,SitesMasstec,"Dear Chris: you are right about the comands I presented here, but... as I said in my question post in this thread:In fact, I want this for another table, derived from another table. The above table is just to simplify the problem.Click to expand...The real problem is more complex:Code:* Abertura do arquivo com a indexação escolhida
SELECT 1   
USE CLIENTES       && The file with data to be processed

* ---------------------------------------------------------------------------

ARQUIVO55=SYS(2015)      && Tempory file to store selected records from CLIENTES.DBF

COPY STRUCTURE TO &ARQUIVO55

SELECT 55
USE &ARQUIVO55

* ==========================================================================
*  Creation of new fields in the temporary file to store names without accentuation
*  For example, if the field CNOME stores ÉPICO the new field NOVOCNOME in the temporary file will store EPICO
* ==========================================================================
SELECT 55
USE &ARQUIVO55 EXCLUSIVE
ALTER TABLE &ARQUIVO55 ADD COLUMN NOVOCNPOP  C(22)   
ALTER TABLE &ARQUIVO55 ADD COLUMN NOVOCNOME  C(44)   
ALTER TABLE &ARQUIVO55 ADD COLUMN NOVOCCIDA  C(20)  


SELECT 55
USE &ARQUIVO55
GOTO TOP

DO WHILE NOT EOF()
    YNOVOCNPOP= CHRTRAN(NOVOCNPOP,'ÁÂÃáâãÉÊéêÍíÓÔÕóôõÚúÇç','AAAaaaEEeeIiOOOoooUuCc')
    YNOVOCNOME= CHRTRAN(NOVOCNOME,'ÁÂÃáâãÉÊéêÍíÓÔÕóôõÚúÇç','AAAaaaEEeeIiOOOoooUuCc') 
    YNOVOCCIDA= CHRTRAN(NOVOCCIDA,'ÁÂÃáâãÉÊéêÍíÓÔÕóôõÚúÇç','AAAaaaEEeeIiOOOoooUuCc') 

    REPLACE NOVOCNPOP WITH YNOVOCNPOP
    REPLACE NOVOCNOME WITH YNOVOCNOME
    REPLACE NOVOCCIDA WITH YNOVOCCIDA

    SKIP
ENDDO
USEThen, based on what the option user chooses (by Code, by Name, etc) I have to use the commands:To avoid for example the record with the data ÉPICO the field CNOME to appear after the Z letter...Code:IF XQualOrdem=""N""
        Ordem=""CCODI""
    ENDIF
    IF XQualOrdem=""A""               && If the user chooses Alphabetical order, by Name
        Ordem=""NOVOCNOME""       && the record is ordered without special characters 
    ENDIF                            && (the name ÉPICO will be ordered as EPICO)
    IF XQualOrdem=""S""
        Ordem=""CSTAT""
    ENDIF"
Reply,Set a TAG for a field programmaticaly,SitesMasstec,"Jan 7, 2025 at 10:27 PM",https://www.tek-tips.com/threads/set-a-tag-for-a-field-programmaticaly.1832689/,TamarGranor,"A few comments to make your code stronger.1) Don't refer to work areas by number. To find an available work area, use:Code:SELECT 02) Once you have a table open, always refer to it by its alias. For example:Code:SELECT ClientesWhen you do this, you never have to know the work area number for a table.3) In your situation, you're opening tables with random names. Rather than using the random name as the alias, assign an alias in the USE command. I'll combine the example for this with the next item because it's too painful to write a use with the macro operator (&).4) Don't use & as you're using it. It can cause problems in some situations (in particular, if there's a path involved). Instead, when VFP expects a name from you, use what's called aname expression, where you wrap the name in parentheses. So, in your code above, you might use:Code:SELECT 0
  USE (ARQUIVO55) ALIAS ARQUIVO55And from then, on, you can:Code:SELECT ARQUIVO55Tamar"
Reply,Set a TAG for a field programmaticaly,SitesMasstec,"Jan 7, 2025 at 10:27 PM",https://www.tek-tips.com/threads/set-a-tag-for-a-field-programmaticaly.1832689/,SitesMasstec,"Hello Tamar!Following your advice, probably I misunderstood it, I got an error:"
Reply,Set a TAG for a field programmaticaly,SitesMasstec,"Jan 7, 2025 at 10:27 PM",https://www.tek-tips.com/threads/set-a-tag-for-a-field-programmaticaly.1832689/,EinTerraner,"As much as i undrstand you create a new, empty table with an random-filename and you will use this (empty) copy in workarea 55.Code:ARQUIVO55=SYS(2015)
** open the source table (why in 1?)
USE clients IN 0 && next free number of workarea
** make new temporary TABLE (why not cursor) with the structure from clients
** your code above copys only the structure without content
SELECT * FROM clients INTO TABLE (ARQUIVO55) WHERE .f.
** ARQUIVO55 has now random workarea-number. therefore close it
USE IN SELECT(ARQUIVO55)
** and reopen in Workarea 55
USE (ARQUIVO55) IN 55 EXCLUSIVE

** Here do your code

** Close the temp-table
USE IN SELECT(ARQUIVO55)1st: You use a real file with an temporyry name. so you need to delete this file after usage. if you use an cursor instead a table, the physical file will not exist after closing the cursor2nd: Where do you update your still empty table with data?the REPLACE UNTIL EOF()-Loop can be done much easier: Here you do not need the YNOVO....Your ALTER TABLE looks like missing the leading ""Y"" in the fieldnameCode:Lc_Xchar = 'ÁÂÃáâãÉÊéêÍíÓÔÕóôõÚúÇç'
Lc_Nchar = 'AAAaaaEEeeIiOOOoooUuCc'

REPLACE NOVOCNPOP WITH CHRTRAN(NOVOCNPOP, Lc_Xchar, Lc_Xchar) ;
        NOVOCNOME WITH CHRTRAN(NOVOCNOME, Lc_Xchar, Lc_Xchar) ;
        NOVOCCIDA WITH CHRTRAN(NOVOCCIDA, Lc_Xchar, Lc_Xchar) ;
    FOR .t. ;
    IN (ARQUIVO55)also the setting of indexCode:DO CASE
CASE XQualOrdem=""N""
    Ordem=""CCODI""
CASE XQualOrdem=""S""
    Ordem=""CSTAT""
CASE XQualOrdem=""A""
    Ordem=""NOVOCNOME""
OTHERWISE
    Ordem=""""    && not sorted
ENDCASEif you post the whole programm it wil be much easier to understand exactly what you try to do"
Reply,Set a TAG for a field programmaticaly,SitesMasstec,"Jan 7, 2025 at 10:27 PM",https://www.tek-tips.com/threads/set-a-tag-for-a-field-programmaticaly.1832689/,TamarGranor,I think EinTerraner has given you what you need. I agree with his question about why you are creating a temporary table rather than just using a cursor.Tamar
Reply,Set a TAG for a field programmaticaly,SitesMasstec,"Jan 7, 2025 at 10:27 PM",https://www.tek-tips.com/threads/set-a-tag-for-a-field-programmaticaly.1832689/,Chris Miller,"SitesMasstec said:The real problem is more complex:...Click to expand...That doesn't matter, INDEX ON is always the command to create indexes.What you posted doesn't make use of an index in itself, though your last code setting a variable named Ordem suggests you want to use that for setting the order. Well, you always first have to create an index before sorting by it with the means of SET ORDER TO tagname or USE ... ORDER TAG tagname. And all that should be clear from previous threads, too. The threads all cover multiple questions related to your problems.Regarding your posted code overall, you got some advice already, I spare to add to that, maybe just one thing: INDEX ON also works on cursors, it's not requiring a DBF file to create index tags. INDEX ON always works on the currently selected workarea. Your code mainly raises two questions: What's your goal and what does not work?"
Reply,Set a TAG for a field programmaticaly,SitesMasstec,"Jan 7, 2025 at 10:27 PM",https://www.tek-tips.com/threads/set-a-tag-for-a-field-programmaticaly.1832689/,SitesMasstec,"Hello colleagues!""Ein - 1st: "" Yes, I have commands to erase these temporary files. I will try to use Cursor, instead, following Ein, Tamar & Chris advice""Ein - 2nd:"" I had not shown in my post, but the code to fill the table with data is:Code:SELECT 55
    APPEND BLANK

    REPLACE CCODI WITH YCCODI, CSTAT WITH YCSTAT, CSTA2 WITH YCSTA2, CVEND WITH YCVEND
    REPLACE CNPOP WITH YCNPOP
    ... (etc)As there are many conditional statements before filling the file with data, it would be very long to use the command, as Ein suggested:Code:SELECT * FROM clients INTO TABLE (ARQUIVO55) WHERE .f.Well, it is working fine now after the use of INDEX ON to create TAGs. The data from &ARQUIVO55 are used in another file ETIQUETA.DBF, to print labels."
Reply,Set a TAG for a field programmaticaly,SitesMasstec,"Jan 7, 2025 at 10:27 PM",https://www.tek-tips.com/threads/set-a-tag-for-a-field-programmaticaly.1832689/,EinTerraner,"SitesMasstec said:As there are many conditional statements before filling the file with data, it would be very long to use the command, as Ein suggested:Code:SELECT * FROM clients INTO TABLE (ARQUIVO55) WHERE .f.Click to expand...Did You ever try the SELECT... WHERE .F.?even if the FROM-Table (290MB) accessed via internet (VPN) with the WHERE .f. clause it takes ZERO-time.ans also i assume you scan your sourcetable with a specific SET FILTER TO... and/or SET ORDER TOand let me guess. You use this temprarty table for something like ""REPORT FORM YourFRX-File TO YourOutPutDestinationWhere you get theYfieldnames to replace in the same name without theYlet me guess once more: You read your ""clients""-table store each field in a similarYvariable berfore you make tzhe replace-commandsso adapt and check following codeCode:LOSE DATABASES
CLEAR

LOCAL SRC as String, DST as String, Lo_Data as Object, Lc_Secs as Number

** set Aliasnames as NAME and as STRING
** so you can access the alias direct or indirect with ""()""
SRC = ""SRC""
DST = ""DST""
**SET STEP ON
** Here I open my daily journal, in which all orders and resulting invoices are saved (since 2016).
** This Ttable contains about 150000 records and is about 90GB in size and has also MEMO-fields (50GB)
USE ""Y:\DATA\B003_JOU"" IN 0 ALIAS SRC NOUPDATE
?""Records Source = "",RECCOUNT(SRC)

** creating a empty cursor with same structure
** direct usage from alias named ""DST""
SELECT * FROM SRC INTO CURSOR DST READWRITE WHERE .f.
** indirect usage from alias named ""DST""
SELECT * FROM (SRC) INTO CURSOR (DST) READWRITE WHERE .f.

** if required so do
** SET FILTER TO {filtercondition} IN (SRC)
** SET ORDER TO {Sortcondition} IN (SRC)
Lc_Secs = SECONDS()
GO TOP IN SRC
DO WHILE !EOF(SRC)
    SELECT SRC
** Here I only take the data records that have a valid invoice number
** and no article number (invoice total)
    IF !EMPTY(ORDBELG) ;
    .and. EMPTY(ORDNUMM)
        SCATTER NAME Lo_Data MEMO
        INSERT INTO DST FROM NAME Lo_Data
    ENDIF
    SKIP IN SRC
ENDDO
?""Records Destination = "",RECCOUNT(DST)
?""Time scan full table in Seconds:"",SECONDS()-Lc_Secshere the screenshoot with elapsed time result it's just a blink more as one second"
Question,fox pro dos 2.5 inventory problem,Fadii,"Jan 17, 2025 at 12:01 PM",https://www.tek-tips.com/threads/fox-pro-dos-2-5-inventory-problem.1832790/,Fadii,Hi all experts...I have own a business of medicine distribution and using foxpro dos 2.5 application for sale and purchase since 2004 but now i am facing problem..i have bought a new laptop with windows 10 32 bit and copy my application from old d: drive to new one d: drive problem is that my application has dbf file called mast.dbf which has medicine item names but in application when i purchase any kind of product it dont show the stock invventory then i go to the item registration option and again save the same item and then i purchase it then it shows the stock inventory..
Reply,fox pro dos 2.5 inventory problem,Fadii,"Jan 17, 2025 at 12:01 PM",https://www.tek-tips.com/threads/fox-pro-dos-2-5-inventory-problem.1832790/,Chris Miller,"Too little information to be able to help.I asusme you don't have source code of this, copied the application directory and data and - at least - it starts and works overall.You're already lucky with that, anyway, other things might be in other directories or in the Windows registry to make your copy complete. Since stock inventory is missing, it seems you miss another dbf, at least. It would be very unusual for a software to work based on a single dbf table only."
Reply,fox pro dos 2.5 inventory problem,Fadii,"Jan 17, 2025 at 12:01 PM",https://www.tek-tips.com/threads/fox-pro-dos-2-5-inventory-problem.1832790/,SitesMasstec,"Maybe if you reindex some fields (like item code and item name) you can get what you need.Of course you need to have a FoxPro (for DOS) in your computer, or other software that can do standard  DBF reindexing. Using a Visual version of the FoxPro you need to write command to transform the DBF to non VFP type (COPY TO myfile TYPE FOX2X)"
Reply,fox pro dos 2.5 inventory problem,Fadii,"Jan 17, 2025 at 12:01 PM",https://www.tek-tips.com/threads/fox-pro-dos-2-5-inventory-problem.1832790/,Jeremy H,"Fadii said:Hi all experts...I have own a business of medicine distribution and using foxpro dos 2.5 application for sale and purchase since 2004 but now i am facing problem..i have bought a new laptop with windows 10 32 bit and copy my application from old d: drive to new one d: drive problem is that my application has dbf file called mast.dbf which has medicine item names but in application when i purchase any kind of product it dont show the stock invventory then i go to the item registration option and again save the same item and then i purchase it then it shows the stock inventory..Click to expand...I realize that you want to get your existing system working, but if you are at all interested in an inexpensive replacement, also based on VFP (but later), I have one that does what it sounds like you do. You can feel free to contact me if you want support at marketmentoronline.com. I'm not sure if this is a terms of service violation, so if it is, I apologize. I just hate to see people locked into an old system that doesn't work properly on newer hardware."
Reply,fox pro dos 2.5 inventory problem,Fadii,"Jan 17, 2025 at 12:01 PM",https://www.tek-tips.com/threads/fox-pro-dos-2-5-inventory-problem.1832790/,Fadii,"SitesMasstec said:Maybe if you reindex some fields (like item code and item name) you can get what you need.Of course you need to have a FoxPro (for DOS) in your computer, or other software that can do standard  DBF reindexing. Using a Visual version of the FoxPro you need to write command to transform the DBF to non VFP type (COPY TO myfile TYPE FOX2X)Click to expand...How to reindex"
Reply,fox pro dos 2.5 inventory problem,Fadii,"Jan 17, 2025 at 12:01 PM",https://www.tek-tips.com/threads/fox-pro-dos-2-5-inventory-problem.1832790/,chandreshgeria,Fadii said:Hi all experts...I have own a business of medicine distribution and using foxpro dos 2.5 application for sale and purchase since 2004 but now i am facing problem..i have bought a new laptop with windows 10 32 bit and copy my application from old d: drive to new one d: drive problem is that my application has dbf file called mast.dbf which has medicine item names but in application when i purchase any kind of product it dont show the stock invventory then i go to the item registration option and again save the same item and then i purchase it then it shows the stock inventory..Click to expand...HelloThis may be due to idx/cdx is not update while insert record in table .Donot try to insert record in table by opening table or use index with table to insert record
Reply,fox pro dos 2.5 inventory problem,Fadii,"Jan 17, 2025 at 12:01 PM",https://www.tek-tips.com/threads/fox-pro-dos-2-5-inventory-problem.1832790/,Scott24x7,"Of course you need to have a FoxPro (for DOS) in your computer, or other software that can do standard DBF reindexing. Using a Visual version of the FoxPro you need to write command to transform the DBF to non VFP type (COPY TO myfile TYPE FOX2X)Click to expand...Maybe... Maybe not.  It was a common practice to build reindexing routines into applications, particularly in the FPD days, as corrupt indexes our out dated indexes could become an issue.  For this reason, many applications include a ""Pack and Reindex"" administrative function, sometimes as a topline menu item, or as a separate .EXE.  If that is the case, you can utilize what the application has built into it.  That does of course depend on if the developer created such routines for this application."
Reply,fox pro dos 2.5 inventory problem,Fadii,"Jan 17, 2025 at 12:01 PM",https://www.tek-tips.com/threads/fox-pro-dos-2-5-inventory-problem.1832790/,Chris Miller,"If indexes were the problem, they would have been a problem before the change to the laptop. The simplest reason for missing data is missing data, i.e. dbfs not copied. If data is in the network and not local, the other big issue can be configuration to the network data missing, for example a simple registry key for that.In general you don't copy software, you install it. If you have no installer, you need to know internal details about everything belonging to a software and the installation direcrtory is generally not everything about a software. It could be, but it rarely is."
Reply,fox pro dos 2.5 inventory problem,Fadii,"Jan 17, 2025 at 12:01 PM",https://www.tek-tips.com/threads/fox-pro-dos-2-5-inventory-problem.1832790/,Chris Miller,Fadii are there any errors displayed by the application?
Reply,fox pro dos 2.5 inventory problem,Fadii,"Jan 17, 2025 at 12:01 PM",https://www.tek-tips.com/threads/fox-pro-dos-2-5-inventory-problem.1832790/,SitesMasstec,"Faddi:You can index this way:Let's say you want to index the field XNAME in the file MyClientsCode:USE MyClients
INDEX ON XNAME TO INDXNAME
USEIt will be created a file INDXNAME.IDX which you could have your clients sorted alphabeticaly:Code:USE MyClients INDEX INDXNAMEYou can also sort using TAGs (no more IDX files), but I don't know if your app version supports it."
Question,Signature pads with VFP,GTGeek88,"Jan 17, 2025 at 4:34 PM",https://www.tek-tips.com/threads/signature-pads-with-vfp.1832793/,GTGeek88,"Has anyone worked with signature pads combined with VFP 9? Here are some examples:https://www.amazon.com/s?k=signatur...nature+pad,aps,419&ref=nb_sb_ss_ts-doa-p_1_13"
Reply,Signature pads with VFP,GTGeek88,"Jan 17, 2025 at 4:34 PM",https://www.tek-tips.com/threads/signature-pads-with-vfp.1832793/,tomk3,"Hello,we are usinghttps://stepover.com/en/about-us/They have an api and a commandline toolI also have read that TOPAZ has good vfp support, but not tested myselfDemos & Source Code - Topaz SystemsPick your environment to download Topaz demos with complete source code for Topaz electronic signature pads.www.topazsystems.com"
Question,WhatsAPP and VFP9 SP2,Steve-vfp9user,"Jan 16, 2025 at 4:20 PM",https://www.tek-tips.com/threads/whatsapp-and-vfp9-sp2.1832781/,Steve-vfp9user,"Hello allHaven't posted for a long time and hoping someone can suggest a link or other assistance.This forum has multiple posts for WhatsAPP messages via VFP but having tried them, none appear to be working, well at least not for me.I have the WhatsAPP Windows 10 App installed from the Microsoft Store which actually opens when I run the code below and shows the thread of the recipient I am trying to send a message to but the actual message is not being sent.I asked chatGPT to come up with this but it's not working. No error meesages are shown.Code:DECLARE INTEGER ShellExecute IN SHELL32.DLL ;
    INTEGER hWnd, STRING lpOperation, STRING lpFile, ;
    STRING lpParameters, STRING lpDirectory, INTEGER nShowCmd

* Define the recipient phone number (without spaces or symbols)
lcPhoneNumber = ""447539677744""  && Replace with actual number

* Define the message to send
lcMessage = ""Hello, this is an automated message from Visual FoxPro!""

* Open WhatsApp chat
lcWhatsAppURL = ""whatsapp://send?phone="" + lcPhoneNumber
ShellExecute(0, ""open"", lcWhatsAppURL, """", """", 1)

* Wait for WhatsApp to open
SLEEP(6000)  && Adjust delay if needed

* Type the message using NirCmd
lcNirCmdPath = ""C:\nircmd\nircmd.exe""  && Adjust path if needed

* Simulate typing the message
lcCmd = '""' + lcNirCmdPath + '"" sendkeypress ""' + lcMessage + '""'
RUN /N &lcCmd

* Simulate pressing ""Enter"" to send the message
RUN /N C:\nircmd\nircmd.exe sendkeypress 0x0D"
Reply,WhatsAPP and VFP9 SP2,Steve-vfp9user,"Jan 16, 2025 at 4:20 PM",https://www.tek-tips.com/threads/whatsapp-and-vfp9-sp2.1832781/,Paul Gibson,"I have no familiarity with this, I just happened to read it and was curious enough to reply.There are no error messages because for one, the generated code doesn't do any error checking - it is written making a lot of assumptions, the main one being that everything will work fine, no checking return values/statuses etc.One thing you didn't make clear is whether the message gets ""typed"" by the part that simulates typing the message, you just said the message doesn't send.  I will assume it isNOTbeing ""typed"" as that is probably the main problem and why no message is sent, the whole thing relies on a lot that is outside of your absolute control.My interpretation of the main part of the code and the potential flaws, followsThe ""* Open WhatsApp chat"" section, you are Shell-Executing a string that begins ""whatsapp://send"" so your machine (and every other machine this might run on) needs to be told what to do here.  Windows probably doesn't natively know what to do with a string that being ""whatsapp://send"" but this isn't a part that fails, it's just something to note.  Your description is that you've installed a WhatsApp application from the MS Store and this section is working for you so presumably this part is mostly fine because installing the app is what allows Windows to know how to handle that string.The ""* Wait for WhatsApp to open"" section, this is just a pause to wait for the app to load presumably but SLEEP is not a native VFP command.  It is a WinAPI call which your code doesn't show you've declared it but presumably you have at some other point in your dev session otherwise that line would throw an error like ""Unrecognised command verb"" or similar.What is also interesting with these kinds of solutions is that just having an arbitrary call to Sleep for an arbitrary value does make it look like a bodge, getting the code to wait for non-concrete amount of time to wait for something external to do something.  6 seconds on one machine isn't equal to 6 seconds on a different machine with different performance, it's an inexact aspect.Because this solution is using a third-party application in this manner you are always at the mercy of that third-party app changing in some way.  You might get this working eventually but what if the app auto-updates a week later and then the current solution no longer works because the app does something subtly different to before.  It's always a risk.The ""* Type the message using NirCmd"" and ""* Simulate typing the message"" sections are where the solution is likely failing.  I'm not familiar with NirCmd but briefly looking at it, it does appear to be a cmd-like app for doing things mostly invisibly so I can understand what it is trying to do.  This part looks like it is 100% reliant on your caret (focus) being in the correct place as it is effectively just taking the message from earlier in the program and almost ""playing it"" as if it is being typed live BUT if when the WhatsApp application launched and showed you the correct thread, the caret isn't in the correct place, then simulating the message being ""typed"" may not put the message anywhere, it might just go into the ether.I suppose this is similar to if you scripted something to try to automatically type in all the entries in a form you didn't have control of, with tabs etc to move from one field to another and then the form changed, even subtly, so the wrong values were being typed into the wrong fields.  In that scenario you'd have to update your script accordingly.Perhaps for you, this program assumes that the caret (focus) is in the correct place in the WhatsApp app and it simply isn't.The ""* Simulate pressing ""Enter"" to send the message"" section is similar to above.  It is probably 100% reliant on the caret or focus being in the correct place and it is not.  Perhaps simulating pressing Enter does not send the message either because the app disables the ""Send"" facility when there is no message (and the earlier section not typing the message is why there is no message) or just the focus being in the wrong place is why simulating pressing Enter doesn't do anything.In summary the code you've got works on assumptions:1. It assumes that the Windows shell will know how to handle the ""whatsapp://send"" string - it does for you, you get that by installing the application2. It waits for a non-concrete amount of time for the app to launch, select the correct recipient and make itself ready - on one machine this could be fine being 6 seconds, on a slower machine might it need 10 seconds or even 20 seconds.3. It assumes that the caret will be in the correct place, ready to received a ""simulated"" typed message.  If the caret never gets to the correct input box or if it's just not there because the SLEEP was too short - this is possibly the breaking point.4. Same as #3 it assumes that simulating pressing enter will tell the control that currently has the focus to send the message but if the wrong control has the focus, plus if #3 fails, then #4 is likely to fail alsoI don't necessarily have a solution, that's just my analysis of the code and where the problem(s) could lie."
Reply,WhatsAPP and VFP9 SP2,Steve-vfp9user,"Jan 16, 2025 at 4:20 PM",https://www.tek-tips.com/threads/whatsapp-and-vfp9-sp2.1832781/,Paul Gibson,"There's at least another two assumptions that the code makes that I didn't mention in the initial reply.  The code doesn't double-check it just assumes that nircmd.exe exists, and it exists in the path you've specified.In the ""simulate typing"" part the run command is built up using thelcNirCmdPathvariable but the code doesn't actually pre-emptively check that the exe does exist at that path.  If it didn't exist then the RUN command would fail and you'd get a visible error at runtime so since you say you are not getting an error we can presume that you do have it installed in that location and that adds extra credence to the theory that the reason this whole thing is failing is because when nircmd.exe runs and simulates typing the message, the caret (focus) just isn't in the correct place.Further, even though in the ""simulate typing"" part the run command is built up using thelcNirCmdPathvariable, the ""simulate pressing enter"" part has the run command totally ignore thelcNirCmdPathvariable.  So you've got the full path to the exe specified on two different lines.  Not a problem if you can always guarantee that the exe lives at that specific path and especially if you do some checking before but as the code stands right now, if you put the exe in a slightly different place, you'd have two different lines of code to update, which isn't great coding, something to be avoided if you can.  If something can be variable, put it in one place and with something like a path to a file you can write the code to check if the file exists and make that an IF surrounding all the parts that rely on the file being there, perhaps even putting a MESSAGEBOX in the ELSE to inform you if it doesn't exist - at least temporarily in dev while you test the whole proof of concept (POC).It's always a good idea if you are trying a new POC to write plenty of error checking, evaluation of return values, even outputting things to the ""console"" using ? if you are really struggling to figure out what is going on.  Then when you've got it working remove any unnecessary debugging output, but it is still always useful to check return values etc, especially on things like ShellExecute."
Reply,WhatsAPP and VFP9 SP2,Steve-vfp9user,"Jan 16, 2025 at 4:20 PM",https://www.tek-tips.com/threads/whatsapp-and-vfp9-sp2.1832781/,Steve-vfp9user,"Paul Gibson said:There's at least another two assumptions that the code makes that I didn't mention in the initial reply.  The code doesn't double-check it just assumes that nircmd.exe exists, and it exists in the path you've specified.In the ""simulate typing"" part the run command is built up using thelcNirCmdPathvariable but the code doesn't actually pre-emptively check that the exe does exist at that path.  If it didn't exist then the RUN command would fail and you'd get a visible error at runtime so since you say you are not getting an error we can presume that you do have it installed in that location and that adds extra credence to the theory that the reason this whole thing is failing is because when nircmd.exe runs and simulates typing the message, the caret (focus) just isn't in the correct place.Further, even though in the ""simulate typing"" part the run command is built up using thelcNirCmdPathvariable, the ""simulate pressing enter"" part has the run command totally ignore thelcNirCmdPathvariable.  So you've got the full path to the exe specified on two different lines.  Not a problem if you can always guarantee that the exe lives at that specific path and especially if you do some checking before but as the code stands right now, if you put the exe in a slightly different place, you'd have two different lines of code to update, which isn't great coding, something to be avoided if you can.  If something can be variable, put it in one place and with something like a path to a file you can write the code to check if the file exists and make that an IF surrounding all the parts that rely on the file being there, perhaps even putting a MESSAGEBOX in the ELSE to inform you if it doesn't exist - at least temporarily in dev while you test the whole proof of concept (POC).It's always a good idea if you are trying a new POC to write plenty of error checking, evaluation of return values, even outputting things to the ""console"" using ? if you are really struggling to figure out what is going on.  Then when you've got it working remove any unnecessary debugging output, but it is still always useful to check return values etc, especially on things like ShellExecute.Click to expand...PaulYou mentioned, ""One thing you didn't make clear is whether the message gets ""typed"" by the part that simulates typing the message, you just said the message doesn't send.  I will assume it isNOTbeing ""typed"" as that is probably the main problem and why no message is sent, the whole thing relies on a lot that is outside of your absolute control.""My apologies, the message doesn't get typed, it just opens the list of recipients on my Whatsapp list after I execute the code but no message is ever sent or typed."
Reply,WhatsAPP and VFP9 SP2,Steve-vfp9user,"Jan 16, 2025 at 4:20 PM",https://www.tek-tips.com/threads/whatsapp-and-vfp9-sp2.1832781/,Paul Gibson,"OK, that was the assumption that I was going on so thanks for confirming it.You said, in your original message:... which actually opens when I run the code below and shows the thread of the recipient I am trying to send a message to...Click to expand...so the assumption I'm making from that part, is that the ShellExecute bit of the code is working absolutely fine, the correct app is loading and within the app it's going to the correct recipient.  However, what happens next is probably outside your control, it is entirely within the control of the WhatsApp application, not you.My whole theory as to why the code is not doing what you want is that after the WhatsApp application opens and navigates to the correct recipient, the caret is not sitting in the correct place for a message to be ""typed"", this means when you leverage the nircmd.exe to simulate typing a message, it is doing that but with the caret not in the correct place, that simulation is just ""typing keys"" into the ether.At each point there are potentials for failure, at the point where I believe it is not working for you, the assumption the code is making is that the WhatsApp application has the caret/focus in the correct place so when nircmd.exe simulates typing the message, it is the WhatsApp application that has the caret in the correct place, happy to receive the simulated key-presses.  It could be that there is no way of 100% ascertaining that the application loads and puts the focus at the correct place.As I intimated in my first reply, that code may have been written by someone a while back, when the behaviour of the WhatsApp application was such that the caret/focus did end up in the correct place but now the application might be on a different version, with different behaviour which means it is not.  Heck, they might havedeliberatelychanged the WhatsApp application to stop people automating it in the manner that you are attempting to.  That's what you could be up against with this program.One thing you can potentially try is just comment out everything AFTER the call to SLEEP, then run the whole code, sit back, wait the 6 (or so) seconds and then look at the WhatsApp application, just observe it.  Where is the caret?  Is the caret blinking away anywhere?  If you can't see it, can you press tab and see if you can make a caret or focus move about the screen?  That's the type of analysis that you may have to do, to try to figure out where the focus is.If the focus is not in the correct place then, with the application launching the way you are, can you, withJUSTthe keyboard, press keys, particularly the tab key or any hotkeys or shortcuts, to get the focus/caret in the correct place?  If you can't do it manually with your keyboard then you might not be able to tell nircmd.exe how to do it.I don't have any desire to install the WhatsApp application on any of my machines so I am trying to help, a little blind.  One thing you could potentially do is, run the program while everything after the sleep is commented out, wait the 6 (or so) seconds and then take a screenshot.  Paste the screenshot into your favourite image editing application, blur anything that you don't want us to see (people's mobile numbers etc) and then attach that image to a reply on this thread and perhaps someone here can see more of what you are describing and we'll have a bit more information to go on."
Question,Error when trying to publish web service,lCoimbra,"Jan 13, 2025 at 12:30 PM",https://www.tek-tips.com/threads/error-when-trying-to-publish-web-service.1832737/,lCoimbra,"Hello.I'm trying to create a small webservice for testing purposes in my Windows 10 and Windows 11 machines. I have IIS enabled and running.I have read somee tutorials like ""XML Web Services for Visual FoxPro Developers"" written by Doug Hennig.Somehow I'm getting several errors and strange things, for instance, I'm unable to create a New or Existing Virtual Directory. The windows is like this:I don't know why. If I try to write it down I'm getting:I don't understand this. I'm having these problems in both Windows 10 and Windows 11 computers.TIA"
Reply,Error when trying to publish web service,lCoimbra,"Jan 13, 2025 at 12:30 PM",https://www.tek-tips.com/threads/error-when-trying-to-publish-web-service.1832737/,Chris Miller,"The upper window also tells you don't have IIS installed on that machine. So either you try to configure a web service client with this, or the detection of a too modern IIS version failed on the server.Just like in a recent thread about FoxIs and Isapi I'd say this is all too old. The way to build VFP XML Web Services was built on the Soap Toolkit which deprecated long ago. I'd look into other ways of providing and/or consuming a web service. West Wind has all you need in WEb Connection -https://webconnection.west-wind.com/and while one paragraph's title is  Create JSON REST Services it says AJAX (Asynchronous JavaScript andXML) there you have XML, if you absolutely want. The description tells you there are utility functions to cope with object to json and json to object conversion, though, and JSON is the more lightweight and more often used standard for transporting both objects and data, so a good reason to rethink it loike that.If you already have built your XML web service foundation and now struggle with publishing and consuming it that's another story. But using the soap toolkit is not the only way."
Reply,Error when trying to publish web service,lCoimbra,"Jan 13, 2025 at 12:30 PM",https://www.tek-tips.com/threads/error-when-trying-to-publish-web-service.1832737/,lCoimbra,"Chris Miller said:The upper window also tells you don't have IIS installed on that machine. So either you try to configure a web service client with this, or the detection of a too modern IIS version failed on the server.Just like in a recent thread about FoxIs and Isapi I'd say this is all too old. The way to build VFP XML Web Services was built on the Soap Toolkit which deprecated long ago. I'd look into other ways of providing and/or consuming a web service. West Wind has all you need in WEb Connection -https://webconnection.west-wind.com/and while one paragraph's title is  Create JSON REST Services it says AJAX (Asynchronous JavaScript andXML) there you have XML, if you absolutely want. The description tells you there are utility functions to cope with object to json and json to object conversion, though, and JSON is the more lightweight and more often used standard for transporting both objects and data, so a good reason to rethink it loike that.If you already have built your XML web service foundation and now struggle with publishing and consuming it that's another story. But using the soap toolkit is not the only way.Click to expand...Hello, Chris.Thanks for your reply.I was trying to use it in order to be able create blocks of VFP9 code that could be executed externally either in Android or Windows devices ( connected in the local network ). Imagine, for instance, to get the customer's data from our database. This intended to be free of charge and that's why I was trying to use this in VFP.I will take a look at what you mentioned.Thanks"
Reply,Error when trying to publish web service,lCoimbra,"Jan 13, 2025 at 12:30 PM",https://www.tek-tips.com/threads/error-when-trying-to-publish-web-service.1832737/,Chris Miller,"I hope hen looking at this you discovered that West Winds offer is also enabling you to rite the Web service in FoxPro code, that's clearly what you want to do and that's why I said using the soap toolkit is not the only way to bring Foxpro on the web. Half of Rick Strahls life was about bringin FoxPro to the web (or also intranet). Not only on the client side."
Question,ChilkatVFP version 1.40 Released,Bill Anderson,"Jan 16, 2025 at 1:43 AM",https://www.tek-tips.com/threads/chilkatvfp-version-1-40-released.1832773/,Bill Anderson,"Folks,ChilkatVFP 1.40 update can be found here:https://github.com/billand88/ChilkatVFPHighlights:Main class library name changed from Chilkat.VCX to ChilkatVFP.VCX (and iChilkat.VCX to iChilkatVFP.VCX)This release has Chilkat Version 10 compatibility which includes...Support for new two dot notation [10.1.0] and three dot notation [9.5.0.62]Support for OLE prefix ""Chilkat_9_5_0"" and new prefix ""Chilkat""Added new Secrets class released in Chilkat version 10.1.0Support for Chilkat class retirementNew Versioning class to support version format changes.Changed all internal source code to support the new versioning style.Found two classes that didn't get the ""m."" prefix for memory variables as described in Version 1.31 changes as well as other random methodsBill Anderson"
Reply,ChilkatVFP version 1.40 Released,Bill Anderson,"Jan 16, 2025 at 1:43 AM",https://www.tek-tips.com/threads/chilkatvfp-version-1-40-released.1832773/,Joe Crescenzi,"Thank you for posting this.  I've been using Chilkat for years and I was unaware of your VCX library, so I just took a look at the GitHub page and I'm excited to learn all about it.Chilkat is an amazing set of tools, but since it's language agnostic, sometimes it takes a while to adapt the sample code, so I'm looking forward to seeing what the wrapper can do."
Reply,ChilkatVFP version 1.40 Released,Bill Anderson,"Jan 16, 2025 at 1:43 AM",https://www.tek-tips.com/threads/chilkatvfp-version-1-40-released.1832773/,tomk3,There is a page with vfp samplesVisual FoxPro Example Programs and Sample Code
Reply,ChilkatVFP version 1.40 Released,Bill Anderson,"Jan 16, 2025 at 1:43 AM",https://www.tek-tips.com/threads/chilkatvfp-version-1-40-released.1832773/,Joe Crescenzi,"tomk3 said:There is a page with vfp samplesVisual FoxPro Example Programs and Sample CodeClick to expand...I'm very familiar with Chilkat's example page for FoxPro and for anyone who has never tried it, I HIGHLY recommend it.I've adapted quite a few of the samples over the years to use in my projects but I've never seen a VCX wrapper class for it, so I'm looking forward to checking it out."
Reply,ChilkatVFP version 1.40 Released,Bill Anderson,"Jan 16, 2025 at 1:43 AM",https://www.tek-tips.com/threads/chilkatvfp-version-1-40-released.1832773/,Bill Anderson,"Joe Crescenzi said:Thank you for posting this.  I've been using Chilkat for years and I was unaware of your VCX library, so I just took a look at the GitHub page and I'm excited to learn all about it.Chilkat is an amazing set of tools, but since it's language agnostic, sometimes it takes a while to adapt the sample code, so I'm looking forward to seeing what the wrapper can do.Click to expand...Joe,Then I glad you found it! In short, it's a wrapper around the Chilkat library. In theory, you should be able to comment out your Chilkat creation call with one to the ChilkatVFP version and it should all work. Which begs the question, why ChilkatVFP?First, I'll refer you to the documentation. in the Documentation folder.Off the top of my head...1) Can use .T./.F. as return values by setting a property on the ChilkatVFP object2) Documentation/documentation/documentation. Look at the actual source in the ChilkatVFP library. All of Chilkat's method/property documentation is in the ChilkatVFP's source code.3) Events don't work as documented in Chilkat, I fixed them/extended them in ChilkatVFP.4) Look at the ChilkatChangeLog method for a specific ChilkatVFP object and you'll see all the work done on that Chilkat object. Chilkat doesn't have that type of documentation.5) When it works, VFP will support design time Intellisense within the source code.6) Support for undocumented Chilkat methods and properties, and several are helpful to the VFP developer.7) 10 or 11 Chilkat classes don't have a Version property and I try my best to work around that and come up with one...8) You can pass a .T. or a .F. as a Chilkat parameter and ChilkatVFP will convert it for you.9) Dialog support for multiple languages.and so on.Other notes:ChilkatVFP tries to keep you comfortable in your familiar VFP environment. Simple as that.The 1.40 changes are huge and I need to put out a patch version. I put a note to myself in the lEventHandler_Assign method to ""...Some things to fix here"" and didn't do so. A fix will come out in a few days. If you're not using Chilkat Events immediately, you're perfectly fine.Let me know if you have any questions!Bill Anderson"
Question,64 bit replacement needed for Dynazip,Grandchoir,"Jan 9, 2025 at 11:13 PM",https://www.tek-tips.com/threads/64-bit-replacement-needed-for-dynazip.1832713/,Grandchoir,"I need a 64-bit replacement for Dynazip for use with Visual FoxPro Advanced(x64). Any recommendations?I can use 7-Zip CLI along with shell_execute, but wondered if anyone has more experience zipping and unzipping files in Visual FoxPro Advanced.Thank you in advance!Daniel"
Reply,64 bit replacement needed for Dynazip,Grandchoir,"Jan 9, 2025 at 11:13 PM",https://www.tek-tips.com/threads/64-bit-replacement-needed-for-dynazip.1832713/,GriffMG,"Thus far, I have been using BandiZip, about 18 months ago I did a lot of testing various zip programs with VFPaand that was the fastest.Times change."
Reply,64 bit replacement needed for Dynazip,Grandchoir,"Jan 9, 2025 at 11:13 PM",https://www.tek-tips.com/threads/64-bit-replacement-needed-for-dynazip.1832713/,ggreen61,"You could use the Windows API.To remove files from a zip file:Code:loShell = CREATEOBJECT(""shell.application"")
    loShell.NameSpace(tcTempPath).CopyHere(loShell.NameSpace(lcZipName).Items, FOF_SILENT)
    lnCnt = 0
    lnCntTot = loShell.NameSpace(lcZipName).Items.Count
    DO WHILE loShell.NameSpace(tcTempPath).Items.Count != lnCntTot
        lnCnt = lnCnt + 1
        apiSleep(100)
        IF lnCnt > lnCntTot
            this.DebugMethod()
        ENDIF
    ENDDOTo add files to a zip file:Code:loShell  = CREATEOBJECT(""shell.application"")
    loFolder = loShell.NameSpace(tcTempPath).Items
    IF VAL(VERSION(4)) <= 9 .AND. (VAL(OS(3))<6 .OR. VAL(OS(3))=6 .AND. VAL(OS(4))<1)      && Fix for VFPA provided by Doug Hennig; VAL() fix provided by starfiresg1
        FOR EACH loFile IN loFolder
            loShell.NameSpace(tcZipFile).MoveHere(loFile, FOF_SILENT+FOF_NOCONFIRMATION+FOF_NOERRORUI)
            apiSleep(100)
        ENDFOR
    ELSE
        FOR EACH loFile IN loFolder
            lnCountBefore = loShell.NameSpace(tcTempPath).Items.Count
            loShell.NameSpace(tcZipFile).MoveHere(loFile, FOF_SILENT+FOF_NOCONFIRMATION+FOF_NOERRORUI)
            DO WHILE lnCountBefore = loShell.NameSpace(tcTempPath).Items.Count
                apiSleep(50)
            ENDDO
        ENDFOR
    ENDIF"
Reply,64 bit replacement needed for Dynazip,Grandchoir,"Jan 9, 2025 at 11:13 PM",https://www.tek-tips.com/threads/64-bit-replacement-needed-for-dynazip.1832713/,Grandchoir,"GriffMG said:Thus far, I have been using BandiZip, about 18 months ago I did a lot of testing various zip programs with VFPaand that was the fastest.Times change.Click to expand...Thank you GriffMG. I'll look into this further.Daniel"
Reply,64 bit replacement needed for Dynazip,Grandchoir,"Jan 9, 2025 at 11:13 PM",https://www.tek-tips.com/threads/64-bit-replacement-needed-for-dynazip.1832713/,Grandchoir,"ggreen61 said:You could use the Windows API.To remove files from a zip file:Code:loShell = CREATEOBJECT(""shell.application"")
    loShell.NameSpace(tcTempPath).CopyHere(loShell.NameSpace(lcZipName).Items, FOF_SILENT)
    lnCnt = 0
    lnCntTot = loShell.NameSpace(lcZipName).Items.Count
    DO WHILE loShell.NameSpace(tcTempPath).Items.Count != lnCntTot
        lnCnt = lnCnt + 1
        apiSleep(100)
        IF lnCnt > lnCntTot
            this.DebugMethod()
        ENDIF
    ENDDOTo add files to a zip file:Code:loShell  = CREATEOBJECT(""shell.application"")
    loFolder = loShell.NameSpace(tcTempPath).Items
    IF VAL(VERSION(4)) <= 9 .AND. (VAL(OS(3))<6 .OR. VAL(OS(3))=6 .AND. VAL(OS(4))<1)      && Fix for VFPA provided by Doug Hennig; VAL() fix provided by starfiresg1
        FOR EACH loFile IN loFolder
            loShell.NameSpace(tcZipFile).MoveHere(loFile, FOF_SILENT+FOF_NOCONFIRMATION+FOF_NOERRORUI)
            apiSleep(100)
        ENDFOR
    ELSE
        FOR EACH loFile IN loFolder
            lnCountBefore = loShell.NameSpace(tcTempPath).Items.Count
            loShell.NameSpace(tcZipFile).MoveHere(loFile, FOF_SILENT+FOF_NOCONFIRMATION+FOF_NOERRORUI)
            DO WHILE lnCountBefore = loShell.NameSpace(tcTempPath).Items.Count
                apiSleep(50)
            ENDDO
        ENDFOR
    ENDIFClick to expand...Thank you for your reply. I'll study this code and see if I can make it work.Daniel"
Reply,64 bit replacement needed for Dynazip,Grandchoir,"Jan 9, 2025 at 11:13 PM",https://www.tek-tips.com/threads/64-bit-replacement-needed-for-dynazip.1832713/,Chris Miller,"Do you use DynaZip AX (the ActiveX component)? Then you actually don't need a replacement. When using OLE classes you instanciate anything in a new process anyway, no matter if it's an OCX, DLL or EXE, as it usually is foreign language code anyway you start a new runtime process for an ActiveX component.If not, you could also continue using Dynazip by creating your own 32bit COM Server to use with VFPA, either in VFP9 or VFPA 32Bit. This can be your streting point for that, in a 32bit VFP Project:Code:Define Class Zip as Custom OlePublic
   Procedure Zip(tcDirectory)
      * Your code zipping a directory with DynaZip
   EndProc
 
   Procedure Unzip(tcZipFile, tcTargetDirectory)
      * Your code unzipping a zip file with DynaZip
   EndProc
EndDefineIf you call the project Dyna.pjx and build (EXE or DLL, doesn't matter much) your VFP COM Server will be called ""Dyna.ZIP"".Otherwise I second Griffs recommendation of BandiZip, though I have not used it. From the product description I see it offers everything you could use with DynaZip, including AES encryption, multiple archive formats support, file spanning, etc.If you merely zip up some files so you can mail them and the end user of that ZIP does use whatever ZIP software to unzip it, the usage of the shell.application for that is completely sufficient. The only downside and some exotic problem cases you can find here on tek-tips is about progress of the zipping and too early trying to use the not yet completely written ZIP file, you have to understand using shell.application by createobject (OLE/COM automation) is making that a parallel process, which means this works in parallel. The code sample of ggreen does refrain from making much use of that, it merely waits with Sleep until the zipping or unzipping finihes with each single file. At these stages of the code you could also report progress, by the way, at least on which number of file you're working on."
Question,VFP mailmerge error: Unable to Open Datasource,Jay9988,"Jan 13, 2025 at 6:56 AM",https://www.tek-tips.com/threads/vfp-mailmerge-error-unable-to-open-datasource.1832733/,Jay9988,"Hi all,I have VFP Application to launch Word mailmerge window, and I used mailmrge.vcx classthe code is belowCode:WITH THISFORM._mailmerge
       .cAppTitle = ""Kontrak Sewa""    && application name, used in Alerts  
       .nWordProc = 1                    && word processor (1 = Word 6+; 2 = CommaDelim; or user-defined (see below); default = 1)
       .nNewDoc = 2                    && is it a new doc (1 = new, 2 = existing; default = 1)
       .cdocname=mdrive+mfile
       .nTemplate = 1                    && type of main document (Word only, 1 = form letter; 2 = label; 3 = envelope; 4 = catalog; default = 1)
       .cAlias = ALIAS()                && alias of source table or view
        ACOPY(aflds, .aAutoFields)        && fill in array of field names to be used
       .MakeOutput()                    && do the merge
      ENDWITHWhen the application run on computer with Office 2021 installed, causing error: ""Unable to open datasource"". I have installed VFP OLE DB driver.I think maybe the vcx is not compatible with office 2021, because the application is running well with Office 2019 or below.Is the anyway I could fix this?and also, with the code above, the datasource is an alias (opened table). How could I modify the code if I want the free table (dbf file) to be the datasource?Many thanks"
Question,Problem with printed image,Scott24x7,"Jan 6, 2025 at 10:04 AM",https://www.tek-tips.com/threads/problem-with-printed-image.1832660/,Scott24x7,"Hi all,I've run into a weird issue with an image on a form.In the report form the image looks like this:But when the form is output to either a PDF or a printed file, it looks like this:The globe shaped logo looks TERRIBLE.  I've tried making different sizes for the logo, different print densities, they all end up looking terrible when output.Does anyone know why, and does anyone know a way to fix it?"
Reply,Problem with printed image,Scott24x7,"Jan 6, 2025 at 10:04 AM",https://www.tek-tips.com/threads/problem-with-printed-image.1832660/,mjcmkrsr,"Hi,It might be related with the file format *.BMP or *.JPG or ... and also how you store the pictures BLOB/MEMO.Please find some demo code attachedhthMarK"
Reply,Problem with printed image,Scott24x7,"Jan 6, 2025 at 10:04 AM",https://www.tek-tips.com/threads/problem-with-printed-image.1832660/,Scott24x7,"Thanks Mark.The image is fixed on the form in an image control, so is a file stored directly on disk.  It's not stored in a memo or a BLOB general field.It is a .jpg though.  I'll try using something else like .PNG or .TIF and see if that fixes it."
Reply,Problem with printed image,Scott24x7,"Jan 6, 2025 at 10:04 AM",https://www.tek-tips.com/threads/problem-with-printed-image.1832660/,Chris Miller,"Scott24x7 said:But when the form is output to either a PDF or a printed file...Click to expand...1. What other ""printed file"" do you mean? XPS?2. Whats the dpi of the original image file, the dpi of your display and the dpi of the output file (PDF/other)3. What about zooming in when finally displaying the PDF/other file?For best results you either have all dpis matching and therefore finally have 1:1 the same image resolution and size as when viewing the image 1:1 or you have vector graphic formats, like SVG. I'm not even sure it's documented what image formats can be printed with an OLE Control, as you don't use the image control in an FRX, for which formats are documented as mainly BMP, GIF, JPG, PNG but also still EMF, WMF and TIFF, where TIFF also is only an image container format with the actual image being GIF or BMP, I think. (I withhold talking about ICO or CUR formats, but they surely don't fit the need of printing a logo)The best you can do is preprocess the image so the dpi fits especially the final file dpi, you may configure that and regarding PDF a PDF printer driver or converter should allow to configure the PDF dpi, too and even more important, whether and what compression and quality is used for images."
Reply,Problem with printed image,Scott24x7,"Jan 6, 2025 at 10:04 AM",https://www.tek-tips.com/threads/problem-with-printed-image.1832660/,Scott24x7,"Hi Mark and Chris,So, I did have the DPI matching across as you mentioned.  However, I was using a .PNG with transparent background.  When I changed that to a .jpg with a white background, the result improved.  I made a couple further modifications because the image control seemed to think the image was larger than it was (the size was 66 x 66 pixels, with 0 border, so it was oddly clipping about 4 pixels on right and bottom with the control set to ""clip"", and if it was set to resize of either option, it didn't look right.  I padded the image out by adding 6 pixels all around it increasing the size to 78, and now it looks reasonably better.  Still not quite as sharp on the form, but much much better.I had been trying to fix this through the control, and by resizing the .PNG, it hadn't occurred to me that the transparent background would be the main culprit.Thanks heaps."
Reply,Problem with printed image,Scott24x7,"Jan 6, 2025 at 10:04 AM",https://www.tek-tips.com/threads/problem-with-printed-image.1832660/,tomk3,"if you do EBV , TOPAZ has tools to upscale a photo with impressive results which may give better printouts"
Reply,Problem with printed image,Scott24x7,"Jan 6, 2025 at 10:04 AM",https://www.tek-tips.com/threads/problem-with-printed-image.1832660/,Chris Miller,"The two posted images are jpg, can you add the original png zipped in an attachment? I'd be interested to see how this comes out. I remember VFP9 without SP a) introduced the ability to work with PNG (might also be VFP8, not 100% sure) but b) PNG alpha channel had issues at least on forms and those were fixed with VFP9 SP1.So there is a possibility this PNG issue still has a bug within reporting.Since on paper white means transparent (no ink, no toner, etc) it becomes unnecessary to have apha channels (transparency) in any image, unless it overlaps with another image and then I'd always prefer JPG as the older format, even though for logos PNG promises better quality with grahpical images as logos are.Anyay, I'd like to see whether I can reproduce this and find out what's messed up."
Reply,Problem with printed image,Scott24x7,"Jan 6, 2025 at 10:04 AM",https://www.tek-tips.com/threads/problem-with-printed-image.1832660/,Scott24x7,"tomk3 it has nothing to do with scale.  I have the original image at a quality of 3000 x 3000 in EPS, entirely uncompressed.  All of the smaller images are created by reducing it to whatever pixel size.  The point is, the original image looks fine in the designer, but when sent to PDF, it was horrendously distorted.  As I mentioned, this was mostly resolved (to a level that I care about) by changing it (the same image) from a PNG to a JPG (just a resave in Photoshop, no other alteration).  The PNG however was transparent background (as the original), and the JPG of course makes that background white.No other changes were made."
Reply,Problem with printed image,Scott24x7,"Jan 6, 2025 at 10:04 AM",https://www.tek-tips.com/threads/problem-with-printed-image.1832660/,Scott24x7,"Hi Chris, I kind of misspoke when I wrote the original reply regarding ""But when the form is output to either a PDF or a printed file, it looks like this:"" what I meant by ""or a printed file"", is I mean printed to a printer.  I didn't try to output it to XPS, that might have been an interesting experiment.I can go back and try it if I get time."
Reply,Problem with printed image,Scott24x7,"Jan 6, 2025 at 10:04 AM",https://www.tek-tips.com/threads/problem-with-printed-image.1832660/,Chris Miller,"Yes, it all seems to depend on hat PNG Photoshop creates, that VFP does not fully support somehow.As EPS is a vector format, you needed to convert it to PNG or JPG first, perhaps it would have given better results even as PNG when keeping the large pixel resolution.I read about the EPS format and saw a question on Stack Exchnage why it requires a ppi/dpi specification hereas SVG, another vector graphics format, does not. It does make sense to be able to rassterize it, printers, even those driven by postscript (and EPS is encapsulated postscript) will print rasterized images only. A ppi/dpi resolution won't tell the size , that's then given by the actual physical dimensions of the paper and the area within the printable area in a report, or by a resolution as you say it's 3000x3000 in your case. It's all dynamically changable anyway, if an image with a legacy density of 96dpi is displayed on screen, 96 pixels will be 1 inch on a display with 96 dpi resolution, that's right, but when you design a report, VFP or not, the size of what you design there will determine the physical size in inches (or cm/mm, whatever) anyway, and then everything needs to scale anyway and becomes overridden anyway, therefore.If you rasterize it's making it harder to resize and then you can get artifacts as your second image shows. It would really be nice if VFP reports would support a vector graphics format, I think there may be a way to embed EPS with some OLE class that would actually forward that 1:1 to a postscript capable printer (driver) and otherwise make it a jpb for the printer driver to resterize it from the original vector format. You would get best results that way. I don't know such a control, but that would perhaps be worth looking for, even only to get a better PDF result.In a way a font is a vector graphics format, too. In small font sizes rasterized characters are used, but for larger font sizes a font outline is defined in so called splines, sort of mathematical curves, that's why you also don't see any artifacts in any font size. But this kind of vectors (splines) are insufficient to handle any vector graphics, it's a limited format specifically adjusted for font design."
Reply,Problem with printed image,Scott24x7,"Jan 6, 2025 at 10:04 AM",https://www.tek-tips.com/threads/problem-with-printed-image.1832660/,Scott24x7,"Chris,That's an interesting point.  I might remake a .png without transparent background essentially not having multi-layers and see how that looks on the output.Like I mentioned, the .JPG was a vast improvement (at least it was fundamentally ""round"" and not ""fuzzy"") and see if that turns out any better.  I did try the image at both 300dpi and 72dpi (old photoshop default) but the result was the same in both cases with the transparent .png."
Question,Simple VFP App to reimplement in Android... anyone got any advice...,GriffMG,"Jan 6, 2025 at 3:25 PM",https://www.tek-tips.com/threads/simple-vfp-app-to-reimplement-in-android-anyone-got-any-advice.1832667/,GriffMG,"I don't develop much new stuff these days, but I have thrown together a simple app to help myself exercise my hand after a recent procedure.One form, two buttons and a few labels... thinking it would be a really good first app for Android.I think I need some kind of on-line course in Android Studio or somesuch - has anyone gone in this direction, any advice?"
Reply,Simple VFP App to reimplement in Android... anyone got any advice...,GriffMG,"Jan 6, 2025 at 3:25 PM",https://www.tek-tips.com/threads/simple-vfp-app-to-reimplement-in-android-anyone-got-any-advice.1832667/,Doug Lindauer,This is what I did.  My local community college has a lot courses in the computer area and I took 3 on developing in Java and Android.  One of the projects I ported over to VFP was a blackjack simulation (the card game of blackjack.)
Reply,Simple VFP App to reimplement in Android... anyone got any advice...,GriffMG,"Jan 6, 2025 at 3:25 PM",https://www.tek-tips.com/threads/simple-vfp-app-to-reimplement-in-android-anyone-got-any-advice.1832667/,GriffMG,Impressive
Reply,Simple VFP App to reimplement in Android... anyone got any advice...,GriffMG,"Jan 6, 2025 at 3:25 PM",https://www.tek-tips.com/threads/simple-vfp-app-to-reimplement-in-android-anyone-got-any-advice.1832667/,trial03,"Dear Doug LindDoug Lindauer said:This is what I did.  My local community college has a lot courses in the computer area and I took 3 on developing in Java and Android.  One of the projects I ported over to VFP was a blackjack simulation (the card game of blackjack.)Click to expand...Could share how to do it>Very impressive.Thanks and regards,"
Reply,Simple VFP App to reimplement in Android... anyone got any advice...,GriffMG,"Jan 6, 2025 at 3:25 PM",https://www.tek-tips.com/threads/simple-vfp-app-to-reimplement-in-android-anyone-got-any-advice.1832667/,trial03,"GriffMG said:I don't develop much new stuff these days, but I have thrown together a simple app to help myself exercise my hand after a recent procedure.One form, two buttons and a few labels... thinking it would be a really good first app for Android.I think I need some kind of on-line course in Android Studio or somesuch - has anyone gone in this direction, any advice?Click to expand...Could VFP exe run in Android?  very well done, hope can learn more from you.Thanks and regards,"
Reply,Simple VFP App to reimplement in Android... anyone got any advice...,GriffMG,"Jan 6, 2025 at 3:25 PM",https://www.tek-tips.com/threads/simple-vfp-app-to-reimplement-in-android-anyone-got-any-advice.1832667/,Mike Lewis,"Good luck with this idea, Griff. I've occasionally considered doing something similar myself - more as an intellectual exercise than to meet a need. I would guess that the first step might be to get to know Java.Let us know how you get on.Mike"
Reply,Simple VFP App to reimplement in Android... anyone got any advice...,GriffMG,"Jan 6, 2025 at 3:25 PM",https://www.tek-tips.com/threads/simple-vfp-app-to-reimplement-in-android-anyone-got-any-advice.1832667/,GriffMG,"@trial03The app is in VFP just now, not trying to run that on Android, was thinking it's simplicity would make a good target for rewritingin something for Android. A little math, a little timer and some text - wrapped around a case statement.@MikePretty sure I can handle the coding, what ever the language, but that Android studio looks like it needs to be introduced nicelynot my usual dive in and see what happens"
Reply,Simple VFP App to reimplement in Android... anyone got any advice...,GriffMG,"Jan 6, 2025 at 3:25 PM",https://www.tek-tips.com/threads/simple-vfp-app-to-reimplement-in-android-anyone-got-any-advice.1832667/,GriffMG,"If anyone is interested, the language, well environment, is Kotlin... looks like an ok thing, has strings and bools and all that.Gone initially for a google course, the text is good but the videos are H O R R I B L E, too much yeah haaa! for me.The text is ok, but there are things that should work, but don't - then you work them out and hey presto, they are covered in thenext 'episode'... so to boil and egg, put in the pan with water and turn up the heat... ep 2 the pan needs to be a metal thing, held the rightway up and you shouldn't fill it or it will overflow...."
Reply,Simple VFP App to reimplement in Android... anyone got any advice...,GriffMG,"Jan 6, 2025 at 3:25 PM",https://www.tek-tips.com/threads/simple-vfp-app-to-reimplement-in-android-anyone-got-any-advice.1832667/,Chris Miller,"Kotlin is the platform for native app development (on Android). It's a ood idea to go there, as the app quality of native development is always clearly better than using some cross plattform approach, but looking for that I still see Xamarin, for example.Seehttps://medium.com/@hardikthakker/best-mobile-app-development-platforms-in-2025-ae2127ef180aIt has a (too small) table ""Comparing Platforms at a Glance"" that's giving some pros and cons for the development platforms. You have to know (or read in more detail) Swift is the typical native platform for Apple apps development and Kotlin for Android apps. All other are cross plattform, so target both mobile types.Though you want to develop apps as a developer and not use a tool for a non-developer audience, I'd look into one no-code platform by Google: AppSheet. The no code aspect of AppSheet is not the only way to use it. It has a dependency on Google Cloud and therefore also on pricing of Google Cloud usage. I played with this a bit, more Apps Script to automate things in Google Workspace (i.e. GMail, Drive, Docs, etc.) and found it simple and powerful enough, it's main base programming wise is JavaScript with a framework of classes for the Google Workspace universe. So it's obviouosly less interesting, if your app idea has nothing to do with that, but indeed you can make use of a Google Sheet (Excel equivalent) as a simple database, just like Excel can be used for small datasets. The overall feel of that is like progamming VBA, just not with Basic but JavaScript. JS is just a small brother of Java with a very annoying nature, but you might have come across it before in web related projects, just like HTML/CSS and then it helps making the learning curve less steep.And if you feel neither that's a thing and also come to the conclusion Kotlin (Java similar)  is not your cup of tea, there's also still MS Xamarin, I think that can use any .NET language You know what they say: C# is just Java in with other wording, VB.NET is almsot exactly C# with other wording, but it makes it closer to VFP OOP programming than C# or Java. Soo take aside it's also targeting iOS and it limits your usage of all native functionalities, it's perhaps easier to get into."
Question,Newbie Report Designer Question: Changing Report Label content based on Checkbox Value in table,crashmaster18,"Jan 7, 2025 at 1:32 PM",https://www.tek-tips.com/threads/newbie-report-designer-question-changing-report-label-content-based-on-checkbox-value-in-table.1832682/,crashmaster18,"I could use a little bit of guidance here.I have an existing VFP 5 Report that contains a Report Expression field that I would like to change the content of to an alternative label based on the T/F value of a field in my user's dbf. I've seen a lot of documentation, but have had very little success with my hacking on this; I am missing something very obvious I'm certain.As a potential alternative, I've created a new report with the alternative label already nicely set, and it works fine, so if I could figure out how to launch the alt-label-report.frx from within Report Designer after the first report runs, that would also be acceptable to my user even without paying attention to the checkbox field value (as they will print this second report roughly 85% of the time anyway, and they will always need the second report if that checkbox value is T).Thoughts?Note: I am limited to editing the existing report or linking the existing report to a new report after printing as I do not have the ability to edit the actual VFP screens (source missing/incomplete)."
Reply,Newbie Report Designer Question: Changing Report Label content based on Checkbox Value in table,crashmaster18,"Jan 7, 2025 at 1:32 PM",https://www.tek-tips.com/threads/newbie-report-designer-question-changing-report-label-content-based-on-checkbox-value-in-table.1832682/,GriffMG,"Don't use a label, use a text control and bind it to =iif(table.chkbox,""Yeah"",""Nawh"")"
Reply,Newbie Report Designer Question: Changing Report Label content based on Checkbox Value in table,crashmaster18,"Jan 7, 2025 at 1:32 PM",https://www.tek-tips.com/threads/newbie-report-designer-question-changing-report-label-content-based-on-checkbox-value-in-table.1832682/,crashmaster18,"Hi Griff,Thank you for replying! I suppose I should clarify something;So my existing Report Expression for the Report area in question is very simple;Code:table1.memofield1Based on your guidance, would I tweak this Expression to be something like this for an expression instead?Code:=iif(table1.chkbox,table1.memofield1,""Nawh"")If not, just so I'm understanding your potential solution here, if Report Designer can't substitute Text for a field like I propose above, then your guidance would be to change it so it's not pulling the memo field at all."
Reply,Newbie Report Designer Question: Changing Report Label content based on Checkbox Value in table,crashmaster18,"Jan 7, 2025 at 1:32 PM",https://www.tek-tips.com/threads/newbie-report-designer-question-changing-report-label-content-based-on-checkbox-value-in-table.1832682/,ggreen61,"You can use Griff's suggestion, or you can create two different labels (one overlapping the other).  Set the Print When for each label to the field value in the table.  If this field is a boolean, then one label's Print When would be ""my.tablechkbox"" and the other label's Print When would be ""!my.tablechkbox""."
Reply,Newbie Report Designer Question: Changing Report Label content based on Checkbox Value in table,crashmaster18,"Jan 7, 2025 at 1:32 PM",https://www.tek-tips.com/threads/newbie-report-designer-question-changing-report-label-content-based-on-checkbox-value-in-table.1832682/,crashmaster18,"ggreen61 said:You can use Griff's suggestion, or you can create two different labels (one overlapping the other).  Set the Print When for each label to the field value in the table.  If this field is a boolean, then one label's Print When would be ""my.tablechkbox"" and the other label's Print When would be ""!my.tablechkbox"".Click to expand...Thank you, I will try this as well and I'll report back."
Reply,Newbie Report Designer Question: Changing Report Label content based on Checkbox Value in table,crashmaster18,"Jan 7, 2025 at 1:32 PM",https://www.tek-tips.com/threads/newbie-report-designer-question-changing-report-label-content-based-on-checkbox-value-in-table.1832682/,GriffMG,"I use both methods, depending on the difference in length between the two labels, when they are both small, and similar in size, it can be harder to 'debug' laterbecause one will be over the other - if one is much longer it is easy to spot"
Reply,Newbie Report Designer Question: Changing Report Label content based on Checkbox Value in table,crashmaster18,"Jan 7, 2025 at 1:32 PM",https://www.tek-tips.com/threads/newbie-report-designer-question-changing-report-label-content-based-on-checkbox-value-in-table.1832682/,Chris Miller,"You've got good advice of which I'd prefer the IIF expression, if the alternative label can be in the same font as the usually printed data in that place, it doesn't need to be a label. All in all that's just a reminder that a report field expression can not only be a single field name.The thing to add is perhaps, that if am EXE has included FRXes, they will always be prioritized over external FRX/FRT report files. If you have such external report files the likelyhood is in favor of you, that they are external to be adjustable without needing too rebuild the EXE for most changes.You'll see if you try the suggested changes to achieve your goal. If they all don't succeed the simplest thing to try and assure your changes are effective is to just add a label with a fixed text, data independent, and see whether that's printed. If not, that's a sure sign instead a report internal to the EXE is printed. The question then becomes why there is an external report, but that may just be a version history relict. Anyway, good luck in getting the necessary change to work."
Question,VFP Issue with date selection 1/1/25 returns 1/1/1925,coorsman,"Jan 3, 2025 at 8:54 PM",https://www.tek-tips.com/threads/vfp-issue-with-date-selection-1-1-25-returns-1-1-1925.1832647/,coorsman,"Hi All,We have some old programs written in VFP 9.0 SP2 and when a date > 12/31/24, say 01/01/2025 in the date dialog screen the program is returning an error can't find date 1/1/1925.I saw posts about adding a century settings in windows with no results.Any ideas would be greatly appreciated,Thanks,coorsman!"
Reply,VFP Issue with date selection 1/1/25 returns 1/1/1925,coorsman,"Jan 3, 2025 at 8:54 PM",https://www.tek-tips.com/threads/vfp-issue-with-date-selection-1-1-25-returns-1-1-1925.1832647/,GTGeek88,"One thing to check is the SET ROLLOVER setting. If you have the source and can recompile, you can change that to something higher. You might be able to change it via a CONFIG.FPW file, if the program does not then override it."
Reply,VFP Issue with date selection 1/1/25 returns 1/1/1925,coorsman,"Jan 3, 2025 at 8:54 PM",https://www.tek-tips.com/threads/vfp-issue-with-date-selection-1-1-25-returns-1-1-1925.1832647/,GriffMG,Set CENTURY may also be significant
Reply,VFP Issue with date selection 1/1/25 returns 1/1/1925,coorsman,"Jan 3, 2025 at 8:54 PM",https://www.tek-tips.com/threads/vfp-issue-with-date-selection-1-1-25-returns-1-1-1925.1832647/,BugZap13,Century rollover docu
Reply,VFP Issue with date selection 1/1/25 returns 1/1/1925,coorsman,"Jan 3, 2025 at 8:54 PM",https://www.tek-tips.com/threads/vfp-issue-with-date-selection-1-1-25-returns-1-1-1925.1832647/,Chris Miller,"For cases of short dates I have programmed a ROLLOVER setting that rolls with the time, i.e. to YEAR(DATE())%100+/-offset. But for sake of no problems with dates, SET CENTURY ON and don't work with short dates, it's just stupid since we had the Y2K problem that should be in any programmers mind to not spare 2 digits here."
Reply,VFP Issue with date selection 1/1/25 returns 1/1/1925,coorsman,"Jan 3, 2025 at 8:54 PM",https://www.tek-tips.com/threads/vfp-issue-with-date-selection-1-1-25-returns-1-1-1925.1832647/,Mike Lewis,"Just to be clear, the correct syntax is:Code:SET CENTURY TO c ROLLOVER ywhere c is the century and y is the rollover year.This only applies for dates that are entered with a two-digit year. The command takes precedence over SET CENTURY ON/OFF.Mike"
Reply,VFP Issue with date selection 1/1/25 returns 1/1/1925,coorsman,"Jan 3, 2025 at 8:54 PM",https://www.tek-tips.com/threads/vfp-issue-with-date-selection-1-1-25-returns-1-1-1925.1832647/,mjcmkrsr,"Hi,You may also want to check your windows settings - see below (W10 Pro) - and/or in VFP the SET SYSFORMATS commandhthMarK"
Reply,VFP Issue with date selection 1/1/25 returns 1/1/1925,coorsman,"Jan 3, 2025 at 8:54 PM",https://www.tek-tips.com/threads/vfp-issue-with-date-selection-1-1-25-returns-1-1-1925.1832647/,Chris Miller,"Mike, the precendence is not hindering you to first assign a ROLLOVER and then SET CENTURY ON. If you then convert short date strings, the rollover year is still in effect, i.e. SET CENTURY ON does not reset the rollover year. What offfset you need depends on what dates you can enter. Birth dates, for example should always be past dates, except perhaps for predicted date of birth within 9 months from now. Well, but any planning dates, appointments, etc are of course usually future dates. Therefore the offset you set depends on your needs, but you can set it, even when you decide to finally SET CENTURY ON. SET(""CENTURY"",2) will also still show you the rollover year as one proof of it not being reset to default or inactivated.For demonstration purposes:Code:Set Date American
Set Century To 19 Rollover 75
Set Century On
? Set(""Century"",2)
? Ctod(""01/01/25"")
? Ctod(""01/01/75"")
? Ctod(""01/01/90"")
Set Century To 19 Rollover 90
Set Century On
? Set(""Century"",2)
? Ctod(""01/01/25"")
? Ctod(""01/01/75"")
? Ctod(""01/01/90"")The rollover century and years are still in full effect, even if you set CENTURY ON after setting the rollover mechanism. That's what makes the precedence unimportant.The problem of 25 being interpreted as 1925 instead of 2025 seems to me a fixed setting of the Rollover century and year that was okay at the time it was established, but wasn't introduced in a danmically way adapting to the current year, as you surely want a current year short date to convert to the current century.While I recommend SET CENTURY ON, you still can have a ROLLOVER year (and century) defined so your short date string conversion (for data entry works, for CSV import, etc). Ultimately, avoid any short dates, anyway. While you have a way to nudge them to the right century when knowing whether they should be past, future or current year, it's not giving you a chance with historical dates more than 100 years ago or future dates more than 100 years into the future. While you don't plan 100 years into the future, usually, there are people older than 100 years and the number of them grows. History also doesn't shorten ever, so for documentation purposes you want to be able to specify all dates of the past. and also display the century to know what dates we talk about in case of a year like 92, whether it's 1992 or 1892 or even 1492.I'm not sure SET SYSFORMATS ON ""imports"" the Windows setting into VFPs Rollover concept. Worth a try to have influence from outside, it won't help, if what I assume is causing the problem, a fixed setting somewhere in the code, in the worst case, unconfigurable and not able to be influenced by neither Windows ssettings nor config.fpw or other configuration data, INIs etc. So you can try and get lucky, if that helps, it's worth doing, considering how little effort it is, but in the end you might need hands on the source code to fix this."
Reply,VFP Issue with date selection 1/1/25 returns 1/1/1925,coorsman,"Jan 3, 2025 at 8:54 PM",https://www.tek-tips.com/threads/vfp-issue-with-date-selection-1-1-25-returns-1-1-1925.1832647/,Gary Sutherland,Foxpro has always had problems with ambiguous dates. I use SET DATE BRITISH to force dd/mm/yyyy display format.
Reply,VFP Issue with date selection 1/1/25 returns 1/1/1925,coorsman,"Jan 3, 2025 at 8:54 PM",https://www.tek-tips.com/threads/vfp-issue-with-date-selection-1-1-25-returns-1-1-1925.1832647/,Chris Miller,"Gary Sutherland said:Foxpro has always had problems with ambiguous dates.Click to expand...Not only Foxpro. A short date simply is ambiguous, there's no hidden compressed side information about the century. It only seems logic a 25 date in the year 20205 should be interpreted as 2025.That's not automatic, when you know how the rollover mechanism works. It's still easy to use the rollover mechanism in a danymioc way that lways will turn the current year to be in the current century. From that perspective VFP has an instrument to deal with the ambiguity, you just have to know it and you might expect other programming languages or applications dealing better with this, automatically. I think you can easily find examples of other software always expecting 19 as the century until the year 2000 came along and reuired a software update. Ultimately the problem is best solved by including the century and avoiding short dates overall.Whether it's Britiish, American or anything else also doesn't fix the century part of the problem. And you can set the order to British using SET DATE TO DMY. Besides, the Vritish setting is completely separate to century on or off. Neither British, American or other countries set the year to be 4 digits, only the CENTURY setting does. See for yourself:Code:Set Century Off
Set Date BRITISH
? Date()What you state BRITISH is solving is both the date part ordering and the century. It's not, the only other thing besides the DMY order it sets is the separator being the slash, but it neither effects the CENTURY nor the HOURS of the day 24 vs AM/PM. All the country names map to one of DMY or MDY, as no country does YMD or something lilke that, as far as I know. If you think that makes all settings in one go, you have false assumptions."
Reply,VFP Issue with date selection 1/1/25 returns 1/1/1925,coorsman,"Jan 3, 2025 at 8:54 PM",https://www.tek-tips.com/threads/vfp-issue-with-date-selection-1-1-25-returns-1-1-1925.1832647/,mjcmkrsr,"HiChrissI'm not sure SET SYSFORMATS ON ""imports"" the Windows setting into VFPs Rollover concept.Click to expand...Yes it does. But it has some other gotchasFrom Hacker's Guide 7Help states that when SYSFORMATS is set on, you can use the following SET commands to override the Windows settings: SET CENTURY, SET CURRENCY, SET DATE , SET DECIMALS, SET HOURS, SET MARK TO, SET POINT, and SET SEPARATOR. Well, most work as you'd expect: After you SET SYSFORMATS ON, if you issue a SET command to override a setting, the data displays with the overridden format and the corresponding SET() function returns the overridden value (the one you just set it to). Not so with SET CENTURY and SET MARK. They properly pick up the Windows settings when SYSFORMAT is set ON. However, issuing a SET CENTURY or SET MARK does not override the formatting in SYSFORMATS, but the SYS() function returns a value that claims it does.But it's very challenging to work in a system where you cannot determine the current settings. Generic date-parsing routines will have to be revised to more carefully manipulate the date setting, not to depend on switching and restoring SET DATE. (Hint: If the setting of SYSFORMATS is ON and the DATE is SET to SHORT, you need to preserve and restore SET MARK TO and/or turn on and off SYSFORMATS to parse the date.) Routines to automatically size a text box to fit the date cannot depend on SET(""CENTURY""). A routine that sets data session-scoped commands (as all of these are) to the default data session settings cannot always determine what these commands are set to. This command is a good idea; we'll be pleased when CENTURY and MARK are as functional as the rest.ExampleSET SYSFORMATS ON* In the Control Panel, set the short date to 'M/d/yy'SET CENTURY ON? SET(""CENTURY"")  && ""ON""? DATE()  && Yields a date in MM/DD/YY format.Click to expand...hthMarK"
Reply,VFP Issue with date selection 1/1/25 returns 1/1/1925,coorsman,"Jan 3, 2025 at 8:54 PM",https://www.tek-tips.com/threads/vfp-issue-with-date-selection-1-1-25-returns-1-1-1925.1832647/,Chris Miller,"I have to check that. What I know is that SET SYSFORMAT is copying several Windows settings into FoxPro settings, at the point you issue SET SYSFORMATS ON. Afterwards settings can be overridden.Let me check this...You're right that SET MARK doesn't work, but when you additionally  SET DATE <<Country>> the MARK setting is overridden, too. It doesn't suffice to do one of them, it doesn't matter in which order you SET MARK and SET DATE <<Country>>, as long as you have matching settings, ie the MARK is really the character used in the country, after both are done the mark is according to the country setting.But it's also true that not only MARK can't be overriden, it's not the only exception. When changing the digit grouping character from . to , or ' that reflects in VFP immediately. I assume this is a change that happened with Windows 10 or 8 perhaps. Quite sure it wasn't that way in Vista. For now it seems when you SET SYSFORMATS ON you mostly subscribe to what the system setting is, even when it changes afterwards.You can still get the old behavior or the behavior I know, if you SET SYSFORMATS ON and then OFF right after that. The settings are then still system settings and OFF doesn't revert them back to what you had before ON, but you can override any setting as you want to override it from system defaults, which might be necessary for things like CSV imports to work.Still the original problem was about the century, not the order of month and day and not about the MARK setting. It's still interesting and I learned something from that. It's weird to me, but the way it is both simple models of SYSFORMATS switching beteween VFP internal and system settings or only copying them at the point of ON are wrong, obvioulsy. I suggest you experiment with this, as it's not as simple to give sample code without knwing your Windows settings and even harder to set them with Windows API or WMI to show the effects.I conclude that I will recommend the pattern to SET SYSFORMATS ON and then OFF again as a default to have the best of both worlds, i.e. let the user configure certain settings as they like or need them in Windows and accpt them, but also staying in control as necessary to do correct data imports, for example, after which you can also go back to Window settings, so they play the major role, still. It's not at all known how that's done in coorsman application, when 25 is converted to 1925, I assume that the developer only once thought about a rollover setting working at the time of establishing it and not caring about how this will break in 2025."
Reply,VFP Issue with date selection 1/1/25 returns 1/1/1925,coorsman,"Jan 3, 2025 at 8:54 PM",https://www.tek-tips.com/threads/vfp-issue-with-date-selection-1-1-25-returns-1-1-1925.1832647/,mjcmkrsr,"HiChrissIt's not at all known how that's done in coorsman application, when 25 is converted to 1925, I assume that the developer only once thought about a rollover setting working at the time of establishing it and not caring about how this will break in 2025.Click to expand...Maybe Coosmann could give us some hints or at least tell us if and how he solved the problemMarK"
Reply,VFP Issue with date selection 1/1/25 returns 1/1/1925,coorsman,"Jan 3, 2025 at 8:54 PM",https://www.tek-tips.com/threads/vfp-issue-with-date-selection-1-1-25-returns-1-1-1925.1832647/,coorsman,"Hi Everyone,I was reaching out for some assistance. Unfortunately, it's still not functioning correctly, and I'm not the original programmer for this system. The software, developed over 20 years ago, has multiple versions deployed and customized at different sites. Although I have all the original code and VFP program installed and running, my knowledge of VFP is limited.Over the past few years, I've been transitioning most sites and new installations to .NET. I was hoping there might be an easy setting adjustment within Windows that could resolve this issue, as re-compiling all the programs isn't feasible at this point. I have most of the modules re-written in .NET except for some custom sites, but it seems we've finally been bitten by this millennial bug.If anyone has any other suggestions or ideas, I'm open to trying them.Thank you for your help.TIA,KB - coorsman."
Reply,VFP Issue with date selection 1/1/25 returns 1/1/1925,coorsman,"Jan 3, 2025 at 8:54 PM",https://www.tek-tips.com/threads/vfp-issue-with-date-selection-1-1-25-returns-1-1-1925.1832647/,Tore Bleken,"You have already been presented with the right answer. And may I say, theonlypractical solution.You need to add one or two lines. Both lines involve Set Century. More details athttps://www.vfphelp.com/vfp9/_5wn12pevx.htmIf you need personal help, email me at <firstname>@<lastname>.no"
Reply,VFP Issue with date selection 1/1/25 returns 1/1/1925,coorsman,"Jan 3, 2025 at 8:54 PM",https://www.tek-tips.com/threads/vfp-issue-with-date-selection-1-1-25-returns-1-1-1925.1832647/,Chris Miller,"If you have the source code and VFP available, you can use the IDE tool of a project search, namely the menu item ""Code References"" in the Tools menu of VFP, to search for ROLLOVER in the whole project. If I assume correct you will find a setting that stops working this year, unfortunately, and could only solve that by recompilation. You might be able to find the code in the binary EXE and change it there, too, when we'd be able to tell you to which byte values SET CENTURY...ROLLOVER compiles to, I think that could be a solution, but before guessing it exists at all, it would be best to find it and know the ""exact wording"" used in the code.If you already tried the advice given regarding Windows settings, it seems the software does never SET SYSFORMATS ON and so you could have no influence from outside, there's no way to enforce that. So the only alternative to Windows settings becomes a (hopefully documented) configuration availble by INI files or config data of any kind, The VFP typical config.fpw is not the only configuation that can be programmed, i.e. the developer is free to implement any mechanism from registry values over ini files, xml, whatever as they are all standards in themselves. A config.fpw could only be uesd to configure some VFP environment settings, of which the rollover year is none, so it won't help you to introduce it.The vfp EXE might react to a config.fpw file you create in the same directory as the EXE and you could try it with the only line in it being SYSFORMATS=ON and then retry influencing the application with Windows settings. I'm not even sure SYSFORMATS is an item usable in the config.fpw."
Question,settings in config.fpw,EinTerraner,"Dec 18, 2024 at 7:59 PM",https://www.tek-tips.com/threads/settings-in-config-fpw.1832550/,EinTerraner,"How can i set a different filename for the ""_command.prg"" like i can do it with the ressourcefile shown below.the ressource i can set in the config.fpw withCode:_include = .\@defines.h
Default = .\
screen=on
toolbars=on
TOOLTIP = 1
sysformats = on
title = VisualFoxPro    F V N 2 4
progwork = .\
resource = c:\$dev\temps\FVN24.dbf
path = .\;..\@lib21;..\@com;..\@com\ICON;.\FORMS;.\CLASS;.\FVLIB
command = _screen.WindowState = 2and 2nd question: Sometimes Fox forget the last docking-settings for the property, command and datasession-windows. how can i disable the ""Dockable""-switch on startup?"
Reply,settings in config.fpw,EinTerraner,"Dec 18, 2024 at 7:59 PM",https://www.tek-tips.com/threads/settings-in-config-fpw.1832550/,Chris Miller,"_command.prg is the save file for the history of commands typed into the command window. The file name for that is always _command.prg. It also is always stored into the same directory as the foxuser.dbf resource file.With SET RESOURCE or the RESOURCE = ... line in a config.fpw you have the means to change to another name than foxuser.dbf, that's true, but since the _command.prg is just bound to the directory of the foxuser (or in your case the FVN24) files, it's name has no setting you can configure. Not that I know.So if you want to be able to swich between several save states of the command window, you'll need to rename whichever file you want to be the active _command.prg for a session before starting a new vfp9.exe process that reads that prg into the command window. Otherwise your options are obviously different directories for the resource files to switch the corresponding _command.prg, they only come as a pair in the same directory. Also, the _command.prg is only read in at VFP IDE start and saved when closing, while the environment manager allows to switch many settings including the resource file, switching environments won't switch to another command window history _command.prg, too. So that only applies to restarting VFP.It's not impossible to let VFP restart itself by RUN /N vfp9.exe followed by QUIT. The new VFP9.exe process and the current VFP9.exe process will compete about file handles to foxuser and _command.prg and maybe even ome more files. To avoid that maybe write out a vfpstart.cmd file that waits 100ms before starting VFP9.exe again and the RUN /N startvfp.cmd and QUIT, so the QUIT can write out changes to foxuser.dbf and _command.prg and close all file handles before the next vfp9.exe process starts.I think before you go into that, you should take a look at the environment manager and the options it gives you when switching environments and/or projects."
Reply,settings in config.fpw,EinTerraner,"Dec 18, 2024 at 7:59 PM",https://www.tek-tips.com/threads/settings-in-config-fpw.1832550/,Chris Miller,"EinTerraner said:2nd question: Sometimes Fox forget the last docking-settings for the property, command and datasession-windows. how can i disable the ""Dockable""-switch on startup?Click to expand...As far as I know it's an unresolved flaw of VFP to reproduce the states of the IDE windows especially the docking. An obvious workaround is writing a PRG you set as COMMAND = DO idestart.prg and make all necessary steps to position and dock or undock IDE windows there."
Reply,settings in config.fpw,EinTerraner,"Dec 18, 2024 at 7:59 PM",https://www.tek-tips.com/threads/settings-in-config-fpw.1832550/,Mike Lewis,"As far as I know it's an unresolved flaw of VFP to reproduce the states of the IDE windows especially the docking.Click to expand...That's not my experience. I have the four system windows (Command, Document View, Properties and Data Session) all set to Dockable and Docked. Those settings are always retained between sessions. The only exception is if I need to start VFP with a different resource file, but in general there is no reason to do that.Mike"
Reply,settings in config.fpw,EinTerraner,"Dec 18, 2024 at 7:59 PM",https://www.tek-tips.com/threads/settings-in-config-fpw.1832550/,Chris Miller,"I just use ""Window->Arrange All"" and have what's open side by side, if at all. For that to work flawless every window has to have dockable unchecked. If I like one window at a different place than the automatism decided, that's simple enough by just moving a window slightly off place and repeating ""Arrange All""."
Reply,settings in config.fpw,EinTerraner,"Dec 18, 2024 at 7:59 PM",https://www.tek-tips.com/threads/settings-in-config-fpw.1832550/,Paul Gibson,"Regarding the positioning of the window elements in the VFP IDE (Data Session, Command Window, Document View, Properties), I also like those elements to remain in very specific places which suit my habits and as others have said, the IDE will remember where you left them when you closed the IDE, given the resource file is consistent.  However, on occasion this can get messed up, but in my experience it is always in a fairly specific scenario and thankfully very rare.To my mind, the only issue I ever have with the windows not appearing in the correct location is after a major crash that has almost always been my fault.  I'll elaborate.For example, I'm testing my application ""in development"" i.e. running it in the IDE rather than compiling it and running the exe, but I've made some mistake in the area I'm testing that puts the application and therefore the IDE in such a bad way that it's quicker and easier to just bomb out of the IDE brutally, rather than trying to recover gracefully.In that scenario, when I reload the IDE, there is a good chance that one or more elements (usually the command window) has changed in a couple of ways.1. The window is sitting in the top right corner of the IDE instead of the location I like to have it.2. The dockable setting has reverted back to On, when I always have it set to offTo help with some of this, I have the startup.app that my IDE runs, call a TidyVfpWindow program that I wrote, which simply moves each window to the location that I like it to be.  That way, the windows should always be in my preferred location regardless.  That was the intention, there is still one exception though.The only thing I haven't solved is #2 above.  When my TidyVfpWindow program runs, it appears to have no effect on Windows where the dockable setting is On and I don't know if it is possible to programmatically set it off.I don't get too frustrated with this, I accept that it is my penance for making a mistake which ultimately resulted in me having to bomb out of the IDE, I manually switch dockable off and call my startup app again which repositions everything and results in all the elements being as I like again."
Reply,settings in config.fpw,EinTerraner,"Dec 18, 2024 at 7:59 PM",https://www.tek-tips.com/threads/settings-in-config-fpw.1832550/,Chris Miller,"I'd like to hear in more detail what EinTerraner expects or wants.One thing you can do yourself, in the aspect of switching the command window content is activating the command window and deleting all its content with CTRL+A and DEL with KEYBOARD commands and pasting in what you read from another command.prg file.The aspect I would guess is leading to the demand to use multiple resource files and command window history is to have everything individually ideal for each project you work on. And one thing that you don't have with mujltiple resource files is a central place to store the states of IDE windows. So if you want to change something generally in all projects, you have to merge that into your 3,4,5,6,... whatever number of different foxuser.dbf resource files. Working with environments also doesn't change that, but environments offer a lot of features worth using them to easily switch between projects and have necessary settings, quit or start certain application frameworks integrating into the IDE, etc. One major option you have is two scripts that execute before you switch to an environment and after, so before and after hooks.But what do you do when you want to centralize something? In the OOP world you centralize something in a root class everything else inherits from. Separate foxuser.dbfs don't inherit from a root foxuser.dbf, that's not how data works It's also questionable to establish this with other means, like having a set of records central and overriding individual resource file records, if in many cases your individual resource files should allow overriding the central settings, insteqad of vice versa. That becomes a problem of the type you can't eat the cake and keep it.Regarding programmatically setting the dockable state of IDE windows, I think the answer is in the binary content of some foxuser.dbf records, the difference of a record for an IDE once in a docakable state and once non dockable should reveal which bit of that binary bytes is the dockable flag."
Reply,settings in config.fpw,EinTerraner,"Dec 18, 2024 at 7:59 PM",https://www.tek-tips.com/threads/settings-in-config-fpw.1832550/,EinTerraner,"Sry, I had much other things lately in the foreground. Therefore no relies in this low important problem.My solution is now for each project i've a seperate path in the common temp-folderCode:** config.fpw
tmpfiles = c:\$dev\temps\BON21
resource = c:\$dev\temps\BON21\BON21.dbf"
Reply,settings in config.fpw,EinTerraner,"Dec 18, 2024 at 7:59 PM",https://www.tek-tips.com/threads/settings-in-config-fpw.1832550/,Chris Miller,"Ok, and I assume from your previous post BON21.dbf is not just any DBF, but the foxuser.dbf resource file table, right? Then by not only defining a specific filename of the resource file but a different directory, you also have spearate _command.prg files in each directory. There is no need now anymore to rename the foxuser.dbf to something esle, but that's your decision."
Reply,settings in config.fpw,EinTerraner,"Dec 18, 2024 at 7:59 PM",https://www.tek-tips.com/threads/settings-in-config-fpw.1832550/,mplaza,"Hi everyone.. happy new year!You can try this utility script to create shortcuts with isolated config for your projects:GitHub - nfoxdev/nfCustomEnvHelper: Start VFP in separate environments with ease.Start VFP in separate environments with ease. . Contribute to nfoxdev/nfCustomEnvHelper development by creating an account on GitHub.github.comnfCustomEnvHelper​Start vfp directly on your project folder from a shortcut. You'll get a separate command history, recent files history, startup environment ( config.fpw and resource ), debug sessions and a custom icon in the taskbar.Instructions: save this utility on a definitive location, and run it to start the helper:nfCustomenvHelper clones the current environment files or make new ones in any folder you choose and creates a shortcut on your desktop, adding a menu pad with options to easily edit your config.fp and project startup routine.Config.fpw and resource.dbf are saved in {{projectfolder}}\_customenv\, along with startup.prg*, favicon.ico and a copy of the shortcut.*startup.prg:defines a menu with options to:run this utility ( make sure to save it to a definitive location )edit config.fpwedit startup.prgedit afterStartup.prgrun startup.prgsets 1 function key:F5: runs startup.prgIf you have a common config routine you want to run on all your projects, just run it from ""afterstartup""."
Reply,settings in config.fpw,EinTerraner,"Dec 18, 2024 at 7:59 PM",https://www.tek-tips.com/threads/settings-in-config-fpw.1832550/,EinTerraner,"Chris Miller said:Ok, and I assume from your previous post BON21.dbf is not just any DBF, but the foxuser.dbf resource file table, right?Click to expand...That's correct.mplaza said:Start vfp directly on your project folder from a shortcut.Click to expand...I usually start with a respective xxx.PRG and/or the associated xxx.FXP file. I do not switch to another project during an editing session. If I want to view or copy something in another project, I start a new VFP instance.The directory in which my source code is located is available on the network (shared) and in certain cases I also access it via a VPN connection from outside the local network. I have found that if the VPN connection is temporarily disconnected due to the Internet, access to the resource file is no longer possible. To do this, I have to forcefully terminate the current VFP instance. Therefore, the respective FOXUSER files, in my case they have the project name, are in my ""$DEV"" folder."
Reply,settings in config.fpw,EinTerraner,"Dec 18, 2024 at 7:59 PM",https://www.tek-tips.com/threads/settings-in-config-fpw.1832550/,mplaza,"EinTerraner said:That's correct.I usually start with a respective xxx.PRG and/or the associated xxx.FXP file. I do not switch to another project during an editing session. If I want to view or copy something in another project, I start a new VFP instance.The directory in which my source code is located is available on the network (shared) and in certain cases I also access it via a VPN connection from outside the local network. I have found that if the VPN connection is temporarily disconnected due to the Internet, access to the resource file is no longer possible. To do this, I have to forcefully terminate the current VFP instance. Therefore, the respective FOXUSER files, in my case they have the project name, are in my ""$DEV"" folder.Click to expand...1 create a local folder for your project2 start vfp as normal and do nfCustomEnvHelper.prg .. indicate the new folder is your ""project folder""3 start vfp using the newly created shortcut ; you'll see an option menu ""Custom Env""4 select edit 'afterstartup' and include a line to change to your real working dir eg: 'cd  h:\myremoteFolder'"
Reply,settings in config.fpw,EinTerraner,"Dec 18, 2024 at 7:59 PM",https://www.tek-tips.com/threads/settings-in-config-fpw.1832550/,mplaza,"EinTerraner said:That's correct.I usually start with a respective xxx.PRG and/or the associated xxx.FXP file. I do not switch to another project during an editing session. If I want to view or copy something in another project, I start a new VFP instance.The directory in which my source code is located is available on the network (shared) and in certain cases I also access it via a VPN connection from outside the local network. I have found that if the VPN connection is temporarily disconnected due to the Internet, access to the resource file is no longer possible. To do this, I have to forcefully terminate the current VFP instance. Therefore, the respective FOXUSER files, in my case they have the project name, are in my ""$DEV"" folder.Click to expand...Indeed .. to create resource files wherever you choose is one of the benefits of this utility; the above indications ensure you are using a local drive for it .Give it a try!"
Question,Failure to pass data to form,graand,"Jan 2, 2025 at 4:43 AM",https://www.tek-tips.com/threads/failure-to-pass-data-to-form.1832635/,graand,"The following code has just thrown an unusual problem.This will usually pass several file names to a form for display however today, being the first time it has been used in 2025, it failed.The name format is ESMyymmdd.zip and hasn't had an issue for 20+ years. Today I find that it will not pass any name with the formatESM25mmdd.zip, it will however pass file names with the formatESM26mmdd.zip.Thoughts?"
Reply,Failure to pass data to form,graand,"Jan 2, 2025 at 4:43 AM",https://www.tek-tips.com/threads/failure-to-pass-data-to-form.1832635/,Chris Miller,"You should post code as code/text, not as image.You pass in the string (that's a file skeleton or filter) 'ESM??????.ZIP'. That's completely unspecific to whatever could be in the position of any of the questionmarks.How do you use this parameter in the form code? That's essential to find out why it doesn't find 2025 files. The other issue could simply be no ESM25... files exist to be unzipped. Well, most relevant is what you get from the file skeleton, and that's everything starting with ESM and having 6 further characters, any 6. That doesn't exclusde ESM25 files, unless you only have ESM25?????.zip files, for example, with ESM25, but more than 4 trailing characters after that, or less. You're only looking for files having exacly 9 characters overall, starting with ESM and with ZIP extension."
Reply,Failure to pass data to form,graand,"Jan 2, 2025 at 4:43 AM",https://www.tek-tips.com/threads/failure-to-pass-data-to-form.1832635/,GriffMG,could you be having a SET CENTURY thing... is this only happened after the new year?
Reply,Failure to pass data to form,graand,"Jan 2, 2025 at 4:43 AM",https://www.tek-tips.com/threads/failure-to-pass-data-to-form.1832635/,Chris Miller,"If you want to catch all ESM zip files, use 'ESM*.ZIP' as the file skeleton (filter)."
Reply,Failure to pass data to form,graand,"Jan 2, 2025 at 4:43 AM",https://www.tek-tips.com/threads/failure-to-pass-data-to-form.1832635/,Steve Yu,I'd trouble shoot by putting a suspend right after the adir(..)  to see what's been captured and check against what's actually in the source folder at the same time.
Reply,Failure to pass data to form,graand,"Jan 2, 2025 at 4:43 AM",https://www.tek-tips.com/threads/failure-to-pass-data-to-form.1832635/,Chris Miller,"Not even sure ADIR is used, the parameter looks like a file skeleton parameter as is used in ADIR, so it's likely, but unless graand doesn't post the code of the GETFIL2 form init receiving these parameters, showing what's done with them, we know nothing of value to help.The meaning of a ? in a file skeleton is any character, but it must be a character, unlike * it doesn't stand for as many characters as you like. So in theory ESM??????.ZIP used as ADIR fileskeleton parameter should only list files with names that start with ESM, have 6 more characters, and then the file extension ZIP.So I made up a showcase with 3 files:ESM25011.ZIP - a too short nameESM250101.ZIP - a name fitting the patternESM250101a.ZIP - a name too longI expected ADIR(laZips,""ESM??????.ZIP"") to only create an array item for ESM250101.ZIP and not show the too short and the too long name, but it listed all three files. That's a bug, surely. But a bug that'll always show too many files, never too few files.Turns out the number of question marks doesn't matter very much, I also get all 3 files from ADIR(laZips,""ESM?????.ZIP"") or even ADir(laZips,""ESM????????.ZIP""). ADIR goes back to zero only with 4 or less question marks in the file skeleton parameter. Not sure whether VFP does the pattern matching or delegates that to Windows API and that changed. It may be 8.3 DOS file names used for filtering allow ADIR to start seeing results with 5 question marks, as these names are 9 characters long and have a short file name in the form of ESM???~?.ZIP, to which ESM?????.ZIP already is strictly fitting. Too many question marks should not work, but then maybe VFP/OS doesn't care for extra questionmarks when it gets to the file extension earlier.Anyway, this bug or by design behavior won't effect you the way you say you're affected as it shows too many, not too few files.Either you simply where in the wrong directory or you don't have any ESM25????.ZIP files or the code doesn't use ADIR at all and fails on something completely different. That call of the form doesn't tell what goes wrong, though. Only the code of the form itself would show what's going on."
Reply,Failure to pass data to form,graand,"Jan 2, 2025 at 4:43 AM",https://www.tek-tips.com/threads/failure-to-pass-data-to-form.1832635/,Steve Yu,"Only the code of the form itself would show what's going onClick to expand...Chris,Wouldn't a suspend and debug help find out what's wrong ?"
Reply,Failure to pass data to form,graand,"Jan 2, 2025 at 4:43 AM",https://www.tek-tips.com/threads/failure-to-pass-data-to-form.1832635/,Chris Miller,"Of course, Steve, what I'm talking about is the minimum informationweneed to put the finger on what's not working. It's not the file name pattern, that's all right. Even considering the bug it's not suppressing ESM25*.ZIP files.Well, and on the other hand, debugging helps mostly with reproducible problems, if it's a one off problem to start in the wrong directory with the SET DEFAULT setting a new direcotryrelativeto that, debugging won't reveal what happened at the time the expected files were not displayed. In short, you can't debug a past case.Then, one one side of the spectrum talking about ""passing data"" makes me think graand doesn't know simple terms, on the other side of the spectrum graand may have programmed the GET_FIL2 form because he knows of the flaws of ADIR, programmed his own filtering of names that has its own flaw. Impossible to know without having more threads for comparison, as graand is a new user.I assume the problem is solved, was a ""duh"" moment to not come back to. We'll see. I still give your idea of debuggin a thumbs up. The first thing to look into would be the Locals window, showing the array ADIR created, which will be shown in a treeview with all its elements. Add an entry Sys(5)+Sys(2003) to the watch window to see the current/defult directory and whether it's actually what you expect. But again, if this works in the dev environment, you still don't know what caused the case. Maybe the whole application depends on teh default directory to usually be the application directory, some code - like this one - changes it, but also changes it back. And some brnach of the code does not. That's a scenario where you will have a hard time reproducing the problem even using the debugger, as you have to know which branch of code to execute beforehand that sabotages that dependency of the current directory."
Question,"Need to build web service, pronto :)",herbstgy,"Dec 18, 2024 at 9:26 PM",https://www.tek-tips.com/threads/need-to-build-web-service-pronto.1832552/,herbstgy,"Dear All,I have a VFP9 win32 app which works quite fine for years now. But now I'm in a situation that I have to let go the thick client and put at least some of the functions into a web page. The trouble is, I never did anything similar earlier.So I just started to view the VFP samples about the subject and found this foxisapi.dll.I have an IIS 10.0 that I can use here, I've put the foxisapi.dll into the c:\inetpub\scripts directory as the help directed me, then I tried to run the foxis project.It has a proper test.htm page, which looks similar like the form in the project.but when I press one of the buttons on top, I get this message.I guess I'm missing something fundamental here.Anyone care to guide me?"
Reply,"Need to build web service, pronto :)",herbstgy,"Dec 18, 2024 at 9:26 PM",https://www.tek-tips.com/threads/need-to-build-web-service-pronto.1832552/,mmerlinn,"You might want to translate the error into English as most people can understans English, but few understand Hungarian.So, what does ""Ez a(z) autapp01wprlvmw oldal nem talalhato"" mean in English?"
Reply,"Need to build web service, pronto :)",herbstgy,"Dec 18, 2024 at 9:26 PM",https://www.tek-tips.com/threads/need-to-build-web-service-pronto.1832552/,GriffMG,"Well, I am sure others will say I'm wrong... but it isn't easy to take a vfp app from the pc to the web.I have done it, using classic ASP and that works ok, using the VFPOLEDB... but I can't say that starting fromscratch I would do today."
Reply,"Need to build web service, pronto :)",herbstgy,"Dec 18, 2024 at 9:26 PM",https://www.tek-tips.com/threads/need-to-build-web-service-pronto.1832552/,herbstgy,"mmerlinn said:You might want to translate the error into English as most people can understans English, but few understand Hungarian.So, what does ""Ez a(z) autapp01wprlvmw oldal nem talalhato"" mean in English?Click to expand...it means ""Page not found"".I thought the HTTP error 404 gives it away."
Reply,"Need to build web service, pronto :)",herbstgy,"Dec 18, 2024 at 9:26 PM",https://www.tek-tips.com/threads/need-to-build-web-service-pronto.1832552/,Steve Yu,I think you are in for a long ride.It took us months to launch a website that can handle VFP data.We use tools from west-wind.com.
Reply,"Need to build web service, pronto :)",herbstgy,"Dec 18, 2024 at 9:26 PM",https://www.tek-tips.com/threads/need-to-build-web-service-pronto.1832552/,herbstgy,"for now, I just want to get the sample work, to see it works.everything else comes after."
Reply,"Need to build web service, pronto :)",herbstgy,"Dec 18, 2024 at 9:26 PM",https://www.tek-tips.com/threads/need-to-build-web-service-pronto.1832552/,Steve Yu,I'll defer to gurus in the forum to offer some insight as I'm not familiar with the sample coding you presented.
Reply,"Need to build web service, pronto :)",herbstgy,"Dec 18, 2024 at 9:26 PM",https://www.tek-tips.com/threads/need-to-build-web-service-pronto.1832552/,GriffMG,I would look at providing your desktop app via rdp/terminal server
Reply,"Need to build web service, pronto :)",herbstgy,"Dec 18, 2024 at 9:26 PM",https://www.tek-tips.com/threads/need-to-build-web-service-pronto.1832552/,Mike Lewis,"Well, I am sure others will say I'm wrong... but it isn't easy to take a vfp app from the pc to the web.Click to expand...You are not wrong, Griff. In my experience, it is almost always easier to rewrite the app from scratch using a dedicated server-based language such as PHP.Herbstgy, you say you are using FoxISAPI. This is very old technology. I'm not sure to what extent it is still supported. In any case, it requires a Microsoft web server such as IIS or PWS. I see you have IIS, but can you be sure that the app will always run on an ISAPI-compliant server?Finally, you are asking a lot of the forum to expect us to debug your work without actually seeing your code.Mike"
Reply,"Need to build web service, pronto :)",herbstgy,"Dec 18, 2024 at 9:26 PM",https://www.tek-tips.com/threads/need-to-build-web-service-pronto.1832552/,herbstgy,"Dear Mike,I'm not asking to debug my code. (it's not even my code.) I just asked if anyone tried this sample provided with VFP, and did it work for them. And if it did, how.I have a notion that if I could get it work, I could write my own code too..."
Reply,"Need to build web service, pronto :)",herbstgy,"Dec 18, 2024 at 9:26 PM",https://www.tek-tips.com/threads/need-to-build-web-service-pronto.1832552/,Chris Miller,"The first thing that's already wrong is that the headers HTTP and Content-Type and Expires are within the browser and not sent as headers. I think it's futile to get this going.That a button click gets you to a 404 not found error already points out someting doesn't work anymore or the setup you did was only halfways correct.There's a section ""Set up the HTML page"" in the help topic FoxIs, a Visual FoxPro Internet Server. That suggests an initial URL is not hostname:8443/test.htm but ""hostname:NNNN/scripts/foxisapi.dll/foxis.employee.cmd"" or ""localhost:NNNN/scripts/foxisapi.dll/foxis.employee.cmd"" where NNNN normally is 80 or 81 or 8080 or 8181, but you seem to use port 8443. Anyway, you should try out that."
Reply,"Need to build web service, pronto :)",herbstgy,"Dec 18, 2024 at 9:26 PM",https://www.tek-tips.com/threads/need-to-build-web-service-pronto.1832552/,herbstgy,"thanks for the answers, guys, I think I let this idea go..."
Reply,"Need to build web service, pronto :)",herbstgy,"Dec 18, 2024 at 9:26 PM",https://www.tek-tips.com/threads/need-to-build-web-service-pronto.1832552/,mmerlinn,"herbstgy said:it means ""Page not found"".I thought the HTTP error 404 gives it away.Click to expand...It probably would have, but it is in a tiny font and grayed out. Once you mentioned it, I had to look at the page 3 times before I found the error message."
Reply,"Need to build web service, pronto :)",herbstgy,"Dec 18, 2024 at 9:26 PM",https://www.tek-tips.com/threads/need-to-build-web-service-pronto.1832552/,Chris Miller,"I find it strange going from ""pronto"" to ""I let this idea go..."" so fast.herbstgy said:now I'm in a situation that I have to let go the thick client and put at least some of the functions into a web pageClick to expand...One question before I leave you alone with how to deal with the situation: Is your ""thick client"" aka desktop application storing data into the internet? Is it in any way non local? I.e. using a MySQL or MSSQL backend somewhere onnecting to a central server already?"
Reply,"Need to build web service, pronto :)",herbstgy,"Dec 18, 2024 at 9:26 PM",https://www.tek-tips.com/threads/need-to-build-web-service-pronto.1832552/,herbstgy,"Chris Miller said:I find it strange going from ""pronto"" to ""I let this idea go..."" so fast.One question before I leave you alone with how to deal with the situation: Is your ""thick client"" aka desktop application storing data into the internet? Is it in any way non local? I.e. using a MySQL or MSSQL backend somewhere onnecting to a central server already?Click to expand...not at all. it's local network only."
Reply,"Need to build web service, pronto :)",herbstgy,"Dec 18, 2024 at 9:26 PM",https://www.tek-tips.com/threads/need-to-build-web-service-pronto.1832552/,Chris Miller,"Okay, then the easiest thing to get something to run for clients without needing to install your application is offering it on remote desktop, as Griff suggested."
Reply,"Need to build web service, pronto :)",herbstgy,"Dec 18, 2024 at 9:26 PM",https://www.tek-tips.com/threads/need-to-build-web-service-pronto.1832552/,GriffMG,"RDP apps do not come free of development.Or licencing costs, although there are 'trial' routes that can avoid the licence things, not a rec'"
Reply,"Need to build web service, pronto :)",herbstgy,"Dec 18, 2024 at 9:26 PM",https://www.tek-tips.com/threads/need-to-build-web-service-pronto.1832552/,GriffMG,"So you know, each rdp client needs a unique place to store temp files etc.This isn't a consideration for a normal pc client."
Reply,"Need to build web service, pronto :)",herbstgy,"Dec 18, 2024 at 9:26 PM",https://www.tek-tips.com/threads/need-to-build-web-service-pronto.1832552/,Chris Miller,"Sure, Griff, it's not easy to set up and it's not something a new user can simply start by visiting a URL. But we don't know anything about herbstgy's user base and how feasible it is, but it can be and Azure based hosting enables you to provide applications via RDP.For example:https://azure.microsoft.com/en-us/products/virtual-desktop, as the page says: ""Deliver affordable, secure remote desktop and application experiences to employees wherever they are."" - it's mainly something you offer to employees for working at home, but you could also provide that to a (small) group of your business partners.It is not requiring a rewrite such as making an application work in the FoxIs way that's intended to be an EXE you can both run standalone as desktop EXE and when executed via ISAPI within IIS returning HTML for itself instead of running as a Foxpro form. Not talking about the not well aged HTML used for that."
Reply,"Need to build web service, pronto :)",herbstgy,"Dec 18, 2024 at 9:26 PM",https://www.tek-tips.com/threads/need-to-build-web-service-pronto.1832552/,herbstgy,"well, the user base would be the department's 1st level phone helpdesk mostly consisting part time student workers, so I wouldn't trust anything more complicated than a web page to them...If I would give the desktop app to them in any way, I would have to make serious rewrites so they can only reach the functions intended for them, or develop a separate application, that's why I thought I could create a web app for them. But you guys are right about Foxisapi is too outdated to do that."
Question,property showwindow is readonly error,Mandy_crw,"Dec 29, 2024 at 12:45 PM",https://www.tek-tips.com/threads/property-showwindow-is-readonly-error.1832617/,Mandy_crw,"hi everyone... I have these codes... intention is to have showwindow = 2 but it always say property showwindow is read only... Please help... Thanks in advance....oRepForm = CREATEOBJECT(""FORM"")WITH oRepForm.Caption = ""Balances"".WindowState = 2.alwaysontop = .f..visible = .T..SHOWWINDOW = 2.Show(2)ENDWITHREPORT FORM bal&back PREVIEW WINDOW (oRepForm.Name) ;TO PRINTER PROMPToRepForm.Release()RELEASE RepForm"
Reply,property showwindow is readonly error,Mandy_crw,"Dec 29, 2024 at 12:45 PM",https://www.tek-tips.com/threads/property-showwindow-is-readonly-error.1832617/,Chris Miller,"help:ShowWindow PropertySpecifies whether a form or toolbar is a top-level form or a child form.Available at design time; read-only at run time.Click to expand...It is readonly at runtime, you can only set ShowWindow at design time, that means you can't first create a form with CREATEOBJECT(""form"") which by default has 0 (in screen) and then want it to be a top level form. It is already created in the screen in line 1 of the code. The moment the form is created it's running, doesn't matter that it's not yet shown. At runtime you can't set this property.So design a class of a form and create that with CREATEOBJECT() or design an scx form and run that with DO FORMI see a lot of code like this, not only with forms, but especially with the cursoradapter baseclass, creating a baseclass and then setting properties. Design a class with the desired property values, not only when they are readonly at runtime, it's just completely broken to do that, you want a form with certain settings, think of how you can make this a class that's reusable in multiple places. If you want some properties set dynamically with values you only know at runtime and close before you create your class, that's not a problem, you have multiple ways to let this be dynamic, by using an expression in the property that get's evaluated when a class is created or by adding parameters to init which sets them. Of course that's not possible with such properties as ShowWindow. But you spare a lot of code by doing this and not repeatedly create the native base class and set its properties.What you want is a report preview form. For a good example of how to do this, you could look into the source code of FoxyPreviewer:They made a general frxpreviewform that is based on an frxbaseform. The major point is: To have control about ShowWindow they derived three subclasses ...astopform ..indesktop and ..inscreen from the class frxpreviewform. They mainly differ from their parent class in the ShowWindow property. So that way you can have one central class design that you manage and change and adapt when  necessary and derive three subclasses with all possible ShowWindow settings and can still decide at runtime, which ShowWindow mode you want, by choosing one of the three subclasses."
Reply,property showwindow is readonly error,Mandy_crw,"Dec 29, 2024 at 12:45 PM",https://www.tek-tips.com/threads/property-showwindow-is-readonly-error.1832617/,Mandy_crw,"Chris Miller said:It is readonly at runtime, you can only set ShowWindow at design time, that means you can't first create a form with CREATEOBJECT(""form"") which by default has 0 (in screen) and then want it to be a top level form. It is already created in the screen in line 1 of the code. The moment the form is created it's running, doesn't matter that it's not yet shown. At runtime you can't set this property.So design a class of a form and create that with CREATEOBJECT() or design an scx form and run that with DO FORMI see a lot of code like this, not only with forms, but especially with the cursoradapter baseclass, creating a baseclass and then setting properties. Design a class with the desired property values, not only when they are readonly at runtime, it's just completely broken to do that, you want a form with certain settings, think of how you can make this a class that's reusable in multiple places. If you want some properties set dynamically with values you only know at runtime and close before you create your class, that's not a problem, you have multiple ways to let this be dynamic, by using an expression in the property that get's evaluated when a class is created or by adding parameters to init which sets them. Of course that's not possible with such properties as ShowWindow. But you spare a lot of code by doing this and not repeatedly create the native base class and set its properties.What you want is a report preview form. For a good example of how to do this, you could look into the source code of FoxyPreviewer:View attachment 1395They made a general frxpreviewform that is based on an frxbaseform. The major point is: To have control about ShowWindow they derived three subclasses ...astopform ..indesktop and ..inscreen from the class frxpreviewform. They mainly differ from their parent class in the ShowWindow property. So that way you can have one central class design that you manage and change and adapt when  necessary and derive three subclasses with all possible ShowWindow settings and can still decide at runtime, which ShowWindow mode you want, by choosing one of the three subclasses.Click to expand...I see... thanks Chriss... i have been looking for answers in the internet but i cannot fine one... so i ask here in the forum... I''l try what you have suggested the DO form.. Thanks again..."
Reply,property showwindow is readonly error,Mandy_crw,"Dec 29, 2024 at 12:45 PM",https://www.tek-tips.com/threads/property-showwindow-is-readonly-error.1832617/,Chris Miller,"DO FORM is not the important part, but if you want to use that, create a form, an SCX form. What you have is closer to a class definition than an SCX form, but whatever. When you design a formorform class you can set the ShowWindow property in the designing of the form, that's what matters.Edit: What you actually want may not be a top level form, but just a form in which you set the AlwaysOnTop property to .T."
Reply,property showwindow is readonly error,Mandy_crw,"Dec 29, 2024 at 12:45 PM",https://www.tek-tips.com/threads/property-showwindow-is-readonly-error.1832617/,Mandy_crw,"Chris Miller said:DO FORM is not the important part, but if you want to use that, create a form, an SCX form. What you have is closer to a class definition than an SCX form, but whatever. When you design a formorform class you can set the ShowWindow property in the designing of the form, that's what matters.Edit: What you actually want may not be a top level form, but just a form in which you set the AlwaysOnTop property to .T.Click to expand...Ok Chriss… thanks and Godbless…"
Reply,property showwindow is readonly error,Mandy_crw,"Dec 29, 2024 at 12:45 PM",https://www.tek-tips.com/threads/property-showwindow-is-readonly-error.1832617/,Mandy_crw,Mandy_crw said:Ok Chriss… thanks and Godbless…Click to expand...what i want Chriss is all report to be outside my main form...
Reply,property showwindow is readonly error,Mandy_crw,"Dec 29, 2024 at 12:45 PM",https://www.tek-tips.com/threads/property-showwindow-is-readonly-error.1832617/,Chris Miller,"That can be done with form.Desktop=.T., which is another property that's readonly at runtime, so you need your SCX or form class in a VCX that has Desktop=.t. and I would prefer that to a top level form, a top level form is meant to be a parent form for child forms. The top level is making it freely movable on the Desktop, just like Desktop=.T. does, but it means more than that and for what you want a desktop form is enough.Acccording to the help documentation of the Desktop property, there's one situation you might want to use a top level form instead of a desktop form: A desktop form - even though it is freely movable outside the main top level form - gets hidden when you minimize the main form, because it's still a child of that. Only a second top level form remains independently seen. But I think if a user wants to minimize your application to use another application on the desktop, a report preview should not stay visible, so you should use the Desktop property."
Question,Using 1 table in 2 different forms,Filip Brnic,"Dec 24, 2024 at 1:05 PM",https://www.tek-tips.com/threads/using-1-table-in-2-different-forms.1832601/,Filip Brnic,"Hello, i have an issueFirst of all let me just give you a picture of the form layoutFORM 1Tables: Robak, RobaHas a grid connected to robakA button that opens a form that needs to load RobakFORM 2Tables: RobakSo i tried the followingIn form 1 command buttondo form form2in form 2 init property i have the followinguse robak sharedselect robak(some code that works below not connected to this)i also have data session set to 2 in this formWhen i try to use the button in form 1, with data session set to 2 in form 2 i get the error this file is used by another userWhen i try to use the button in form 1, with data session set to 1 in form 2 i sucessfully open the form2 but the issue now is that my grid just becomes blank, dissapears. I'm currently reading the help guidance provided by fox, i stumbled upon set releation to procedure, but im still trying to figure out what to do.And to mention i don't have anything in the data enviroment in form 2 just incase anyone was wondering because i know that can mess things up sometimes."
Reply,Using 1 table in 2 different forms,Filip Brnic,"Dec 24, 2024 at 1:05 PM",https://www.tek-tips.com/threads/using-1-table-in-2-different-forms.1832601/,Joe Crescenzi,"""File is used by another user"" sounds to me like you have used a file exclusively, or you used an FLOCK() to lock the whole file.So, before looking into the data session issues, check to be sure you have SET EXCLUSIVE OFF and that you haven't opened any tables with EXCLUSIVE or called an FLOCK() somewhere, which lock the entire file."
Reply,Using 1 table in 2 different forms,Filip Brnic,"Dec 24, 2024 at 1:05 PM",https://www.tek-tips.com/threads/using-1-table-in-2-different-forms.1832601/,Filip Brnic,"Nope, no flock and set exclusive is off in both forms load property..."
Reply,Using 1 table in 2 different forms,Filip Brnic,"Dec 24, 2024 at 1:05 PM",https://www.tek-tips.com/threads/using-1-table-in-2-different-forms.1832601/,Joe Crescenzi,"Filip Brnic said:Nope, no flock and set exclusive is off in both forms load property...Click to expand...Then the problem is related to the data sessions.I never use data sessions, so I don't have any experience troubleshooting them, but I know enough to know that there are configuration options in data sessions that you can explore such as private vs default datasets (private isolates the session and keeps record positions, index orders, etc. independent from the default), and there are multiple buffering options that may play a role.Since you said one form has a data session, and the other does not, this should be the first thing you explore."
Reply,Using 1 table in 2 different forms,Filip Brnic,"Dec 24, 2024 at 1:05 PM",https://www.tek-tips.com/threads/using-1-table-in-2-different-forms.1832601/,Steve Meyerson,"Filip,Suggest you look up parameters AGAIN and ALIAS in the USE command. It will take you far.Steve"
Reply,Using 1 table in 2 different forms,Filip Brnic,"Dec 24, 2024 at 1:05 PM",https://www.tek-tips.com/threads/using-1-table-in-2-different-forms.1832601/,Mike Lewis,"the issue now is that my grid just becomes blank,Click to expand...This is a separate issue - not related to the error you are seeing or your DataSession settings.The problem occurs when you set the grid's RecordSource, but then later close the underlying table (the one that the RecordSource point to), and then re-open the table. I don't know the exact sequence of events in your case, but I suspect it is something along those lines.The solution is to remove the RecordSource (that is, set it to an empty string), then re-open the table, then set the RecordSource back to pointing to the table.Also, I don't think SET RELATION will help in this case. Whatever caused the ""File in use by another"" error won't be solved by SET RELATION.Mike"
Reply,Using 1 table in 2 different forms,Filip Brnic,"Dec 24, 2024 at 1:05 PM",https://www.tek-tips.com/threads/using-1-table-in-2-different-forms.1832601/,mjcmkrsr,"Hi,The DATASESSION property of each form has to be set to 2 (Private). Then you have full control of the underlying table(s).From Hacker's Guide to VFP 7Set an object's DataSession to 2 to keep it private. This allows multiple instances of the same object to be running at the same time without interfering with each other. Each form has its own DataSessionID, its own set of work areas, its own record pointers and its own set of aliases. This last is really cool. With a private data session, you can use the same alias every time, something you can't do with USE AGAIN.Click to expand...You may also want to have a look at ""Programming for Shared Access"" in the help file.​hthMarK"
Reply,Using 1 table in 2 different forms,Filip Brnic,"Dec 24, 2024 at 1:05 PM",https://www.tek-tips.com/threads/using-1-table-in-2-different-forms.1832601/,EinTerraner,"Just open the DBF likeCode:MyGRID.addproperty(""SrcAlias"", ""D_""+ThisForm.name)
USE (sourcefilename) alias (MyGRID.SrcAlias) in select(MyGRID.SrcAlias) SHARED [NOUPDATE] AGAIN
MyGRID.RecordSource = MyGRID.SrcAliasin both forms.Here You have 2 different Aliases"
Reply,Using 1 table in 2 different forms,Filip Brnic,"Dec 24, 2024 at 1:05 PM",https://www.tek-tips.com/threads/using-1-table-in-2-different-forms.1832601/,Premal Vala,"HeyFilip Brnic said:Hello, i have an issueFirst of all let me just give you a picture of the form layoutFORM 1Tables: Robak, RobaHas a grid connected to robakA button that opens a form that needs to load RobakFORM 2Tables: RobakSo i tried the followingIn form 1 command buttondo form form2in form 2 init property i have the followinguse robak sharedselect robak(some code that works below not connected to this)i also have data session set to 2 in this formWhen i try to use the button in form 1, with data session set to 2 in form 2 i get the error this file is used by another userWhen i try to use the button in form 1, with data session set to 1 in form 2 i sucessfully open the form2 but the issue now is that my grid just becomes blank, dissapears. I'm currently reading the help guidance provided by fox, i stumbled upon set releation to procedure, but im still trying to figure out what to do.And to mention i don't have anything in the data enviroment in form 2 just incase anyone was wondering because i know that can mess things up sometimes.Click to expand...Hi Filip,asmjcmkrsrexplained, setting DATASESSION property to 2 (PRIVATE) should resolve your issue. Also, better to add AGAIN clause in your USE statement, this will avoid any error of ""ALREADY IN USE"""
Reply,Using 1 table in 2 different forms,Filip Brnic,"Dec 24, 2024 at 1:05 PM",https://www.tek-tips.com/threads/using-1-table-in-2-different-forms.1832601/,Filip Brnic,"Ive tried setting the datasesion property to 2 in both forms, still the same error, tried use robak again and use robak shared and both give the same error regardless. also tried use robak again alias robak and still the same error, the forms work individually but opening the other one with the first one open causes errors, you might find something from this video, i showed every code that could be related to this."
Reply,Using 1 table in 2 different forms,Filip Brnic,"Dec 24, 2024 at 1:05 PM",https://www.tek-tips.com/threads/using-1-table-in-2-different-forms.1832601/,Tore Bleken,"You write that Set Exclusive is Off, I say that you're wrong! Scan your code with GoFish, and search for the word Exclusive."
Reply,Using 1 table in 2 different forms,Filip Brnic,"Dec 24, 2024 at 1:05 PM",https://www.tek-tips.com/threads/using-1-table-in-2-different-forms.1832601/,Filip Brnic,"Tore Bleken said:You write that Set Exclusive is Off, I say that you're wrong! Scan your code with GoFish, and search for the word Exclusive.Click to expand...Hello, now i get the error file is in use, coming from the form 2 where i have the codeUse robak sharedI also triedUse robak alias robak againI also triedUse robak in 1 and use robak in 0 and still the same error"
Reply,Using 1 table in 2 different forms,Filip Brnic,"Dec 24, 2024 at 1:05 PM",https://www.tek-tips.com/threads/using-1-table-in-2-different-forms.1832601/,Tore Bleken,"When you get the error, select Suspend. Then type ?Set('exclusive') in the command window, and see the result.If that doesn't help, keep the debugger open when you run the program. Before running the program, select the debugger, and add a breakpoint (ctrl-B), Type =Break when expression has changed. In the Expression field, type Set('exclusive'). Then press Add, and run the program.Something very basic is wrong in your setup. Could it be that you have Exclusive = On in your config.fpw?"
Reply,Using 1 table in 2 different forms,Filip Brnic,"Dec 24, 2024 at 1:05 PM",https://www.tek-tips.com/threads/using-1-table-in-2-different-forms.1832601/,Filip Brnic,"Tore Bleken said:When you get the error, select Suspend. Then type ?Set('exclusive') in the command window, and see the result.If that doesn't help, keep the debugger open when you run the program. Before running the program, select the debugger, and add a breakpoint (ctrl-B), Type =Break when expression has changed. In the Expression field, type Set('exclusive'). Then press Add, and run the program.Something very basic is wrong in your setup. Could it be that you have Exclusive = On in your config.fpw?Click to expand...ON THE SECOND LINE OF CODE GOT THIS."
Reply,Using 1 table in 2 different forms,Filip Brnic,"Dec 24, 2024 at 1:05 PM",https://www.tek-tips.com/threads/using-1-table-in-2-different-forms.1832601/,Tore Bleken,"Of course, and that line is Set Exclusive On!!! Set it to Off, and your problem is solved."
Reply,Using 1 table in 2 different forms,Filip Brnic,"Dec 24, 2024 at 1:05 PM",https://www.tek-tips.com/threads/using-1-table-in-2-different-forms.1832601/,EinTerraner,"maybe the ""USE""-Line missing SHAREDCode:USE robak {ALIAS (aliasname) IN SELECT(aliasname) } SHARED AGAINtheSHARED-Clause overwitesthe EXCLUSIVE-Settingoptional give the used ""robak.dbf"" an unique aliasname, as i've shown few comments above to avoid duplicate aliasesRemember, if you open a table multiple times within the same datasession, all additional USE SHARED will have the same properties."
Reply,Using 1 table in 2 different forms,Filip Brnic,"Dec 24, 2024 at 1:05 PM",https://www.tek-tips.com/threads/using-1-table-in-2-different-forms.1832601/,Chris Miller,"The line failing isuse robak sharedClick to expand...isn't it?I agree with Tore, the form1 opens the table exclusive, or it was already open exclusive before even running, for example due to being open within the IDE when testing within the IDE.Notice, Filip, that for the IDE the dafault setting of EXCLUSIVE is ON, as the developer you likely often need DBF opened excluive. But when you want to test shared usage of DBFs, that's hindering that. a Database included in the project also keeps a database open (exclusive). So for testing change the IDE settings.Also notice, that some settings, like EXCLUSIVE and others are settings per datasession. That's meaning you have to set them for every form, not only for form1. to be consistently the same in all datasessions. That's described in the help topic about commands that scope to a session. Which means they only influence the current datasession, not all of VFP and all forms within other datasessions:Commands that Scope to a Data Session - dv_foxhelp91.hhc - Imported Help FileThat this exists and how it's chosen actually makes all these things better scopable, if that word exists, if you would start a transaction throughout all datasessions, transactions wouild become useless. For some settings, like Exclusive, it's discussable whether they could also be global, but nothing is in your way of turning that off for all sessions by putting SET EXCLUSIVE OFF into every form load.That excursion to session scoped settings aside, you'd still ask yourself why it failed to make form2 part of the same datasession? Well, your still do USE ROBAK SHARED. Although it is already open. Perhaps in another workarea than the current one.Look into the USE commmand once more and rea about the IN clause, to understand why it's usually always the best to make any USE... IN 0, which means in a new unused workarea. And in this case, when you don't use a privatre datasession robak is already open from form1, why do you use it at all? It's already used by form1. You confirm my judgement. I also wonder why you don't get told the obvious by others. Anyway, there you are.Putting SET EXCLUSIVE OFF in both forms load procedures would make it possible for both forms to USE robak shared. It would also work wwith EXCLUSIVE ON, if you always USE robak shared. But you'd open a DBC exclusive, and that can then only be opened by one form. So you better work shared, and have something in your IDE that ends the IDE mode before starting tests, that IDEshutdown.prg should close all tables and databases, close all sessions, clear all objects and class definitions from memory and then set exclusive off and make any other general settings necessary for testting and then start your projects main.prg to run the app as if it was started by windows without any previous VFP runtime and datasession etc. usage."
Reply,Using 1 table in 2 different forms,Filip Brnic,"Dec 24, 2024 at 1:05 PM",https://www.tek-tips.com/threads/using-1-table-in-2-different-forms.1832601/,Chris Miller,"By the way, the reason Tore even noticed you have to have exclusive on in his8:22 AMpost, is that there is no other reason you get this error. When an alias is used already and you try to USE in another workarea you get the error 3 - File is in use, not error, 108 - File is in useby another user.They differ.But telling us exclulsive is off when it's on, you need glasses, it seems."
Reply,Using 1 table in 2 different forms,Filip Brnic,"Dec 24, 2024 at 1:05 PM",https://www.tek-tips.com/threads/using-1-table-in-2-different-forms.1832601/,Filip Brnic,"Thanks Chris, ill look into what you told me, i did have exclusive off before ive sent you the video, but i still got the error file in use by another user.What im curious about is, is this something simple that i just made difficult, like for exampleSome of you here would be able to make this work in like 5 minutes?Regardless, I do understand the logic and I did have in mind alot of solutions for this but its just the lack of experience in fox it seems.But there are alot of answers here, so which ones do i implement because i guess there are multiple approaches?Should i try what@EinTerranersuggested?"
Reply,Using 1 table in 2 different forms,Filip Brnic,"Dec 24, 2024 at 1:05 PM",https://www.tek-tips.com/threads/using-1-table-in-2-different-forms.1832601/,Filip Brnic,"Can someone just do this and send me the project file or something, I'm at my limit, im wasting time trying to figure out how to fix  the most basic shitty error possible.I have so much more i wanna do but can't because im stuck on something i have no fucking clue how to solve. Can someone just show me and ill remember for the rest of my life."
Question,Python code execution though Foxpro environment,A_Radiolog_inFoxPro,"Dec 23, 2024 at 8:04 PM",https://www.tek-tips.com/threads/python-code-execution-though-foxpro-environment.1832597/,A_Radiolog_inFoxPro,"Dear All ,This will sound silly and stupid , but it's worth the shot.At the moment when I want to interface with a python project I have to generate a text file with all the details / parameters(generating it via foxpro before hand ) I have to pass to it then run the python script that is pre-compiled as an exe through fox-pro behind a yes no window box.now the issue arises when I want to change that exe file of python to make changes it takes time to find it , change it , replace it , and then recompile it , re-package it as an executable.has anyone in here thought or found a way to call or use the higher level languages of python though the .prg files of foxpro ( 6.0 in my case ) ... I know I know I should have ditched VFP long time ago.( is like trying to run DOOM on voyager 1 with 60 FPS remotely too ....  )I found this.https://github.com/mwisslead/VFP-Embedded-PythonBut I am not 100% sure that this will do what I want it to. I haven't tried it yet.Let me know if you have any thoughts on my idea / problemThank you in advanceThe Radiologist"
Reply,Python code execution though Foxpro environment,A_Radiolog_inFoxPro,"Dec 23, 2024 at 8:04 PM",https://www.tek-tips.com/threads/python-code-execution-though-foxpro-environment.1832597/,GTGeek88,"""like trying to run DOOM on voyager 1 with 60 FPS remotely""I don't find that to be true. VFP still runs great and given that it was built for data from the ground up, it makes dealing with data far easier than something like .NET.As for your question, I'd like to see a better description of what you're doing, because it's unclear to me. You know what it is you're doing, but you've not explained it well, I'd say. I've always noted it's difficult for us as programmers to explain things to others. We have divorce ourselves of the knowledge we have of a system and see it through the eyes of others unfamiliar with it. Same applies here.But, can Python be loaded as an automation object? Probably not, but that would be great for your needs, if it could."
Reply,Python code execution though Foxpro environment,A_Radiolog_inFoxPro,"Dec 23, 2024 at 8:04 PM",https://www.tek-tips.com/threads/python-code-execution-though-foxpro-environment.1832597/,A_Radiolog_inFoxPro,"GTGeek88 said:""like trying to run DOOM on voyager 1 with 60 FPS remotely""I don't find that to be true. VFP still runs great and given that it was built for data from the ground up, it makes dealing with data far easier than something like .NET.As for your question, I'd like to see a better description of what you're doing, because it's unclear to me. You know what it is you're doing, but you've not explained it well, I'd say. I've always noted it's difficult for us as programmers to explain things to others. We have divorce ourselves of the knowledge we have of a system and see it through the eyes of others unfamiliar with it. Same applies here.But, can Python be loaded as an automation object? Probably not, but that would be great for your needs, if it could.Click to expand...Imagine .I have some things I want to do. Having Foxpro to speak to a webserver make requests etc etc.I can't do that directly through Foxpro.So I bridge the gap by. the following :1.passing the parameters from FOXPRO to a TEXT file.2. Made a Pre-compiled exe file of a python project with all the libraries and logic I need. also in the code poining the python script to get the data from that text file(that foxpro added what parameters into).3. calling the python script from Foxpro as a shell32 run command4. Python script does its thing and returns what ever I need in the same file.5. Foxpro waits for my response that the script has ended successfully. so that it can pick up where python left off.6.  go on with my day as python did the heavy lifting.And yes I am trying to run doom on Voyager 1. there is no doubt about it.because I am trying to make a system that was never intended to work with webserver's , requests , ssl and fly a plane.With data ? Sure I agree is quite versatile. and sometimes robust if implemented correctlyLet me know if something was unclear.Thank you in advance"
Reply,Python code execution though Foxpro environment,A_Radiolog_inFoxPro,"Dec 23, 2024 at 8:04 PM",https://www.tek-tips.com/threads/python-code-execution-though-foxpro-environment.1832597/,Chris Miller,"A_Radiolog_inFoxPro said:I have some things I want to do. Having Foxpro to speak to a webserver make requests etc etc.I can't do that directly through Foxpro.Click to expand...Of course you can make http requests with VFP, and that's also the straight forward way to execute other languages run within the web server, like PHP, Perl, Python. You're instead going the hard way compiling pythin to an exe to call. To my Python mainly is a scripting language, you don't necessarily need the web for it, you can run python.exe and pass in command line parameters, of which one is the name of the python code file to run. You can theoretically also do that with PHP.It's typically not done, neither with Python nor PHP as you don't install Python or PHP on an end users computer but have your PHP/Python or other code in the web on your server that has a Python/PHP installation under your control, easy to upgrade, configure as necessary, etc. and Python/PHP script you run by makeing http requests to it, which can have a body of parameters, too.In short, an API, a web API, a web service."
Reply,Python code execution though Foxpro environment,A_Radiolog_inFoxPro,"Dec 23, 2024 at 8:04 PM",https://www.tek-tips.com/threads/python-code-execution-though-foxpro-environment.1832597/,Chris Miller,"One thing is true about Python, it's also used standalone, there's the basic standdar IDLE Shell installed with Python and there are ways to code python within MS Visual Studio Code, there's Jupyter and much more, and there are modules for many things in the direction of AI or Data Science etc. etc. Python is a bit of a Chameleon and not in the first place, as PHP just intended as web scripting language.Python is not rarely used standalone, for any development, it is a general purpose language, not just a web language. but given your description needing often changes in your python modules points out to me that you rather want to use it uncompiled to an EXE and jsut as a scripting language, and then it's good to embed that into a web server as web language, which makes it easy to scale up to offer it in the cloud and not only locally as a module your EXE uses.Well, and from the other end of a perspective to write some extension for applications, wanting a close as possible integration you write a DLL that's used by anything else and when you change features, extend it, then building new versions of a DLL (or EXE) is normal, it shouldn't hinder you to do that. It becomes crazy, if you generate Python code from within your application and want to auto build that into a DLL or EXE to use by the application."
Reply,Python code execution though Foxpro environment,A_Radiolog_inFoxPro,"Dec 23, 2024 at 8:04 PM",https://www.tek-tips.com/threads/python-code-execution-though-foxpro-environment.1832597/,A_Radiolog_inFoxPro,"Chris Miller said:Of course you can make http requests with VFP, and that's also the straight forward way to execute other languages run within the web server, like PHP, Perl, Python. You're instead going the hard way compiling pythin to an exe to call. To my Python mainly is a scripting language, you don't necessarily need the web for it, you can run python.exe and pass in command line parameters, of which one is the name of the python code file to run. You can theoretically also do that with PHP.It's typically not done, neither with Python nor PHP as you don't install Python or PHP on an end users computer but have your PHP/Python or other code in the web on your server that has a Python/PHP installation under your control, easy to upgrade, configure as necessary, etc. and Python/PHP script you run by makeing http requests to it, which can have a body of parameters, too.In short, an API, a web API, a web service.Click to expand...are you sure vfp 6.0 can do directly api calls ?as far as i know in vfp9.0 and higher with some modes / external dll calls was possible.do you have some vfp 6.0 native examples ?and Native is the key point here."
Reply,Python code execution though Foxpro environment,A_Radiolog_inFoxPro,"Dec 23, 2024 at 8:04 PM",https://www.tek-tips.com/threads/python-code-execution-though-foxpro-environment.1832597/,Chris Miller,"You don't need native code to do API calls, https requests, that is. You use OLE objets for that, and VFP6 can do that just like VFP9.Code:loHTTP = CREATEOBJECT(""MSXML2.ServerXMLHTTP.6.0"")
loHTTP.open(""GET"", ""https://www.tek-tips.com"" ,.F.)
loHTTP.send()
Do While loHttp.readystate<4
   Doevents
EndDo
? Left(loHTTP.responsetext,200)+""...""Just like you can make a GET request for the homepage of a site, you can call a PHP script at some URL and get the response of the PHP script back. It doesn't need to be HTML, it could be anything binary, XML, JSON, whatever, and then you process that response in VFP.The code has nothing VFP9 specific, the functionality of a HTTP request is in the OLE Class. There are several and you don't need to be as specific as I was here with version 6.0 of MSXML2.ServerXMLHTTP. It'll work from Windows 98 to Wiondows 11."
Reply,Python code execution though Foxpro environment,A_Radiolog_inFoxPro,"Dec 23, 2024 at 8:04 PM",https://www.tek-tips.com/threads/python-code-execution-though-foxpro-environment.1832597/,Pieter Koemans,"There is a project on GitHub:VFP-Embedded-Python, which allows you to run native Python code within Visual FoxPro (VFP). I use Python extensively, and to integrate it with my legacy VFP application, I utilize a SQLite table as a bridge between the two runtimes. This approach is incredibly fast and highly flexible.With Python's Pandas library, you can efficiently process SQLite or MySQL files. It offers exceptional performance ( in most cases much faster than VFP,) , and the coding experience is straightforward.For web server functionality, you can use Flask in Python to interact seamlessly with the SQL table, enabling a powerful and flexible server-side solution."
Reply,Python code execution though Foxpro environment,A_Radiolog_inFoxPro,"Dec 23, 2024 at 8:04 PM",https://www.tek-tips.com/threads/python-code-execution-though-foxpro-environment.1832597/,Chris Miller,"The Radiologist has mentioned that github himself.I don't like to install Python or PHP or any other language to integrate with with an application setup, as that's usually not easily to integrate in a setup. It's feasable to do and use, I'd still prefer the usual way of interop with other languages that don't offer to interop via DLL or OLE class through the web with http requests.The github project makes use of a Python.dll or Pythonw.exe or both. Usage of Python.dll is clearly usage of a DLL, but you can't just distrubute the dll standalone (inclduing a runtime), this whole project requires a full PYthon installation.The http request usage of Python also requires a Python installation, but hosted on a server under your control, maybe provided by the hoster you choose and maintained by them - one less job for yourself.If a Windows computer you install your application already has a Python installation, that could be used, but then the configuration of it and upgrades is not under your full control, you can't  - as far as I know - simply install Python twice to have your own version for your application usage only. This makes it a less controllable situation.It's totally fine, if you just do all this for yourself, if you don't distribute an application and just write your application for yourself, no doubt, but I wouldn't recommend the dependency on a whole language installation."
Reply,Python code execution though Foxpro environment,A_Radiolog_inFoxPro,"Dec 23, 2024 at 8:04 PM",https://www.tek-tips.com/threads/python-code-execution-though-foxpro-environment.1832597/,Chris Miller,"Pieter Koemans said:For web server functionality, you can use Flask in Python to interact seamlessly with the SQL table, enabling a powerful and flexible server-side solution.Click to expand...Yes, Flask is one of the first known frameworks for using PYthon on the web, but you can get bare python to work just like PHP on an IIS, for example like this:Python on IIS: how?I've got a background in PHP, dotNet and am charmed by Python. I want to transpose functionality from PHP to Python step by step, running bits and pieces side-by-side. During this transition, which...stackoverflow.comI would recommend to find a hoster to offer py scripts to run, as that unbinds you from the maintenance of Python itself. If you don't consider there is any maintenance to do as the python integration in your application is fixed and when it is tested to run error free that'll do forever, you don't consider securtiy fixes, for example.Again, when you all do this for yourself only and don't need to consider a distribution of your whole system including Python and whatever other components you integrate, it's fine, you'll be able to fix this for yourself and don't have the maintenance problems for clients using your software."
Reply,Python code execution though Foxpro environment,A_Radiolog_inFoxPro,"Dec 23, 2024 at 8:04 PM",https://www.tek-tips.com/threads/python-code-execution-though-foxpro-environment.1832597/,Pieter Koemans,"Chris Miller said:Yes, Flask is one of the first known frameworks for using PYthon on the web, but you can get bare python to work just like PHP on an IIS, for example like this:Python on IIS: how?I've got a background in PHP, dotNet and am charmed by Python. I want to transpose functionality from PHP to Python step by step, running bits and pieces side-by-side. During this transition, which...stackoverflow.comI would recommend to find a hoster to offer py scripts to run, as that unbinds you from the maintenance of Python itself. If you don't consider there is any maintenance to do as the python integration in your application is fixed and when it is tested to run error free that'll do forever, you don't consider securtiy fixes, for example.Again, when you all do this for yourself only and don't need to consider a distribution of your whole system including Python and whatever other components you integrate, it's fine, you'll be able to fix this for yourself and don't have the maintenance problems for clients using your software.Click to expand...With PyInstaller, you can bundle all Python dependencies (including the Python runtime) into a single package, either as a standalone executable or a folder.However, there are indeed many ways to accomplish tasks between Python and Foxpro."
Reply,Python code execution though Foxpro environment,A_Radiolog_inFoxPro,"Dec 23, 2024 at 8:04 PM",https://www.tek-tips.com/threads/python-code-execution-though-foxpro-environment.1832597/,Chris Miller,"The problem is not to bundle Python for your setup, you may just point out to end users, that they please install Python 2.7 or whichever version you need and specify the path of Python. The problem with a python installation required for your software is that other software having the same dependency already can cause conflicts. Not that their and your software run Python, that can be used in parallel, but like VFP has settings, PYthon has settings, you may require other settings than the other software. So I would only be working with a separate Python installation just for my software, and I don't see something like that without going through hoops like making my software a VM that runs completely separate from the host system in it's own little virtual universe, and I won't recommend to do that for somebody like A_Radiolog_inFoxPro.Running Python within a webserver is having that separate universe, either under the roof of a website re runs as a support server for his software or in the intranet.And as I already siad, if the software doesn't need distribtion, then you have the freedom to integrate whatever without thinking about such things as dependencies. because your only maintenance problems are with your own computers running your own software.Maybe, A_Radiolog_inFoxPro, you even think this github repository is self contained and has everything in it to run Python with FoxPro, but you requira this Github package and a full Python installation. to run this. It may not be impossible to just pick out the essential pythonw.exe and some support DLLs to fully integrate, but as Python scripts depend on modules you'll have to also integrate subfolders lib, DLLs and then you're already near a full Python installation folder. Python like VFP knows its HOME() installation folder, so if a Windows system has two or mor Python installations it becomes hard to maintain what Home os for your Python integration, I think.Looking into another software that uses Python for scripting within it - Gimp - that does not use a full Python installation it depnds on, it has some libpython2.7.dll and libpython3.9.dll in a bin subfolder of its application directory. It doesn't intefere with the Python installation I have, too. The goal opf the Python integration of Gimp is not to run general purpose Python code, but for scripting batch processing. It will not import anything I have available in my major dededicated Python installtion, it's not the intention to be able to, it's sufficient it can use modules of Gimp to have image processing features of gimp for automation batch processing purposes.So, it's not impossible to integrate Python in software in a way that's not simply using a full Python installation. I'd be more impressed with a FoxPro Python installation that's using the same integratable libraries as Gimp does, though I also fully support that the idea of simply wrapping around a full Python installation makes it easier to integrate any general purpose Pyhton scripts that add to the import modules etc. as necessary. It's just something not as simply to redistribute, unless you make the assumption it will not collide with anything your end users have already installed.Well, and the solution I still prpüpse in having a Web server integration with Python used centrally, that has one little disadvantage of the http request/response full turnaround time, that's surely a few ms everytime, but it's usable, otherwise no web services would be able to exist. With such a separate cloud based solution you have your own and only Python installation fully under control without needing to install anything at clients, you can choose the modules you need, configire PYthon as you want and upgrade whenever necessary. You can maintain your Pythong code and not necessarily need to build it into an EXE. Python is just like VFP not necessarily getting a boost from that, unless you use a build system that does not produce Python byte code but transpiles it to the C++ underlying the Python language and make a C++ binary from it that effectively becomes assmbler, just as fast assembler as you get from writing C++ code. CPyhton does that, I think, I never used that, Cython does similar things based on another idea, I'm not in the details. But such things will always not be fully compatible or need adjustments in the code. And, I think, A_Radiolog_inFoxPro. your main idea is to use solutions you find done in Python and not need to translate that to VFP code. It's surely a nice way to increase usable solutions. It's a huge effort, if all the Python code does is use web APIs you could also directly use from VFP, though. And many things like AI APis and other databases are directly integratable into VFP without going through Python."
Question,Facing issue with Selenium version 4 and above with VFP,Premal Vala,"Dec 25, 2024 at 11:27 AM",https://www.tek-tips.com/threads/facing-issue-with-selenium-version-4-and-above-with-vfp.1832607/,Premal Vala,"Dear Experts,I am using Selenium with VFPA via C# dll. I have created COM DLL with C# within VSS. I am using it successfully once registered with REGASM. However my problem is with Selenium .WebDriver and Selenium.Support version. My DLL and automation is working fine when I am using Selenium version 3.5.2. See below:But as soon as I try to update this version to latest or even to 4.0.0. VFPA starts giving error on automation.Can anyone help what is wrong with Selenium Latest version and VFPA?Thanks in advance.PREMAL VALA"
Reply,Facing issue with Selenium version 4 and above with VFP,Premal Vala,"Dec 25, 2024 at 11:27 AM",https://www.tek-tips.com/threads/facing-issue-with-selenium-version-4-and-above-with-vfp.1832607/,Chris Miller,"Premal Vala said:I have created COM DLL with C# within VSClick to expand...Source code of that? Since you're using Selenium through this DLL that's the point of failure, isn't it? So not knowing how you create a selenium object in your c# code, how should we be able to help with what's going on?"
Reply,Facing issue with Selenium version 4 and above with VFP,Premal Vala,"Dec 25, 2024 at 11:27 AM",https://www.tek-tips.com/threads/facing-issue-with-selenium-version-4-and-above-with-vfp.1832607/,Premal Vala,"Hey Chris,My bad on not providing details, here it is.Below is my C# code:C#:using OpenQA.Selenium.Chrome;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Runtime.InteropServices;
using System.Text;
using System.Threading;
using System.Threading.Tasks;

namespace TestDll
{
    [ClassInterface(ClassInterfaceType.AutoDual)]
    [ProgId(""MyTest"")]
    [ComVisible(true)]

    public class Class1
    {
        public string MyAuto()
        {
            ChromeOptions passOptions = new ChromeOptions();

            passOptions.AddExcludedArgument(""enable-automation"");
            passOptions.AddUserProfilePreference(""credentials_enable_service"", false);
            passOptions.AddUserProfilePreference(""profile.password_manager_enabled"", false);

            var driverService = ChromeDriverService.CreateDefaultService();
            driverService.HideCommandPromptWindow = true;


            ChromeDriver passDriver = new ChromeDriver(driverService, passOptions);
            passDriver.Url = ""https://www.google.com"";
            Thread.Sleep(3000);
            passDriver.Quit(); 

            return ""Auto"";
        }

    }
}I generate and register DLL from this and use following VFP Code:Code:myobj = CREATEOBJECT(""MyTest"")
?myobj.MyAuto()It works fine with Selenium version 3.5.2 but not with any later version than 3.5.2. It shows below error as soon as I update selenium version:Hope this helps everyone to provide some help.Thanks again."
Reply,Facing issue with Selenium version 4 and above with VFP,Premal Vala,"Dec 25, 2024 at 11:27 AM",https://www.tek-tips.com/threads/facing-issue-with-selenium-version-4-and-above-with-vfp.1832607/,Chris Miller,"Code:using OpenQA.Selenium.Chrome;For this line you'll have a refernce in your c# project- After upgrading Selenium, did you change the reference to the new Selenium version? Otherwewise you refer to a not anymore existing assembly that causes that error.In short what I'm saying is if you reference some assembly in a VS.NET project you refer to one very specific assmbly and its version. You expect this to work forever without updates, that's what's wrong. Upgrade your DLL, the code might not need any adjustment, but the reference of the assembly you link to has to change."
Reply,Facing issue with Selenium version 4 and above with VFP,Premal Vala,"Dec 25, 2024 at 11:27 AM",https://www.tek-tips.com/threads/facing-issue-with-selenium-version-4-and-above-with-vfp.1832607/,Premal Vala,"Hi Chris,Thanks again for your response. But I am updating the selenium within the VS.Net project with NuGET package, which means references are automatic updated.Also, I tried creating a DLL from completely new project of VS.NET with newer version at first go but that to leads to the same result.Thanks,PREMAL"
Reply,Facing issue with Selenium version 4 and above with VFP,Premal Vala,"Dec 25, 2024 at 11:27 AM",https://www.tek-tips.com/threads/facing-issue-with-selenium-version-4-and-above-with-vfp.1832607/,Chris Miller,Seems to be an issue of the binding to System.Text.Json and that might be an issue because of which .NET Framework version your project is based on.
Question,"Running Visual Foxpro on local Windows 10 machines, what if any adjustments are needed if I upgrade to Windows 11?",dmusicant,"Dec 22, 2024 at 8:16 PM",https://www.tek-tips.com/threads/running-visual-foxpro-on-local-windows-10-machines-what-if-any-adjustments-are-needed-if-i-upgrade-to-windows-11.1832591/,dmusicant,"I routinely run FoxPro apps, originally created in FPW 2.6 for Windows, adapted to Visual FoxPro versions up to 9.0. Both my Windows 10 64bit Lenovo P1 laptops have been problematical in that they have stopped being able to access my android phones. Seems to be something about a corrupted INF file. One of the machines, additionally, is incapable of recognizing attached USB hard drives. I figure a reinstall of Windows 10 will probably resolve those problems, perhaps an upgrade but more likely a fresh install. Given Microsoft's declared intention to cease supporting Windows 10 in October 2025, I figure it might be best to install Windows 11 now, either upgrade or fresh installs. Again, fresh a better bet to resolve the issues mentioned, but more work, of course, to install all the apps I have on the machines.My data is on my NAS and I use mostly one of the laptops, occasionally the other, never both simultaneously.A quick search indicates I may need to run WOW64 emulator to support VFP 9.This is the first I've heard of that. AFAIK, I'm not running on that emulator now, but maybe it is and I just don't know it.What am I facing here? Suggestions, explanations appreciated."
Reply,"Running Visual Foxpro on local Windows 10 machines, what if any adjustments are needed if I upgrade to Windows 11?",dmusicant,"Dec 22, 2024 at 8:16 PM",https://www.tek-tips.com/threads/running-visual-foxpro-on-local-windows-10-machines-what-if-any-adjustments-are-needed-if-i-upgrade-to-windows-11.1832591/,Chris Miller,"WOW64 is not an emulator, it's short for Windows32 On Windows64. Also seehttps://en.wikipedia.org/wiki/WoW64Every 64bit Windows version since Vista has this included and it means any 32bit applications and DLLs and drivers, etc. run in that 32bit Windows subsystem, it's included, it's not a subsystem in the sense of a Windows XP Virtual Machine that runs applications in compatibility mode in a separate XP Windows session, its native within the same Windows sessions, Windows versions except some core servers are all 32bit/64bit in parallel, CPUs likewise. By starting an EXE built in VFP9 (or indeed any 32bit executable) it runs as 32bit process and therefore in Wow64, you don't do nothing for that and you already do that on Windows 10.What your problem can be maintainig legacy 2.6 applications, even when they are ported to VFP9 projects is that you still require an even more legacy subsystem of 16bit drivers, dlls, etc. software. Not sure if Win11 is a showstopper, it's mainly just a continuation of Windows 10,8,7,Vista."
Reply,"Running Visual Foxpro on local Windows 10 machines, what if any adjustments are needed if I upgrade to Windows 11?",dmusicant,"Dec 22, 2024 at 8:16 PM",https://www.tek-tips.com/threads/running-visual-foxpro-on-local-windows-10-machines-what-if-any-adjustments-are-needed-if-i-upgrade-to-windows-11.1832591/,Tore Bleken,"To run VFP9 on a Win11 machine, whether it's 32-bit or 64-bit, just go ahead. Most likely you won't have any problem. I run the same setup on several machines, no problem at all so far. And no special things to worry about.Theonlything you should be careful about, isnotto install VFP9 in the suggested folder, since newer Windows versions have restrictions in the c:\Programxxx folders. Instead, choose a folder that's outside these folders. Personally I always use c:\vfp9.And if, heaven forbid, you should get any problems, then ask here. I don't expect to hear about any problems, but one can never be more than 99.9% sure."
Reply,"Running Visual Foxpro on local Windows 10 machines, what if any adjustments are needed if I upgrade to Windows 11?",dmusicant,"Dec 22, 2024 at 8:16 PM",https://www.tek-tips.com/threads/running-visual-foxpro-on-local-windows-10-machines-what-if-any-adjustments-are-needed-if-i-upgrade-to-windows-11.1832591/,GriffMG,"NAS may have issues... if it uses SMB1 run code in a bat file as admin...Code:dism /online /get-featureinfo /featurename:smb1protocol | find ""Status : Disabled""  && (
echo Enabling SMB1Protocol
DISM /Online /Enable-Feature /All /FeatureName:SMB1Protocol
) || (echo SMB1 Currently Enabled)

dism /online /get-featureinfo /featurename:SMB1Protocol-Deprecation | find ""Status : Enabled"" && (
echo Disabling SMB1Protocol-Depreciation
DISM /Online /Disable-Feature /All /FeatureName:SMB1Protocol-Deprecation
) || (echo SMB1-Deprecation Currently Disabled)


dism /online /get-featureinfo /featurename:recall | find ""Status : Enabled"" && (
echo Recall Being Disabled
dism /online /disable-feature /featurename:recall
) || (echo Recall Currently Disabled)"
Reply,"Running Visual Foxpro on local Windows 10 machines, what if any adjustments are needed if I upgrade to Windows 11?",dmusicant,"Dec 22, 2024 at 8:16 PM",https://www.tek-tips.com/threads/running-visual-foxpro-on-local-windows-10-machines-what-if-any-adjustments-are-needed-if-i-upgrade-to-windows-11.1832591/,GTGeek88,Nothing. The problems you report seem to be related to other problems with your machines. I moved from Win10 to Win11 with no problems in my VFP apps. It's more about getting used to the OS changes than anything at all with VFP.
Reply,"Running Visual Foxpro on local Windows 10 machines, what if any adjustments are needed if I upgrade to Windows 11?",dmusicant,"Dec 22, 2024 at 8:16 PM",https://www.tek-tips.com/threads/running-visual-foxpro-on-local-windows-10-machines-what-if-any-adjustments-are-needed-if-i-upgrade-to-windows-11.1832591/,EinTerraner,"dmusicant said:Suggestions, explanations appreciated.Click to expand...Since W07 I use a fuly installed VFP-Environment located on my Systemdrive (i.e. C:\$DEV\VFP09) including all updates/patches. To reinstall it after fresh windows installation i just paste the saved VFP-path into my system and run (as  administrator) the required post-settings likeCode:C:\$dev\VFP09\VFP9.exe /regserver
copy C:\$Dev\VFP09\_OCX\mswinsck.ocx %windir%\sysWOW64\mswinsck.ocx
copy C:\$Dev\VFP09\_OCX\comctl32.ocx %windir%\sysWOW64\comctl32.ocx
copy C:\$Dev\VFP09\_OCX\mscomct2.ocx %windir%\sysWOW64\mscomct2.ocx
copy C:\$Dev\VFP09\_OCX\mscomctl.ocx %windir%\sysWOW64\mscomctl.ocx
regsvr32 %windir%\sysWOW64\mswinsck.ocx
regsvr32 %windir%\sysWOW64\comctl32.ocx
regsvr32 %windir%\sysWOW64\mscomct2.ocx
regsvr32 %windir%\sysWOW64\mscomctl.ocx
C:\$dev\VFP09\_SP2\VFP9SP2RT_CTPI use a HP ProDesk running W07, W10 and W11Worked on W10 as well for W11. Woody has posted a comprehensive description about it in a blog.see therehttps://woody-prolib.blogspot.com/2021/"
Reply,"Running Visual Foxpro on local Windows 10 machines, what if any adjustments are needed if I upgrade to Windows 11?",dmusicant,"Dec 22, 2024 at 8:16 PM",https://www.tek-tips.com/threads/running-visual-foxpro-on-local-windows-10-machines-what-if-any-adjustments-are-needed-if-i-upgrade-to-windows-11.1832591/,Chris Miller,"Tore Bleken said:Instead, choose a folder that's outside these folders. Personally I always use c:\vfp9.Click to expand...Yes, for developing on Vista or higher, that's necessary, really.When the installer asks you for an alternative path, you can enter one. I remember it's best to create this directory before installing and then specifying it during setup, because the setup won't create it.It's also okay to install your own software outside c:\Program Files(x86), too, when you have anything writable, but it's also advisable to stick to that system directory (of course in a subdirectory for your application) and let the setup set permissions for users to enable writing to any ini or other files necessary to write to, especially of course database files. The VFP9 installer does not do that, which means some of the features of the IDE programmed in VFP code within the VFP home() folder when first run cause problems when UAC redirection causes compilation of PRGs into FXP files and other things not being stored within HOME(). Actually, that already was a problem before VIsta, too. UAC write redirection just made it worse. And up to XP you as a deeloper could overcome problems by being a member of the Administrator local group, whereas file write redirection also acts on admin accounts, even the Administrator account. So that's why it only becomes noticeable since Vista.All that's not new in Windows 11 and is a problem since Vista. The only thing that was a change from Windows 10 to 11 we discussed here in a recent thread was the system dialog for choosing a printer and make printer settings. There's also a lengthy discussion about how to handle that. If you never had problems with SYS(1037) or it's new to you this sys call should display the page setup dialog of Windows, then you can forget about that, too. It's a problem also since Vista, that this changed, there were different workarounds working in different Windows versions. You likely even print in text mode using the ?? ocmmand. or even the shell TYPE file>PRN or something like that, you must have addressed this earlier, it would have the same problems in Win11 as in Win10,8,7, or Vista."
Reply,"Running Visual Foxpro on local Windows 10 machines, what if any adjustments are needed if I upgrade to Windows 11?",dmusicant,"Dec 22, 2024 at 8:16 PM",https://www.tek-tips.com/threads/running-visual-foxpro-on-local-windows-10-machines-what-if-any-adjustments-are-needed-if-i-upgrade-to-windows-11.1832591/,Chris Miller,"One other advice when you encounter problems in a new installation on Windows 11: Verify, if you don't get the same problem on Window 10 or lower. I have expeerienced problems due to lack of documentation of necesssary settings and the best point to do anything that is needing administrative permissions to chang is to do it programmatically during setup. Which means by using the features of a setup tool like Installshiled or inno setup. Get to know how to set user permissions on to be installed files. Get to know how to write registry keys you need for your software or to register ActiveX controls and anything else needing adminstrative permissions, because it won't be sufficient for users to have administrative rights.Again, that's a problem since Vista, up to XP you could just advise to run your application with user accounts having admin permissions and procedures you do at first start in your application could do things only admins can do, or you generally rely on that. You should not need admin permissions to run a software unless it is an adminstrator tool. Any such things need to be able to be done by a basic, normal, restricted user account or, what's necessary to have elevated permissions needs to be done by a setup. And even though Inno is enabling to do more than the express edition of Installshiled coming with VFP7-, it won't allow you to run VFP code within the setup, you have to learn to use inno scripts or settings to get permissions and registration of ActiveX or your own COM Servers, etc. done.There's no replacement of a good documentation of the necessary manual steps to do, if there are, but even better make all of that automatic and done by a setup, then you also have to worry less about an OS update or reinstallation. Principles of permissions stay the same, if normal users are enabled to write to files, for example, nothing new like the degradation of admin permissions or UAC redirections can hit you. That was and is always true, not only since about 20 years."
Reply,"Running Visual Foxpro on local Windows 10 machines, what if any adjustments are needed if I upgrade to Windows 11?",dmusicant,"Dec 22, 2024 at 8:16 PM",https://www.tek-tips.com/threads/running-visual-foxpro-on-local-windows-10-machines-what-if-any-adjustments-are-needed-if-i-upgrade-to-windows-11.1832591/,tomk3,"No new problemsAs woody has written (see Post from ein terraner) you may simply copy your vfp - folder to new machine (but not in a system folder , see above , something like c:\fox or d:\develop)Then install the runtime from vfpxStart it once with VFP9.EXE /REGSERVERThats itTom"
Question,Visual FreePro Update,foxmuldr3,"Dec 11, 2024 at 7:12 PM",https://www.tek-tips.com/threads/visual-freepro-update.1832475/,foxmuldr3,"I wanted to let everyone know I had a personal life tragedy occur in late 2024.  Since then, I have not been able to work on Dori (the current version code name of Visual FreePro).  I'm not sure when I'm going to be able to resume because the change to my life is rather substantial (since late October).When I left off, Dori was around 85K lines of custom developed code, another 100K lines in 3rd party libraries (freetype, math, crypto, etc).  I had a solid framework for forms, data, reports, and networking.  About half of the functions were coded.  About 40 common commands.  Everything was in progress, moving along well, and there were no barriers to coding except for the time needed to complete it.This is the second time I've been stopped by something huge/significant when I pushed forward very hard to get this project completed.I've tried so hard to bring this project to light.  I apologize to everyone. :-(--Rick C. Hodgin"
Reply,Visual FreePro Update,foxmuldr3,"Dec 11, 2024 at 7:12 PM",https://www.tek-tips.com/threads/visual-freepro-update.1832475/,Pieter Koemans,I’m so sorry to hear about what you’re going through. I hope things get better for you soon.
Reply,Visual FreePro Update,foxmuldr3,"Dec 11, 2024 at 7:12 PM",https://www.tek-tips.com/threads/visual-freepro-update.1832475/,Joe Crescenzi,Hang in there are take care of yourself and your family.  There is nothing more important than that.
Reply,Visual FreePro Update,foxmuldr3,"Dec 11, 2024 at 7:12 PM",https://www.tek-tips.com/threads/visual-freepro-update.1832475/,Don Child,"foxmuldr3 said:I wanted to let everyone know I had a personal life tragedy occur in late 2024.  Since then, I have not been able to work on Dori (the current version code name of Visual FreePro).  I'm not sure when I'm going to be able to resume because the change to my life is rather substantial (since late October).When I left off, Dori was around 85K lines of custom developed code, another 100K lines in 3rd party libraries (freetype, math, crypto, etc).  I had a solid framework for forms, data, reports, and networking.  About half of the functions were coded.  About 40 common commands.  Everything was in progress, moving along well, and there were no barriers to coding except for the time needed to complete it.This is the second time I've been stopped by something huge/significant when I pushed forward very hard to get this project completed.I've tried so hard to bring this project to light.  I apologize to everyone. :-(--Rick C. HodginClick to expand...Take care, your time chief."
Reply,Visual FreePro Update,foxmuldr3,"Dec 11, 2024 at 7:12 PM",https://www.tek-tips.com/threads/visual-freepro-update.1832475/,trial03,"I feel sorry and thanks for the contribution. Hope everything getting better for you soon.Regrds,"
Reply,Visual FreePro Update,foxmuldr3,"Dec 11, 2024 at 7:12 PM",https://www.tek-tips.com/threads/visual-freepro-update.1832475/,Scott24x7,"Rick,Is there anything I can do to help?  Either with your setback, or the project?I've had major events in my life over the last several years as well, and I know how it can knock you on your backside.Anything, no matter how big or small, please don't hesitate to ask."
Reply,Visual FreePro Update,foxmuldr3,"Dec 11, 2024 at 7:12 PM",https://www.tek-tips.com/threads/visual-freepro-update.1832475/,Chris Miller,"While many of us surely would eagerly get on something new, there's no need to apologize for not delivering. You already made clear previously you're not sure you'll release it publicly once it's completed"", but as a library for integrating xbase like features into C/C++ programming. (https://www.tek-tips.com/threads/visual-freepro-update.1831455/)I agree with the others it's much more important you solve your problems than to have progress in VisualFreePro/Dori. I think there will still be an audience for this anytime in the future, and the active users in this forum are only the tip of an iceberg of FoxPro programmers still using it and ready to get on something that allows modernizations.As a developer of larger projects I also know how it hurts to put something down before it's ready for a release. I fortunately only had stale projects that never saw the light of the world which I put down in an early stage.All the best for your future."
Reply,Visual FreePro Update,foxmuldr3,"Dec 11, 2024 at 7:12 PM",https://www.tek-tips.com/threads/visual-freepro-update.1832475/,foxmuldr3,"Scott24x7 said:Rick,Is there anything I can do to help?  Either with your setback, or the project?I've had major events in my life over the last several years as well, and I know how it can knock you on your backside.Anything, no matter how big or small, please don't hesitate to ask.Click to expand...Thank you, Scott!  I assume since you're in this forum you're well versed in FoxPro.  Do you know C/C++ and the basics of the Win32 API?"
Reply,Visual FreePro Update,foxmuldr3,"Dec 11, 2024 at 7:12 PM",https://www.tek-tips.com/threads/visual-freepro-update.1832475/,GTGeek88,"foxmuldr3 said:foxmuldr3 said:I wanted to let everyone know I had a personal life tragedy occur in late 2024.  Since then, I have not been able to work on Dori (the current version code name of Visual FreePro).  I'm not sure when I'm going to be able to resume because the change to my life is rather substantial (since late October) . . .Click to expand...Yes, take care of yourself. What do you envision this project being? Also, how would it compare to VFP Advanced?Click to expand..."
Reply,Visual FreePro Update,foxmuldr3,"Dec 11, 2024 at 7:12 PM",https://www.tek-tips.com/threads/visual-freepro-update.1832475/,foxmuldr3,"GTGeek88 said:""Yes, take care of yourself. What do you envision this project being? Also, how would it compare to VFP Advanced?""Dori intends to be a drop-in replacement for Visual FoxPro.  99% compatibility.  It has a new forms engine, new report engine, new network abilities, new graphics abilities, new edit-and-continue debugger, in addition to supporting everything that VFP9 has today the way it has it today.  The goal is any code that runs in VFP today should run in Dori with zero change, except possibly renaming the _vfp object to _dori.Plans include porting it to GCC so it can support other architectures.  I also want to make a native Android app that runs VFP/Dori code on mobile using the same programming paradigm we have on the desktop.I think Dori will be the official release name."
Reply,Visual FreePro Update,foxmuldr3,"Dec 11, 2024 at 7:12 PM",https://www.tek-tips.com/threads/visual-freepro-update.1832475/,foxmuldr3,"Here's in general where the program's at:1. I'm working on the new forms engine.  I'm going to have all of the VFP compatible MODIFY x developer screens pop up in that new forms engine internally.  It will look very similar to our traditional VFP screens, but internally it will be using the new forms engine for all processing.  All of the legacy SCX and VCX code will come up using a format that looks like the traditional VFP-like engine.  There will also be a new ability and a MODIFX command (which will be a new extended modify command introducing the new abilities).  The legacy ones will be there, along with new features MODIFX will add.2. I'm working on getting the command environment setup so every component from any existing project can be loaded, edited, and saved back using the Dori framework.3. And the final thing I'm working on is getting all of the functions and commands working so everything operates as it does in VFP.  These will go in the order:4. Functions, commands, trivial SQL commands, and tables, indexes all fairly equally.5. Reporting features.6. Networking features.7. Non-trivial SQL commands.8. Loose ends.I would like to ask for anyone who has large SQL expressions, if you could include table structures, and SQL expressions, then I could make sure my SQL parser works with all of them.  I think that's going to be the last thing I get working 100%.  All xbase and traditional data processing commands will be done sooner, and will be able to be debugged sooner.I would like to ask for prayer if you pray, and if you do have C/C++ coding abilities, I would welcome the assistance."
Reply,Visual FreePro Update,foxmuldr3,"Dec 11, 2024 at 7:12 PM",https://www.tek-tips.com/threads/visual-freepro-update.1832475/,Scott24x7,"It's been a while foxmuldr3 but yes, I've experience in C/C++ and C#."
Question,a little confused about the transform() function problem,bharons,"Dec 17, 2024 at 6:14 AM",https://www.tek-tips.com/threads/a-little-confused-about-the-transform-function-problem.1832526/,bharons,"after I created a cursor in vfp and filled it in with some data. I found a problem with the asterix value in my report. Is there something wrong with my writing format as mentioned below?Code:create cursor skedul1 (norekening N(13), ke N(2), pokok_kr N(12), bunga_kr N(12), pokok_sd N(12))
insert into skedul1 (norekening, ke, pokok_kr, pokok_sd, bunga_kr) values (1312124120052, 1, 0, 26400, 850000)
insert into skedul1 (norekening, ke, pokok_kr, pokok_sd, bunga_kr) values (1312124120052, 2, 0, 26400, 850000)then on command button with code belowCode:select skedul1
mket01 = transform(skedul1.norekening,""999.99.9999.9999"")
mket02 = skedul1.ke
mket03 = transform(skedul1.pokok_kr,""999.999.999.999"")
mket04 = transform(skedul1.pokok_sd,""999.999.999.999"")
mket05 = transform(skedul1.bunga_kr,""999.999.999.999"")

REPORT FORM ""E:\My Foxy\Vfp8\Report\myslip.frx"" PREVIEWreport gives me an asterisk for mket01 = ***.**.****.****Meanwhile for mket02 to mket 05 there are no problems.Are there really any problems in writing my coding?I'm usingVFP 8...before and after I thank you for your guidance"
Reply,a little confused about the transform() function problem,bharons,"Dec 17, 2024 at 6:14 AM",https://www.tek-tips.com/threads/a-little-confused-about-the-transform-function-problem.1832526/,bharons,"Tore Bleken said:I think the problem is that the number is bigger than VFP can handle. Try this formula instead:Update: Store the value as a string instead, c(13), since that's what it really is. Then you can useClick to expand...i write your code at my command button and i run it.. it is work like i want..mket01 = Chrtran(transform(skedul1.norekening,""@R ###-##-####-####""),'-','.')"
Reply,a little confused about the transform() function problem,bharons,"Dec 17, 2024 at 6:14 AM",https://www.tek-tips.com/threads/a-little-confused-about-the-transform-function-problem.1832526/,costin77,Try to increase the width of the field where you see *.
Reply,a little confused about the transform() function problem,bharons,"Dec 17, 2024 at 6:14 AM",https://www.tek-tips.com/threads/a-little-confused-about-the-transform-function-problem.1832526/,Tore Bleken,"Make the fields in the report a little wider.Having said that, the expression ""999.99.9999.9999"" looks weird. What's the point of that expression?"
Reply,a little confused about the transform() function problem,bharons,"Dec 17, 2024 at 6:14 AM",https://www.tek-tips.com/threads/a-little-confused-about-the-transform-function-problem.1832526/,bharons,"thatTore Bleken said:Make the fields in the report a little wider.Having said that, the expression ""999.99.9999.9999"" looks weird. What's the point of that expression?Click to expand...expression of ""999.99.9999.9999"" is register number,like the number above 1312124120052 becomes 131.21.2412.0052After I expand the report column for that number, I still get an asterix, unless I use the transform function(@L,""999,99,9999,9999"")can appear 131,21,2412,0052looks confusing and inappropriate"
Reply,a little confused about the transform() function problem,bharons,"Dec 17, 2024 at 6:14 AM",https://www.tek-tips.com/threads/a-little-confused-about-the-transform-function-problem.1832526/,Tore Bleken,"I think the problem is that the number is bigger than VFP can handle. Try this formula instead:Chrtran(transform(skedul1.norekening,""@R ###-##-####-####""),'-','.')Click to expand...Update: Store the value as a string instead, c(13), since that's what it really is. Then you can useTransform(skedul1.norekening,""@R 999-99-9999-9999"")Click to expand..."
Reply,a little confused about the transform() function problem,bharons,"Dec 17, 2024 at 6:14 AM",https://www.tek-tips.com/threads/a-little-confused-about-the-transform-function-problem.1832526/,mjcmkrsr,"Hi,You have to use the comma instead of the dotx = 1234567891234?TRANSFORM(x, ""9999,99,999,9999"")?TRANSFORM(x, ""9999.99.999.9999"")hthMarK"
Reply,a little confused about the transform() function problem,bharons,"Dec 17, 2024 at 6:14 AM",https://www.tek-tips.com/threads/a-little-confused-about-the-transform-function-problem.1832526/,bharons,"mjcmkrsr said:Hi,You have to use the comma instead of the dotx = 1234567891234?TRANSFORM(x, ""9999,99,999,9999"")?TRANSFORM(x, ""9999.99.999.9999"")hthMarKClick to expand...After I tried changing the textbox in the report with transform(mket01,""999.99.9999.9999"")and in the command button I still use the transform function(mket01,""999,99,9999,9999"")Only then could I get the results I expected.My question is whether the coding I applied is right or wrong"
Reply,a little confused about the transform() function problem,bharons,"Dec 17, 2024 at 6:14 AM",https://www.tek-tips.com/threads/a-little-confused-about-the-transform-function-problem.1832526/,bharons,"Tore Bleken said:I think the problem is that the number is bigger than VFP can handle. Try this formula instead:Update: Store the value as a string instead, c(13), since that's what it really is. Then you can useClick to expand...After I tried changing the textbox in the report with transform(mket01,""999.99.9999.9999"")and in the command button I still use the transform function(mket01,""999,99,9999,9999"")Only then could I get the results I expected.My question is whether the coding I applied is right or wrong"
Reply,a little confused about the transform() function problem,bharons,"Dec 17, 2024 at 6:14 AM",https://www.tek-tips.com/threads/a-little-confused-about-the-transform-function-problem.1832526/,bharons,I use this transform function..
Reply,a little confused about the transform() function problem,bharons,"Dec 17, 2024 at 6:14 AM",https://www.tek-tips.com/threads/a-little-confused-about-the-transform-function-problem.1832526/,Tore Bleken,"The coding looks fine, but you must use the right data type. In this case 1312124120052 is NOT a number, it's a string.From VFP's help,https://www.vfphelp.com/vfp9/_5wn12pc8v.htm: Maximum value of an integer: 2,147,483,647"
Reply,a little confused about the transform() function problem,bharons,"Dec 17, 2024 at 6:14 AM",https://www.tek-tips.com/threads/a-little-confused-about-the-transform-function-problem.1832526/,bharons,"Tore Bleken said:The coding looks fine, but you must use the right data type. In this case 1312124120052 is NOT a number, it's a string.From VFP's help,https://www.vfphelp.com/vfp9/_5wn12pc8v.htm: Maximum value of an integer: 2,147,483,647Click to expand...string? i add that value from sql server, with datatype decimal. and thank so much for info about maximum value."
Reply,a little confused about the transform() function problem,bharons,"Dec 17, 2024 at 6:14 AM",https://www.tek-tips.com/threads/a-little-confused-about-the-transform-function-problem.1832526/,mjcmkrsr,"Hi,The INTEGER field type accepts values up to 2,147,483,647 but a numeric field type accepts values between these limits - .9999999999E+19 to .9999999999E+20Check ""Visual FoxPro Data and Field Types"" in the Help FilehthMarK"
Reply,a little confused about the transform() function problem,bharons,"Dec 17, 2024 at 6:14 AM",https://www.tek-tips.com/threads/a-little-confused-about-the-transform-function-problem.1832526/,Tore Bleken,"First of all, VFP can't handle such numbers, period. And it's no use to store it as a number anyway, you don't do any calculations with it. So just learn from our experience, and use a string, C(13), instead.If it's stored on a SQL server as a number, and you don't have any control of it, then use SQL's Cast() function to convert it to a string."
Reply,a little confused about the transform() function problem,bharons,"Dec 17, 2024 at 6:14 AM",https://www.tek-tips.com/threads/a-little-confused-about-the-transform-function-problem.1832526/,bharons,"Tore Bleken said:I think the problem is that the number is bigger than VFP can handle. Try this formula instead:Update: Store the value as a string instead, c(13), since that's what it really is. Then you can useClick to expand...i write your code at my command button and i run it.. it is work like i want..mket01 = Chrtran(transform(skedul1.norekening,""@R ###-##-####-####""),'-','.')"
Reply,a little confused about the transform() function problem,bharons,"Dec 17, 2024 at 6:14 AM",https://www.tek-tips.com/threads/a-little-confused-about-the-transform-function-problem.1832526/,bharons,"Tore Bleken said:First of all, VFP can't handle such numbers, period. And it's no use to store it as a number anyway, you don't do any calculations with it. So just learn from our experience, and use a string, C(13), instead.If it's stored on a SQL server as a number, and you don't have any control of it, then use SQL's Cast() function to convert it to a string.Click to expand...With VFP I understand a little about CRUD commands, data manipulation, and now I am faced with an ODBC SQL Server based online system, I can be sure that I don't really understand CRUD SQL Server."
Reply,a little confused about the transform() function problem,bharons,"Dec 17, 2024 at 6:14 AM",https://www.tek-tips.com/threads/a-little-confused-about-the-transform-function-problem.1832526/,Tore Bleken,"In this case, instead of Select ... norekening ... from ..., you write Select ... cast(norekening as char(13)) as norekening ... from .... This will make sure that the field is returned as a string, and your problem is gone."
Reply,a little confused about the transform() function problem,bharons,"Dec 17, 2024 at 6:14 AM",https://www.tek-tips.com/threads/a-little-confused-about-the-transform-function-problem.1832526/,Chris Miller,"CRUD stands for CREATE, READ, UPDATE, DELETE, but most of the time is not only about these actions only, but about using http requests for that. POST or PUT for creating, GET for reading, POST or PUT for updating, and DELETE for deleting.With SQL Server you don't use http requests, you make an ODBC connection and send SQL. SQL also has queries for CREATing records (INSERT), for READING records (SELECT), for updating records (UPDATE) and for deleting them (DELETE). This compares to CURD in the way the four actions are available, because how could you have anything else? Even if you use pen and paper you create ""data"" by using the pen on the paper, can read the paper, you can strike thru and write something else (update) and you can throw away the paper. So these four basic actions always exist, technologically or not, about data, you can't avoid that.But the main thinking of SQL differs very much from CRUD. CRUD uses a URI as an identifgier of a resource that's located at that URI, that can be something like a single value, a record in json format or XML, a whole json document, etc, whereas SQL is all about tables in databases, the SQL cares mostly about records, but not just a single record in many cases (i.e. with SELECT you can select a whole table, even join muiltiple tables). The data is not organized at some URI but within a database and tables within the database.So they compare, but differ very much at the same time. Don't think about CRUD when you think about databases, because databases work by SQL, some NOSQL databases working more closely to the CRUD principle also exist, but MSSQL Server is a relational database management system (RDBMS) and while data is commmon to both principles and sql also is about the actions of creating, reading, updating and deleting data (the data lifecycle) the means to do that differ very much. Think alone about SELCT enabling you to pick from the range of a single fiield of a single record to multiple joined tables of data. You're not comparing apples with oranges but apples with spacestations."
Reply,a little confused about the transform() function problem,bharons,"Dec 17, 2024 at 6:14 AM",https://www.tek-tips.com/threads/a-little-confused-about-the-transform-function-problem.1832526/,Chris Miller,"The confusion you have is not about TRANSFORM, it's not knowing enough basics of data types. SQL Server can store much larger numbers than VFP can in integer form, biginteger, for example. So there's one more aspect of a difference between SELECT SQL and CRUDs READ request. While you SELECT from a database table, you can apply conversion functions,whereas a GET https request for a READ operation just GETs what's stored as is.You looking at the transform failing for your case, while it's likely the getting of data in the SQL table exceeding what VFP can process as a number with 13 or 14 digits. With MySQL ODBC drivers you have the option to get bigints as integers, that works in the range of integers and won't help with 14 or 14 digit long numbers, with SQL Server you don't even have that option, so you do CONVERT within the SQL you execute to read the data and get it as a string, so you don't have to do that conversion on the VFP side with a number that's not right to begin with.There are many details involved in all of this, but you fail on them, because you lack the basics. Knowing datatypes, knowing their limitations, choosing the right ones for the job and how to convert them into each other. Where which conversions happen indirectly automatically and when that fails.You're also lacking the ability to look further up the chain of logic that leads to an error. If you look for the cure of an error reported at a line of code only in that line of code, you never get easier resolving of problems that stem from further up in the process, i.e. choosing the right data type for coluns of the SQL Server tables or - if that's not in your control - at least converting them as necessary when you read them with an SQL SELECT query.By the way, VFP does not choke on 14 digit numbers, in code likeCode:x=12345678901234It doesn't read this as an integer number, even though it has no decimal places and no decimal point. It's also not only because it's beyond the range of a maximum signed 32 nbit integer that it's treated as double floating point number and can be put into x, it's because in variables numeric data is always the double float data type, even if you read it from an integer field type. And you can then transform it into a string, no problem.But if the source of x is fromm SQL Server, then look closely at the column it comes from, how that's defined, the ODBC transpport of that value and how it arrives, and then what data type it is in the cursor field. There can be conversions you don't see and therefore fail on them.There is a maximum precise integer range in double float numbers, that's a range larger than the 32bit integer range. Let's look at an example:? 12345678901234561? 12345678901234562? 12345678901234563Click to expand...If you do these ? commands from the command window you get displayed the same number 12345678901234560 for all three lines.And you don't get any error. So that's also a case of needing to deal with things even though no error is triggered.What's happening? Well, you would know, if you really learn and dig into what happens when code is executed. The first step of code execution is alwayas turning the input that is the text you write, the question mark and all the digits, into execuatable machine code that's then running on a CPU or GPU, depending on programming language, interpreter, compiler, whatever. So the digits 12345678901234561 are not simply output as they come as input, they are turned into a digital number with bits. As said, double floating point. If you don't know the details, that's your problem, because your expectation is that it's simple to reproduce the input as output and 117 digits is just 17 bytes. We're in the age of GB, so where's the problem. The problem is you don't know a lot of things and you don't dig into it."
Reply,a little confused about the transform() function problem,bharons,"Dec 17, 2024 at 6:14 AM",https://www.tek-tips.com/threads/a-little-confused-about-the-transform-function-problem.1832526/,Chris Miller,"And then there's a last aspect, even if you consider technical possibilities it's not always sensible, what's technically possible. You can, for example eat poisoned food. But just beacause you can technically chew on it and swallow it, it's not working well, is it? Only some poisons will alarm you with a bad smell or bitter or otherwise unpleasant taste.That's about the point Tore made about whether it's sensible to store an identifier like an account number into a numeric field, just because it's called a number and only consists of digits. Even within the range processible it makes no sense to store an identifier number as a number. And like your senses don't protect you from all poisons, you don't get error messages indicating mistakes to address.Operations you need more often about an account number is cutting out pieces, like the last 4 digits or the first 5. Depending on your countries banking system the formatting with dashes or points within the account is there to indicate portions of the account number that have a detail meaning. But you never need to sum account numbers or multiply or take the square root, in short, you don't calculate with account numbers, you calculate with an account balance, but not the account number. So even in the range of integer, big integer, double floating point or other numeric data types, account numbers are not mathematical numbers, they are an identifier and you best store them as string, even if that takes more bytes to store than as a number. You avoid conflicts and unintentional errors and you enable the operations you rather need than calculations, like cutting out parts of them. Or formatting them with some commas, points or dashes or whatever else."
Reply,a little confused about the transform() function problem,bharons,"Dec 17, 2024 at 6:14 AM",https://www.tek-tips.com/threads/a-little-confused-about-the-transform-function-problem.1832526/,Chris Miller,"And even with all that in mind. The different formatting characters are explained in the help documentation of TRANSFORM, and the dot ""."" has the meaning of decimal point in formatting a number to a string. There always is only one decimal point, so it'll only be taken into account the first time it appears in the format string. If you want to have a dot in multiple places, you're lost with TRANSFORM, as the dot has only one meaning for decimal point. Characters that you can use as spllitting characters are any that have no formatting meaning. So you're limited with the formatting as some characters have special meaning and can only be used for that special meaning and nothing else, not as literally themselves, in many cases.Even the first dot may not show as a dot, what matters is what you have in SET(""POINT""), and when you use SET SYSFORMATS on that'll be determined by system (Windows) settings for the decimal point. In many countries that's not the point but the comma. And what shows in places of a formatting character "","" is the thousands separator, which in UK/US would be a comma, typpically, in countries where the decimal point is a comma it's the point, typically, so the two characters in the result are swapped. Still the format mask always has to use the dot or point (.) for the decimal point and comma (,) for thousands separator.Since a number can get into millions, billions, trillions, etc. you can put multiple commas, multiple thousands separators into a format string, and you don't even have to space them between groups of three 9s. That makes it quite like comma is no special format character, but if your number is below a magnitude needing multiple separators, they don't show in whitespace, they only appear once they are needed for larger numbers. That's the way they are special format characters.What remains is, that you can use many characters as literally just themselves appearing in the result of the transformation, but not the characters that have format functionality. So if you need literally have commas and points in the end result, you have to put them in post processing of the TRANSFORM result."
Question,VFP App menuing system not work in RDC app on iOS,GTGeek88,"Dec 16, 2024 at 8:38 PM",https://www.tek-tips.com/threads/vfp-app-menuing-system-not-work-in-rdc-app-on-ios.1832522/,GTGeek88,Redirecting
Reply,VFP App menuing system not work in RDC app on iOS,GTGeek88,"Dec 16, 2024 at 8:38 PM",https://www.tek-tips.com/threads/vfp-app-menuing-system-not-work-in-rdc-app-on-ios.1832522/,GriffMG,ok.. probably no right mouse button...
Reply,VFP App menuing system not work in RDC app on iOS,GTGeek88,"Dec 16, 2024 at 8:38 PM",https://www.tek-tips.com/threads/vfp-app-menuing-system-not-work-in-rdc-app-on-ios.1832522/,GTGeek88,"GriffMG said:ok.. probably no right mouse button...Click to expand...What? Not sure what you are talking about.Also, can you see any text in my original post? It was definitely there, but I don't see it now. Some Tek-Tips screw-up I guess. Hopefully you can see it."
Reply,VFP App menuing system not work in RDC app on iOS,GTGeek88,"Dec 16, 2024 at 8:38 PM",https://www.tek-tips.com/threads/vfp-app-menuing-system-not-work-in-rdc-app-on-ios.1832522/,Chris Miller,"can you see any text in my original post?Click to expand...You accidentally started two posts. Seehttps://www.tek-tips.com/forums/microsoft-foxpro.184/You can delete this one (""VFP App menuing system not work in RDC app on iOS "")To edit a post there's ""Edit"" in the buttom of a post, if it's fresh, the editing option is removed, when a post is older than a day, perhaps even a few hours only, I have not yet looked at how long editing is available, but for fresh posts it is."
Question,Arduino or other board with Microsoft Foxpro,JacobR92,"Dec 10, 2024 at 2:32 PM",https://www.tek-tips.com/threads/arduino-or-other-board-with-microsoft-foxpro.1832451/,JacobR92,"Hi,I would like to know if i can read an arduino sketch or other microntroller on Microsoft Foxpro.My objective is read the data in foxpro with a plot sended from a board. Is it possible to do?thanks to advance"
Reply,Arduino or other board with Microsoft Foxpro,JacobR92,"Dec 10, 2024 at 2:32 PM",https://www.tek-tips.com/threads/arduino-or-other-board-with-microsoft-foxpro.1832451/,A_Radiolog_inFoxPro,"Hello ,Yes you can, you need a seral output from your controller and a procedure on Foxpro to get the Raw data from the micro and well process them.Need to receive data from Serial Port  - Microsoft: FoxProHi  I need to receive the data from a weighing machine which sends in 15 characters alphanumeric format.  Kindly let me know the code in Foxpro for DOS or in C.  Thanks.www.tek-tips.comHere is a start"
Reply,Arduino or other board with Microsoft Foxpro,JacobR92,"Dec 10, 2024 at 2:32 PM",https://www.tek-tips.com/threads/arduino-or-other-board-with-microsoft-foxpro.1832451/,Joe Crescenzi,"I've never used devices like that with FoxPro, but as long as you can communicate with it via a standard protocol, you should be able to open a connection to it using some standard protocol like http or ftp.For example if it uses http, you can create an object to talk to it using CREATEOBJECT(""WinHttp.WinHttpRequest.5.1"")."
Reply,Arduino or other board with Microsoft Foxpro,JacobR92,"Dec 10, 2024 at 2:32 PM",https://www.tek-tips.com/threads/arduino-or-other-board-with-microsoft-foxpro.1832451/,Pieter Koemans,"You can communicate with the Arduino using the MSComm32 control in Visual FoxPro. Make sure to register it using the regsvr32 command.Then, check the COM port assigned to the Arduino in the Windows Device Manager to identify the correct port to use.sample foxpro:PUBLIC oFormoForm = CREATEOBJECT(""Form"")oForm.ADDOBJECT(""comm"", ""olecontrol"", ""MSCommLib.MSComm"")WITH oForm.comm.CommPort = 1 && Set to your COM port number.Settings = ""9600,N,8,1"" && Match baud rate and settings.PortOpen = .T. && Open the portENDWITH* Send ""Hello World"" to ArduinooForm.comm.Output = ""Hello World"" + CHR(13) + CHR(10)arduino side:void setup() {Serial.begin(9600); // Set baud rate to 9600}void loop() {if (Serial.available() > 0) {String data = Serial.readStringUntil('\n');Serial.println(""Received: "" + data); // Echo received data back to Visual FoxPro}}"
Reply,Arduino or other board with Microsoft Foxpro,JacobR92,"Dec 10, 2024 at 2:32 PM",https://www.tek-tips.com/threads/arduino-or-other-board-with-microsoft-foxpro.1832451/,JacobR92,Pieter KoemansProgrammer​the process seems to work. Thank you!If i want to visualize the data send to my Board with the sensor. What can i do?
Reply,Arduino or other board with Microsoft Foxpro,JacobR92,"Dec 10, 2024 at 2:32 PM",https://www.tek-tips.com/threads/arduino-or-other-board-with-microsoft-foxpro.1832451/,Pieter Koemans,"Foxpro isn't fast enough to render graphs in realtime. For that you should use activex controls.But you can ""catch"" data in the background and plot it with foxcharts.To catch data in the background make sure you use the oncomm event in mscomm32"
Reply,Arduino or other board with Microsoft Foxpro,JacobR92,"Dec 10, 2024 at 2:32 PM",https://www.tek-tips.com/threads/arduino-or-other-board-with-microsoft-foxpro.1832451/,JacobR92,Thanks!I would like to ask one last thing.With Which active X control or External library can I do the graph and read the data?
Reply,Arduino or other board with Microsoft Foxpro,JacobR92,"Dec 10, 2024 at 2:32 PM",https://www.tek-tips.com/threads/arduino-or-other-board-with-microsoft-foxpro.1832451/,Pieter Koemans,That depends on what output rate your arduino is and also how fast you want to update..What is your application?
Reply,Arduino or other board with Microsoft Foxpro,JacobR92,"Dec 10, 2024 at 2:32 PM",https://www.tek-tips.com/threads/arduino-or-other-board-with-microsoft-foxpro.1832451/,JacobR92,My application consists to connect a string pot to arduino and find the data of position and put all in a plot.I know there are other applications to do this kind of work.but I feel much better with foxpro because later I could also compile it and make it become an exe.
Reply,Arduino or other board with Microsoft Foxpro,JacobR92,"Dec 10, 2024 at 2:32 PM",https://www.tek-tips.com/threads/arduino-or-other-board-with-microsoft-foxpro.1832451/,David Higgs,"Pieter Koemans said:You can communicate with the Arduino using the MSComm32 control in Visual FoxPro. Make sure to register it using the regsvr32 command.Then, check the COM port assigned to the Arduino in the Windows Device Manager to identify the correct port to use.sample foxpro:PUBLIC oFormoForm = CREATEOBJECT(""Form"")oForm.ADDOBJECT(""comm"", ""olecontrol"", ""MSCommLib.MSComm"")WITH oForm.comm.CommPort = 1 && Set to your COM port number.Settings = ""9600,N,8,1"" && Match baud rate and settings.PortOpen = .T. && Open the portENDWITH* Send ""Hello World"" to ArduinooForm.comm.Output = ""Hello World"" + CHR(13) + CHR(10)arduino side:void setup() {Serial.begin(9600); // Set baud rate to 9600}void loop() {if (Serial.available() > 0) {String data = Serial.readStringUntil('\n');Serial.println(""Received: "" + data); // Echo received data back to Visual FoxPro}}Click to expand...Thank you for posting the code, some food for thought in there for me!"
Reply,Arduino or other board with Microsoft Foxpro,JacobR92,"Dec 10, 2024 at 2:32 PM",https://www.tek-tips.com/threads/arduino-or-other-board-with-microsoft-foxpro.1832451/,Pieter Koemans,"David Higgs said:Thank you for posting the code, some food for thought in there for me!Click to expand...Yes, it is one of the quickest ways to integrate IoT into VFP."
Reply,Arduino or other board with Microsoft Foxpro,JacobR92,"Dec 10, 2024 at 2:32 PM",https://www.tek-tips.com/threads/arduino-or-other-board-with-microsoft-foxpro.1832451/,David Higgs,I use VFP for my Amateur Radio application (Logbook Database and Radio Transceiver Control using MSComm) and I am in the process of building an Arduino Application that will also send commands to the Radio Transceiver via the VFP Application (to avoid a COM Port conflict).
Reply,Arduino or other board with Microsoft Foxpro,JacobR92,"Dec 10, 2024 at 2:32 PM",https://www.tek-tips.com/threads/arduino-or-other-board-with-microsoft-foxpro.1832451/,JacobR92,"ok thank you!Now I'm in a slightly different situation.The work done before was cancelled. However, I managed to get the Arduino code to insert and the Foxpro code.I share it many times if it helps someone.the problem at the moment is being able to see the data coming out of the Arduino.What tool can I use to see what comes out of Mscomm and the Arduino board?I'll explain better. Instead of implementing them in a graph (as I said before) I could see the data arrive on a display or table.What can I use?And above all, how can I implement this tool for receiving data from my Arduino sensor?the code:sample foxpro:PUBLIC oFormoForm = CREATEOBJECT(""Form"")oForm.ADDOBJECT(""comm"", ""olecontrol"", ""MSCommLib.MSComm"")WITH oForm.comm.CommPort = 1 && Set to your COM port number.Settings = ""9600,N,8,1"" && Match baud rate and settings.PortOpen = .T. && Open the portENDWITH* Send ""Hello World"" to ArduinooForm.comm.Output = ""Hello World"" + CHR(13) + CHR(10)arduino side:void setup() {Serial.begin(9600); // Set baud rate to 9600}void loop() {if (Serial.available() > 0) {String data = Serial.readStringUntil('\n');Serial.println(""Received: "" + data); // Echo received data back to Visual FoxPro}}"
Reply,Arduino or other board with Microsoft Foxpro,JacobR92,"Dec 10, 2024 at 2:32 PM",https://www.tek-tips.com/threads/arduino-or-other-board-with-microsoft-foxpro.1832451/,Pieter Koemans,"To gain a better understanding of how to process the data, it would be helpful if you could share the data format that you're sending from the Arduino to FoxPro."
Reply,Arduino or other board with Microsoft Foxpro,JacobR92,"Dec 10, 2024 at 2:32 PM",https://www.tek-tips.com/threads/arduino-or-other-board-with-microsoft-foxpro.1832451/,JacobR92,"Pieter Koemans​Sorry, I explained me badly.At the moment i am not able to see the data.How tool can I use for see the data send from my arduino board?A query? A graph? And if I send the data on foxpro, where I put the code for foxpro?"
Reply,Arduino or other board with Microsoft Foxpro,JacobR92,"Dec 10, 2024 at 2:32 PM",https://www.tek-tips.com/threads/arduino-or-other-board-with-microsoft-foxpro.1832451/,Pieter Koemans,"You can view the data in the Serial Monitor of the Arduino IDE. All output you send to Visual FoxPro while streaming the data should be visible in the built-in Serial Monitor function of the Arduino IDE. If you do not see the data in the Serial Monitor, then FoxPro will not see the data either.To open the Serial Monitor and view the data:Make sure you have included Serial.begin(9600); in the setup() function of your Arduino sketch.Upload your sketch to the Arduino.Click on the Serial Monitor icon in the top right corner of the Arduino IDE.Set the baud rate in the Serial Monitor to the same value as in your sketch (for example, 9600).If you use Serial.print(""Hello world"") or Serial.println(""hello world"") in your Arduino code, the output will appear in the Serial Monitor window"
Question,VFP app menus don't work in RDC in iOS,GTGeek88,"Dec 16, 2024 at 8:45 PM",https://www.tek-tips.com/threads/vfp-app-menus-dont-work-in-rdc-in-ios.1832523/,GTGeek88,"When running a VFP 9 SP 2 app in the MS Remote Desktop Connection app on iOS (iPad Mini) connecting to a Win2019 server, the drop down menu system (which uses the standard VFP menus) often (mostly) don't work. They won't drop down (sometimes they do, but I can't figure out why sometimes - not often - and not all the time). Others have run into this, it seems, and not necessarily using VFP. Here's an example:RedirectingHas anyone seen this and do you have any fixes or suggestions to get the menus working properly in this environment.Thanks!"
Question,Quickbooks QBFC16 SDK 64 bit usage from VFP9/VFPA,BugZap13,"Dec 16, 2024 at 5:44 PM",https://www.tek-tips.com/threads/quickbooks-qbfc16-sdk-64-bit-usage-from-vfp9-vfpa.1832521/,BugZap13,"Has anyone gotten around the QuickBooks 64 bit versions (2022+) and their 64 bit SDK's (QBFC15_)?Desktop versions of Quickbooks versions 2022+ are now 64 bit.  Their SDK's since QBFC15 are also 64 bit.This is explained in the following post in more detail (https://www.tek-tips.com/search/18416710).It has been more than a year and was wondering if anyone has gotten past calling the SDK from VFP9.  In the post mentioned above, a suggestion was to use VFPA (VFP Advanced).Has anyone gotten this to work."
Reply,Quickbooks QBFC16 SDK 64 bit usage from VFP9/VFPA,BugZap13,"Dec 16, 2024 at 5:44 PM",https://www.tek-tips.com/threads/quickbooks-qbfc16-sdk-64-bit-usage-from-vfp9-vfpa.1832521/,GTGeek88,I have not tried their SDKs directly. I am presently using Transaction Pro from Rightworks. VFPA seems like it might work.
Question,Insert data of Arduino on a plot,JacobR92,"Dec 14, 2024 at 5:48 PM",https://www.tek-tips.com/threads/insert-data-of-arduino-on-a-plot.1832510/,JacobR92,"Good evening,I have a question about Foxpro. My objective is implement a plot with the data sent from Arduino board.I would like to do everything with Foxpro 9.0 and the library foxcharts.I have the code for send the data from Arduino to Foxpro. But i don't know how to implement the plot.Can anyone help me?Thanks in advance"
Reply,Insert data of Arduino on a plot,JacobR92,"Dec 14, 2024 at 5:48 PM",https://www.tek-tips.com/threads/insert-data-of-arduino-on-a-plot.1832510/,atlopes,"Jacob,How is the data formatted?"
Reply,Insert data of Arduino on a plot,JacobR92,"Dec 14, 2024 at 5:48 PM",https://www.tek-tips.com/threads/insert-data-of-arduino-on-a-plot.1832510/,Chris Miller,"Here's an introduction article on Foxcharts:https://doughennig.com/papers/Pub/FoxCharts.pdfAs shown already in the first example of a bar chart a fox chart takes a workarea as data source:See On Page 4.SourceAlias = 'ChartData'So it's quite simple to use.Go tohttps://github.com/VFPX/FoxChartsClick on the green Code button and pick ""Download ZIP"" and you have the FoxCharts including source code and oneFoxCharts Documentation - A Tutorial.docwhich documents all you need to know in the first place."
Reply,Insert data of Arduino on a plot,JacobR92,"Dec 14, 2024 at 5:48 PM",https://www.tek-tips.com/threads/insert-data-of-arduino-on-a-plot.1832510/,JacobR92,atlopes​What do you mean by how the data is formatted?​
Reply,Insert data of Arduino on a plot,JacobR92,"Dec 14, 2024 at 5:48 PM",https://www.tek-tips.com/threads/insert-data-of-arduino-on-a-plot.1832510/,JacobR92,"Chris Miller​I have already installed the file,Thanks for the advice on the manual page"
Reply,Insert data of Arduino on a plot,JacobR92,"Dec 14, 2024 at 5:48 PM",https://www.tek-tips.com/threads/insert-data-of-arduino-on-a-plot.1832510/,Chris Miller,"Can you let the Arduino board do its job and send or receive data as you have established and then put that into a cursor or DBF? Split it up into time vs signal value and you have your plot coordinates. And then the question is whether this comes over as integers, floats, strings, with dot or comma as decimal point, with scientific notification (1e-9, for example) or not, etc.In the end you better prepare to have some numeric values for both plot axes, no matter if you want a barchart, a line chart or whatever, you need coordinates and one obviously is the time of measurement and the other is your measurement, isn't it?"
Reply,Insert data of Arduino on a plot,JacobR92,"Dec 14, 2024 at 5:48 PM",https://www.tek-tips.com/threads/insert-data-of-arduino-on-a-plot.1832510/,JacobR92,"Chris Miller​Can you let the Arduino board do its job and send or receive data as you have established and then put that into a cursor or DBF?I need to implement my project on a DBF.In the end you better prepare to have some numeric values for both plot axes, no matter if you want a barchart, a line chart or whatever, you need coordinates and one obviously is the time of measurement and the other is your measurement, isn't it?Yes. i need to insert the data from an arduino board connected to a string pot.And manipolate the data of the chart."
Reply,Insert data of Arduino on a plot,JacobR92,"Dec 14, 2024 at 5:48 PM",https://www.tek-tips.com/threads/insert-data-of-arduino-on-a-plot.1832510/,Chris Miller,"JacobR92 said:I need to implement my project on a DBF.Click to expand...I said cursor or DBF, so DBF is fine.JacobR92 said:i need to insert the data from an arduino board connected to a string pot.Click to expand...You said you have the part done about receiving the data from the Arduino board. So when that's done you have the data. To plot that is completely independent, so what's your problem, now? Understanding the foxcharts component?"
Reply,Insert data of Arduino on a plot,JacobR92,"Dec 14, 2024 at 5:48 PM",https://www.tek-tips.com/threads/insert-data-of-arduino-on-a-plot.1832510/,JacobR92,"You said you have the part done about receiving the data from the Arduino board. So when that's done you have the data. To plot that is completely independent, so what's your problem, now? Understanding the foxcharts component?My problem si I can't make a display or graph with which to see the data. In particular for the graph I wouldn't know how to implement it programmatically.How can I implement code that makes me see data on a graph?"
Reply,Insert data of Arduino on a plot,JacobR92,"Dec 14, 2024 at 5:48 PM",https://www.tek-tips.com/threads/insert-data-of-arduino-on-a-plot.1832510/,Chris Miller,"You've been pointed to foxcharts examples and documentation. It visualizes data in any way you want - pie chart, bar graph, line graph, scatter plot, whatever.https://doughennig.com/papers/Pub/FoxCharts.pdfis a good introduction. So click on the link and read the PDF, apply it on your computer and get it going. Don't just copy and paste code and try to run it, read the text and follow the instructions step by step and you get going with foxcharts and learn to apply it to the northwind sample data you have in your VFP installation and later to your own data."
Reply,Insert data of Arduino on a plot,JacobR92,"Dec 14, 2024 at 5:48 PM",https://www.tek-tips.com/threads/insert-data-of-arduino-on-a-plot.1832510/,JacobR92,"ok thank you!Now I'm in a slightly different situation.The work done before was cancelled. However, I managed to get the Arduino code to insert and the Foxpro code.I share it many times if it helps someone.the problem at the moment is being able to see the data coming out of the Arduino.What tool can I use to see what comes out of Mscomm and the Arduino board?I'll explain better. Instead of implementing them in a graph (as I said before) I could see the data arrive on a display or table.What can I use?And above all, how can I implement this tool for receiving data from my Arduino sensor?the code:sample foxpro:PUBLIC oFormoForm = CREATEOBJECT(""Form"")oForm.ADDOBJECT(""comm"", ""olecontrol"", ""MSCommLib.MSComm"")WITH oForm.comm.CommPort = 1 && Set to your COM port number.Settings = ""9600,N,8,1"" && Match baud rate and settings.PortOpen = .T. && Open the portENDWITH* Send ""Hello World"" to ArduinooForm.comm.Output = ""Hello World"" + CHR(13) + CHR(10)arduino side:void setup() {Serial.begin(9600); // Set baud rate to 9600}void loop() {if (Serial.available() > 0) {String data = Serial.readStringUntil('\n');Serial.println(""Received: "" + data); // Echo received data back to Visual FoxPro}}"
Reply,Insert data of Arduino on a plot,JacobR92,"Dec 14, 2024 at 5:48 PM",https://www.tek-tips.com/threads/insert-data-of-arduino-on-a-plot.1832510/,Chris Miller,"You should solve thqat problem in the other thread you dedicated to the data transfer, so Pieter Koemans sees you have a question about his code.You should receive data into a DBF first, because that's the basis of foxcharts, a workarea with data. If you want to plot while you receive, the data retrieval and graph generation can be interleaved, if you take a closer look into the foxcharts code it has a line .DrawChart()While you receive data and add more and more data points into the DBF you call that and the plot gets updated.You already cut your problem into two separate parts, stay with this and interleave the two things at the end. Get one thing going after the other. If you start with the data retrieval part and not the chart, then have a browse of the DBF you use for store the incoming data and that'll be your first developer view on the data treceival process. There is no need to solve two problems at once."
Question,Update Data SQL server Using Create Cursor VFP,bharons,"Dec 13, 2024 at 2:09 AM",https://www.tek-tips.com/threads/update-data-sql-server-using-create-cursor-vfp.1832495/,bharons,"Dear Expert...I use VFP8 for SQL Server data processing,I have a question, how to code or script to update data in SQL Server using Create Cursor VFP.For example, below is the script that I use.Code:create cursor skedul1 (norekening N(13), ke N(2), pokok_kr N(12), bunga_kr N(12), pokok_sd N(12))
SET SAFETY OFF
SELECT     skedul1
ZAP
SET SAFETY ON
insert into skedul1 (norekening, ke, pokok_kr, pokok_sd, bunga_kr) values (1312124120052, 1, 0, 26400, 850000)
insert into skedul1 (norekening, ke, pokok_kr, pokok_sd, bunga_kr) values (1312124120052, 2, 0, 26400, 850000)
insert into skedul1 (norekening, ke, pokok_kr, pokok_sd, bunga_kr) values (1312124120052, 3, 0, 26800, 850000)
insert into skedul1 (norekening, ke, pokok_kr, pokok_sd, bunga_kr) values (1312124120052, 4, 0, 26400, 850000)
insert into skedul1 (norekening, ke, pokok_kr, pokok_sd, bunga_kr) values (1312124120052, 5, 0, 25500, 850000)
insert into skedul1 (norekening, ke, pokok_kr, pokok_sd, bunga_kr) values (1312124120052, 6, 850000, 26400, 0)

select skedul1
m.value1 = skedule1.norekening
m.value2 = skedule1.ke
m.value3 = skedule1.pokok_kr
m.value4 = skedule1.pokok_sd
m.value5 = skedule1.bunga_kr

    TEXT TO m.lcSQL TEXTMERGE noshow
    UPDATE dbo.skedul
        SET pokok_kr = ?m.value3,
        pokok_sd = ?m.value4,
        bunga_kr = ?m.value5
        WHERE norekening = ?m.value1 and ke = ?m.value2
    ENDTEXTwhen I run this script, why only the first line can change..i need solution..also if i use this skrip i got warning that :Connectivity error: [Miscrosoft][ODBC SQL Server Drive][SQL Server] Invalid Object Name 'skedul1'below script that i used for update value on my SQL ServerCode:Select skedul1
m.value1 = skedul1.norekening
m.value2 = skedul1.ke
m.value3 = skedul1.pokok_kr
m.value4 = skedul1.pokok_sd
m.value5 = skedul1.bunga_kr

    TEXT TO m.lcSQL TEXTMERGE noshow
    UPDATE dbo.skedul
        SET pokok_kr = ?m.value3,
        pokok_sd = ?m.value4,
        bunga_kr = ?m.value5
        FROM [skedul1]
        WHERE rekening = ?m.value1 and ke = ?m.value2
    ENDTEXT       

lnResult = SQLExec(Thisform.nHandle, m.lcSQL)
If m.lnResult < 0
    Aerror(aWhy)
    Messagebox(aWhy[2])
    SQLDisconnect(0)
    Return .F.
Else
    Messagebox(""Data Telah Update..!!"")
    thisform.PopulateGrid()
    thisform.grid2.RecordSource = """"
EndifThank you for the advice and enlightenment from the experts on this forum.."
Reply,Update Data SQL server Using Create Cursor VFP,bharons,"Dec 13, 2024 at 2:09 AM",https://www.tek-tips.com/threads/update-data-sql-server-using-create-cursor-vfp.1832495/,Chris Miller,"bharons said:when I run this script, why only the first line can change..Click to expand...Because this code only copies the current record into variables:Code:select skedul1
m.value1 = skedule1.norekening
m.value2 = skedule1.ke
m.value3 = skedule1.pokok_kr
m.value4 = skedule1.pokok_sd
m.value5 = skedule1.bunga_krYou need to do this repeatedly in a SCAN...ENDSCAN loopbharons said:also if i use this skrip i got warning that :Connectivity error: [Miscrosoft][ODBC SQL Server Drive][SQL Server] Invalid Object Name 'skedul1'below script that i used for update value on my SQL ServerClick to expand...When you use [skedul1] within the SQL that's executed by the server and it's not finding anything. SQL Server or MySQL Server has no access to the VFP process, or it's cursors. It's totally hopeless to get this going."
Reply,Update Data SQL server Using Create Cursor VFP,bharons,"Dec 13, 2024 at 2:09 AM",https://www.tek-tips.com/threads/update-data-sql-server-using-create-cursor-vfp.1832495/,bharons,Dear Chriss...what should i do..if i use first script i just can update first row.What I want is? that all data in the create cursor is saved or copied in the DBO.Schedule table?? any sugesstion..
Reply,Update Data SQL server Using Create Cursor VFP,bharons,"Dec 13, 2024 at 2:09 AM",https://www.tek-tips.com/threads/update-data-sql-server-using-create-cursor-vfp.1832495/,bharons,"Chris Miller said:Because this code only copies the current record into variables:Code:select skedul1
m.value1 = skedule1.norekening
m.value2 = skedule1.ke
m.value3 = skedule1.pokok_kr
m.value4 = skedule1.pokok_sd
m.value5 = skedule1.bunga_krYou need to do this repeatedly in a SCAN...ENDSCAN loopWhen you use [skedul1] within the SQL that's executed by the server and it's not finding anything. SQL Server or MySQL Server has no access to the VFP process, or it's cursors. It's totally hopeless to get this going.Click to expand...i try this script... but its seem i just only last row has changing...Code:select skedul1
scan
m.value1 = skedul1.norekening
m.value2 = skedul1.ke
m.value3 = skedul1.pokok_kr
m.value4 = skedul1.pokok_sd
m.value5 = skedul1.bunga_kr

    TEXT TO m.lcSQL TEXTMERGE noshow
    UPDATE dbo.skedul
        SET pokok_kr = ?m.value3,
        pokok_sd = ?m.value4,
        bunga_kr = ?m.value5
        WHERE norekening = ?m.value1 and ke = ?m.value2
    ENDTEXT       
endscan

lnResult = SQLExec(Thisform.nHandle, m.lcSQL)
If m.lnResult < 0
    Aerror(aWhy)
    Messagebox(aWhy[2])
    SQLDisconnect(0)
    Return .F.
Else
    Messagebox(""Data Telah Update..!!"")
    thisform.PopulateGrid()
    thisform.grid2.RecordSource = """"
Endif"
Reply,Update Data SQL server Using Create Cursor VFP,bharons,"Dec 13, 2024 at 2:09 AM",https://www.tek-tips.com/threads/update-data-sql-server-using-create-cursor-vfp.1832495/,Chris Miller,"Well, think about where to put the ENDSCAN to execute the update for each record of the cursor. Not where you have it."
Reply,Update Data SQL server Using Create Cursor VFP,bharons,"Dec 13, 2024 at 2:09 AM",https://www.tek-tips.com/threads/update-data-sql-server-using-create-cursor-vfp.1832495/,bharons,"Chris Miller said:Well, think about where to put the ENDSCAN to execute the update for each record of the cursor. Not where you have it.Click to expand...i use this script.. still have first row change..Code:select skedul1
m.value1 = skedul1.norekening
m.value2 = skedul1.ke
m.value3 = skedul1.pokok_kr
m.value4 = skedul1.pokok_sd
m.value5 = skedul1.bunga_kr

lcSQL = 'update dbo.skedul SET pokok_kr = ?m.value3, pokok_sd = ?m.value4, bunga_kr = ?m.value5 WHERE norekening = ?m.value1 and ke = ?m.value2'
Select skedul1
Scan
   SQLExec(Thisform.nHandle, m.lcSQL)
Endscan

lnResult = SQLExec(Thisform.nHandle, m.lcSQL)
If m.lnResult < 0
    Aerror(aWhy)
    Messagebox(aWhy[2])
    SQLDisconnect(0)
    Return .F.
Else
    Messagebox(""Data Telah Update..!!"")
    thisform.PopulateGrid()
    thisform.grid2.RecordSource = """"
Endif"
Reply,Update Data SQL server Using Create Cursor VFP,bharons,"Dec 13, 2024 at 2:09 AM",https://www.tek-tips.com/threads/update-data-sql-server-using-create-cursor-vfp.1832495/,Chris Miller,"The scan was already correct, I only asked you to move the endscan.Take it slowly, don't guess.I said ""You need to do this repeatedly in a SCAN...ENDSCAN loop"":Code:m.value1 = skedule1.norekening
m.value2 = skedule1.ke
m.value3 = skedule1.pokok_kr
m.value4 = skedule1.pokok_sd
m.value5 = skedule1.bunga_krWhen is code within a loop? When the start of the loop is before it, isn't it?"
Reply,Update Data SQL server Using Create Cursor VFP,bharons,"Dec 13, 2024 at 2:09 AM",https://www.tek-tips.com/threads/update-data-sql-server-using-create-cursor-vfp.1832495/,bharons,"Chris Miller said:The scan was already correct, I only asked you to move the endscan.Take it slowly, don't guess.I said ""You need to do this repeatedly in a SCAN...ENDSCAN loop"":Code:m.value1 = skedule1.norekening
m.value2 = skedule1.ke
m.value3 = skedule1.pokok_kr
m.value4 = skedule1.pokok_sd
m.value5 = skedule1.bunga_krWhen is code within a loop? When the start of the loop is before it, isn't it?Click to expand...Yupz... but its seem i can't get it.. where and when i must start scan also when i must ended with endscan.."
Reply,Update Data SQL server Using Create Cursor VFP,bharons,"Dec 13, 2024 at 2:09 AM",https://www.tek-tips.com/threads/update-data-sql-server-using-create-cursor-vfp.1832495/,Chris Miller,"The loop code has to do two things1. set the value1 to value5 variables2. do the SQLExec.If you do 1 before the loop and only do 2 within the loop, you repeat the same update with the first record values multiple times, if you only do 1 and finally 2, you change the variables multiple times, until they have the values of the last records and only do the update with last record values.So you have done 2 of 3 possible things, but you haven't done the right thing."
Reply,Update Data SQL server Using Create Cursor VFP,bharons,"Dec 13, 2024 at 2:09 AM",https://www.tek-tips.com/threads/update-data-sql-server-using-create-cursor-vfp.1832495/,Chris Miller,"One more thing about (a part of) your second code sample:Code:lnResult = SQLExec(Thisform.nHandle, m.lcSQL)
If m.lnResult < 0
    Aerror(aWhy)
    Messagebox(aWhy[2])
    SQLDisconnect(0)
    Return .F.
Else
    Messagebox(""Data Telah Update..!!"")
    thisform.PopulateGrid()
    thisform.grid2.RecordSource = """"
EndifThat code is fine, in itself. But it has one requirement to be reusable for all your different SQL use cases: It depends on having one SQL string doing everything a job has to do. If doing that sql fails (that means if SQLEXEC returns a negative value) you display the error. If not, that means the SQL succeeds, the else branch tells the users it worked.In your current case you have an update sql only working on a single record, so you have to do this 4 times. And you only know if all 4 worked, after all 4 updates returned no errors. So that's not working for this case."
Reply,Update Data SQL server Using Create Cursor VFP,bharons,"Dec 13, 2024 at 2:09 AM",https://www.tek-tips.com/threads/update-data-sql-server-using-create-cursor-vfp.1832495/,bharons,ohhh... i must reply those script until 4 time.. with condition no error on sql connect..
Reply,Update Data SQL server Using Create Cursor VFP,bharons,"Dec 13, 2024 at 2:09 AM",https://www.tek-tips.com/threads/update-data-sql-server-using-create-cursor-vfp.1832495/,Chris Miller,"No, you don't need to connect 4 times.I think the language barrier - that of your natural language - makes it impossible to teach you in English. You should look for a Forum in your country.You essentially know enough to get this going. It won't teach you to get a solution served, you don't show a learning progress and I'm therefore not putting time and effort in continuing. Others might have mercy and more patiente, but I'm off here, sorry."
Reply,Update Data SQL server Using Create Cursor VFP,bharons,"Dec 13, 2024 at 2:09 AM",https://www.tek-tips.com/threads/update-data-sql-server-using-create-cursor-vfp.1832495/,bharons,"Chris Miller said:No, you don't need to connect 4 times.I think the language barrier - that of your natural language - makes it impossible to teach you in English. You should look for a Forum in your country.You essentially know enough to get this going. It won't teach you to get a solution served, you don't show a learning progress and I'm therefore not putting time and effort in continuing. Others might have mercy and more patiente, but I'm off here, sorry.Click to expand..."
Reply,Update Data SQL server Using Create Cursor VFP,bharons,"Dec 13, 2024 at 2:09 AM",https://www.tek-tips.com/threads/update-data-sql-server-using-create-cursor-vfp.1832495/,bharons,Thank you for your attention... maybe next time you can provide other direction regarding the coding mistakes I made...
Question,How to set font size and type in TXT file thru VFP6/9,Piotr Czekalski,"Dec 5, 2024 at 8:14 PM",https://www.tek-tips.com/threads/how-to-set-font-size-and-type-in-txt-file-thru-vfp6-9.1832407/,Piotr Czekalski,"Hi all,is it possible to programmatically apply font to display text files by command  Modi Comm File.TXT - preferably when starting program ?I use ""Modi Comm File.TXT NoEdit"" command to display reports (text files contents). I manually set  font via: Format-> Font and then Edit->Properites->Apply to TXT->OK. After some time VFP assigns a different font to display TXT files.  Then displayed reports lose their format.  I taught my clients to manually set the appropriate font format and size themselves, but it's a problem. I use Modi Comm commands in programs in many places in code. I'd rather not change that solution.Thx for help"
Reply,How to set font size and type in TXT file thru VFP6/9,Piotr Czekalski,"Dec 5, 2024 at 8:14 PM",https://www.tek-tips.com/threads/how-to-set-font-size-and-type-in-txt-file-thru-vfp6-9.1832407/,ggreen61,"In the design-time environment you can set the font default from the menu path:Tools --> OptionsThen go to the tab IDE and set the desired font name, size, etc.  This will generate a setting in the registry.  Possibly if you export this setting from the registry and then import into your customers systems, and maybe it will use/retain the font that you want."
Reply,How to set font size and type in TXT file thru VFP6/9,Piotr Czekalski,"Dec 5, 2024 at 8:14 PM",https://www.tek-tips.com/threads/how-to-set-font-size-and-type-in-txt-file-thru-vfp6-9.1832407/,Piotr Czekalski,"Thanks. In one client's my font settings work for a month, another for 2-3 weeks. Windows updates probably break it or updates to other software. For some clients my settings don't change at all  - remains stablity.  If you mean Windows registry I can't import them to my clients  system.  My client's IT departments won't let me do that."
Reply,How to set font size and type in TXT file thru VFP6/9,Piotr Czekalski,"Dec 5, 2024 at 8:14 PM",https://www.tek-tips.com/threads/how-to-set-font-size-and-type-in-txt-file-thru-vfp6-9.1832407/,EinTerraner,You can use FOX to read/write the user-settings in the registry.
Reply,How to set font size and type in TXT file thru VFP6/9,Piotr Czekalski,"Dec 5, 2024 at 8:14 PM",https://www.tek-tips.com/threads/how-to-set-font-size-and-type-in-txt-file-thru-vfp6-9.1832407/,atlopes,"Piotr,You can define a window with all required settings and modify the report in that window when needed.Code:DEFINE WINDOW EditorWindow FROM 1,1 TO 40,80 FONT ""Arial"", 14 TITLE ""Editor Window"" CLOSE FLOAT GROW
* the definition is now available
* first use
MODIFY COMMAND report1.txt NOEDIT WINDOW EditorWindow
* second use
MODIFY COMMAND report2.txt NOEDIT WINDOW EditorWindow
* and so on..."
Reply,How to set font size and type in TXT file thru VFP6/9,Piotr Czekalski,"Dec 5, 2024 at 8:14 PM",https://www.tek-tips.com/threads/how-to-set-font-size-and-type-in-txt-file-thru-vfp6-9.1832407/,Chris Miller,"I think atlopes has a good solution. I'd go for putting the text into a memo field and use MODIFY MEMO. But I'd like to address your false assumption.Piotr Czekalski said:Windows updates probably break it or updates to other software.Click to expand...I strongly doubt that. Why would Windows updates fiddle with FoxPro registry entries In the HKEY_CURRENT_USER hive (that's where they are, see below)?This argument for anything people don't know how it changes is assumed to come from the outside, i.e. Windows Update or other outside effects is most often not true. I remeber tons of such finger pointing and only know 3 things of the top of my hat that actually are Windows changes, PACK, GENERAL fields behavior and printer setup dialogs.It has never happened to me that due to a Windows update my VFP editor windows settings changed. In VFP you make settings of fonts and sizes, more generally for ""Appearance and behavior"", as it's called in the Options dialog, IDE tab for all kinds of windows of program files, memo windows and more.  On the lefthand side of the IDE tab pick a type of window and you see the used font face, size, also set whether syntax colouring is used, hyperlinks are rendered as such etc.All IDE window appearance settings are stored in HKEY_CURRENT_USER\SOFTWARE\Microsoft\VisualFoxPro\9.0\Options\IDE.Piotr Czekalski said:If you mean Windows registry I can't import them to my clients system. My client's IT departments won't let me do that.Click to expand...And that the appearance of MODIFY COMMAND changes is proof enough there is no restriction on this registry hive. Because those settings come from the registry.Did you know the registry is stored in files, one for each key hive (like HKEY_LOKAL_MACHINE, etc.)? Part of that is per user and if there would be a policy restricting even the access to the users hive, there would be no appearance changes, and you would also never be able to direct users to make changes they way you described with menu options.Well, take all that aside, the solution suggested by atlopes doesn't even need registry changes or IDE settings changes, as it just prepares a window with what appearance options you like. So I don't even need to hammer on the point you could also do registry changes, as they are obviously possible. Defining a window gives you control about that windows settings without influencing the appearance of all similar windows. The user has the ability to change appearance with context menu (mouse right click or context menu key) in properties. That also only applies changes to that current window, not all others. So overall, it's less intrusive to VFP users choices of IDE default window appearances."
Reply,How to set font size and type in TXT file thru VFP6/9,Piotr Czekalski,"Dec 5, 2024 at 8:14 PM",https://www.tek-tips.com/threads/how-to-set-font-size-and-type-in-txt-file-thru-vfp6-9.1832407/,Piotr Czekalski,"Ok.Command ""Modi comm ... Window"" is a very good solution that I know and sometimes use. There is one problem. My reports require scrolling vertically and horizontally. After calling command: ""Modi Comm .... Window"" ScrollBars (Screen1) are not visible. They appear after manually resizing  window (Screen2).  This confuses a little users. That is why I have not usedWindowclause in reports so far. This would be the best solution. How to make ScrollBars appear immediately after opening a window.Screen1Screen2 (after manualy  resizing)When I asked question in main topic I wanted to avoid changing the program code in many places where I display reports. I guess it will not be possible.Thanks ggreen61, EinTerraner. Maybe we can solve the problem without updating registers.Chris, what could be the reason for changing the font assignment ?. Some process is probably updating Windows registry."
Reply,How to set font size and type in TXT file thru VFP6/9,Piotr Czekalski,"Dec 5, 2024 at 8:14 PM",https://www.tek-tips.com/threads/how-to-set-font-size-and-type-in-txt-file-thru-vfp6-9.1832407/,Chris Miller,"Updating the Windows registry is possible by any process. But even if a Windows update is celaning up registry entries with infos for bot nets (I think that happened more than once to deminish spam bot nets), why should it explicitly change the VFP IDE window settings? It's not Windows settings af general appearances of Windows, those registry settings are explicitly only for VFP windows, nothing else in the system. They are not about the default font for Windows in general, Windows colors, etc.What can change the specific entries of the VFP IDE windows appearance? FoxPro. Users using FoxPro aking changes not realizing that affects your report display windows, as they don't even know you're using MODFIY COMMAND for them.Again, the registry key for program windows is the only key determining the font of the MODI COMM windows. It's really pinpointed down to this one registry entry for that. Users using Foxpro not only within your software (you know MODIFY COMM is not available in the vfp9r.dll, users will need VFP installed) are setting up their editor windows as they like, don't they? And thus they change settings you make for your report display, using MODIFY COMM.If you don't like changing lots of code, then the only thing you can do is change the specific registry key, thus fiddling with their code window appearance choices. You'll still be going forwards and back, then, when users don't want your report font/fontsize etc. choices for their code editing."
Reply,How to set font size and type in TXT file thru VFP6/9,Piotr Czekalski,"Dec 5, 2024 at 8:14 PM",https://www.tek-tips.com/threads/how-to-set-font-size-and-type-in-txt-file-thru-vfp6-9.1832407/,Piotr Czekalski,"There are many ways to display text files in VFP.  Not all of them are supported horizontal scrolling. Modi Comm, Modi File seemed to be the most stable, although better to be careful about right-clicking on a piece of text to highlight. VFP can get stuck when clause NoEdit is used.What is interesting, Windows system program NotePad blocks access to options in VFP: Edit-->Properties-->Apply to TXT. I noticed that running several VFP programs at the same time causes the disruptions font of txt files display I wrote about. But after closing programs everything is OK. Now I have an idea. Problem may occur if client runs several programs in VFP in the same time  and closes computer. Then  all will be saved and confirmed in Windows registry.  Current (incorrect) status of font assignment to display text too ..."
Reply,How to set font size and type in TXT file thru VFP6/9,Piotr Czekalski,"Dec 5, 2024 at 8:14 PM",https://www.tek-tips.com/threads/how-to-set-font-size-and-type-in-txt-file-thru-vfp6-9.1832407/,Chris Miller,"Piotr Czekalski said:Windows system program NotePad blocks access to options in VFP: Edit-->Properties-->Apply to TXTClick to expand...No, you just have a wrong assumption that this VFP option sets properties like the font used for the TXT extension and thus the whole Windows system. You only set the option for VFP using MODIFY FILE or MODIFY COMMAND, Notepad has it's own settings that are also not subject to Windows cofiguration. If you change font in Notepad this is stored somewhere, I guess the regisry, as a notepad setting, it's not applied to the TXT file you have loaded. A TXT file only has one influence of Notepad that's also mainly only applied by Notepad itself, the first file bytes, if used, can make it an ANSI, UTF8 or Unicode text file. Notepad++ as intended third party replacement editor for Microsofts notepad is also knwoing this (called BOM), but there is no embedding of font information for TXT files, within TXT files are alterative NTFS streams associated with a file.You're thinking of Windows settings, where they don't even exist."
Reply,How to set font size and type in TXT file thru VFP6/9,Piotr Czekalski,"Dec 5, 2024 at 8:14 PM",https://www.tek-tips.com/threads/how-to-set-font-size-and-type-in-txt-file-thru-vfp6-9.1832407/,Chris Miller,"Lets talk about the inverse, lets focus on the defaults you can set in Windows overall configurations. in the section of Themes. Actually since at least Windows 10 Microsoft has shrinked the options users had to set the font of Windows Titlebar captions, for example. Within a few minutes I spent on this I only find the general font size setting you can make, nohing more. Might be still available for backwards compatibility, but I won't dig that deep for now.Even when those things have been configurable, VFP forms for example, would by default inherit the Font and Fontsize used in forms from Windows, but you can override them as you like. The main settings you can actively read in from Windows are only osme for decimal point, currency symbol, etc you get from SET SYSFORMATS ON.One of the other things is the Form class property ""Coloursource"", where you can pick from 0 (default) Objects own colours, 4 Windows Control Panel (3D colors) or 5 Windows Control Panel (Windows Colors), which I think are both outdated with at least Windows 10. Mainly that gave all Windows the same ""Windows gray"" in NT, 95/98/2000,XP etc versions.The theme influence of Windows has been reduced to what font all Windows Titelbars are, the flat vs §d look of controls also is influenced by Windows, but I don't even find a default font setting for say Text or Editbox like controls anymore, that I knew from Windows NT-XP."
Reply,How to set font size and type in TXT file thru VFP6/9,Piotr Czekalski,"Dec 5, 2024 at 8:14 PM",https://www.tek-tips.com/threads/how-to-set-font-size-and-type-in-txt-file-thru-vfp6-9.1832407/,Chris Miller,"By the way, it's more straight forward to use MODI FILE for TXT editing or display (with NOEDIT option), but VFP has no registry key explicitly for any file (MODIFY FILE allows any file extension, mainly txt, but not only). I think MODIFY FILE will use the same settings as MODIFY COMMAND, these two commands seem to only differ in whether you get syntax coloring or not.But they are not Windows settings, that's clear.You can resuse most of your code making the registry setting for Program Files, but would be better off and in full control by changing to establishing your own Windows. I can't reproduce the scrollbar problems you have. Even if, you can set them, too, once you have a legacy window name, you can get an object reference ot it and set form class properties such as Scrollbars:Diff:Define Window MyWindow FRom 1,1 to 40,40 ... NAME oMyWindow
oMyWindow.Scrollbars=3Notice the distinction of the WindowName MyWindow and the object reference variable name oMyWindow. You could make them the same, but the former is used in all WINDOW commands and functions like WFONT(), the latter is usable as object reference for OOP VFP code making use of any properties.There's an overlap of usabililty. For example, later on instead of DISPLAY WINDOW MyWindow you could also use oMyWindow.visible=.t., etc.So in main.prg define a window for all report displays and the only thing you need to change in your MODIFY COMMAND is adding a WINDOW EditWindow, that's doable with Code References Search& Replace."
Reply,How to set font size and type in TXT file thru VFP6/9,Piotr Czekalski,"Dec 5, 2024 at 8:14 PM",https://www.tek-tips.com/threads/how-to-set-font-size-and-type-in-txt-file-thru-vfp6-9.1832407/,Chris Miller,"You might think the idea of defining a window toruledisplay them all fails on the Window being closable and so getting released after the first display of a report txt file, well, as shown you can have a for reference and set closable=.f.,, also use BindEvents to have code in the QueryUnload not allowing to close the form and instead hiding it.Edit: After a bit experimenting it turns out that once you define a window as atlopes suggest with DEFINE WINDOW and add a NAME oReprotDisplay clause to it, the object reference isn't really identical to the Window. For example oReportDisplay.Scrollbars=3 doesn't add scrollbars. So that idea fails, unfortunately.But you may turn it fully upside doen and make a form class for report (txt file) display instead of using MODIFY COMMAND you shange it to showing that form with text file to display as parameter of the Show() method and Hide it in QueryUnload or even turn it to a DO FORM instead of MODIFY COMMAND."
Reply,How to set font size and type in TXT file thru VFP6/9,Piotr Czekalski,"Dec 5, 2024 at 8:14 PM",https://www.tek-tips.com/threads/how-to-set-font-size-and-type-in-txt-file-thru-vfp6-9.1832407/,Piotr Czekalski,"Chris, I highly appreciate VFP as tool for processing text DBF tables. Support is extremely effective compared to other XBase systems. Used at the appropriate scale of course.I am a client of a small company that creates software in VFP9 for handling tax returns and financial reports. They have full support for XML, cryptography, electronic signatures, etc. All these documents are sent to government servers in some mysterious way. This is already space for me. I just export data from my stupid programs to this program in CSV format. They developed it all themselves. So VFP has potential.  I appreciate it.Sorry for small offtopicI'll be working on these fonts on all Saturday"
Reply,How to set font size and type in TXT file thru VFP6/9,Piotr Czekalski,"Dec 5, 2024 at 8:14 PM",https://www.tek-tips.com/threads/how-to-set-font-size-and-type-in-txt-file-thru-vfp6-9.1832407/,Chris Miller,"I wonder if our posts crossed over. In short my idea didn't work as expected, but the idea to replace all your MODIFY COMMAND lines with something else, with the help of Code References or also GoFish or something you wirte yourself would easily work. and then you can also replae a 1-line call of MODIFY COMMAND with multiline code. The only bummer is, that you likely don't want to replace each and every MODIFY COMMAND, as not all of them are about report display, but I'm sure you'll find a way to make the search only change the relevant MODIFY COMMAND lines."
Reply,How to set font size and type in TXT file thru VFP6/9,Piotr Czekalski,"Dec 5, 2024 at 8:14 PM",https://www.tek-tips.com/threads/how-to-set-font-size-and-type-in-txt-file-thru-vfp6-9.1832407/,Piotr Czekalski,"I used the clause ""oMyWindow.Scrollbars=3"". Sometimes ScrollBars appear, other times they are not visible. I don't understand at all what this is about.That's exactly Chris what I'll do. All Modi Comm and Modi File will be changed to a call to a procedure that I'll write using object programing : forms etc ... ."
Reply,How to set font size and type in TXT file thru VFP6/9,Piotr Czekalski,"Dec 5, 2024 at 8:14 PM",https://www.tek-tips.com/threads/how-to-set-font-size-and-type-in-txt-file-thru-vfp6-9.1832407/,Chris Miller,"Piotr Czekalski said:All Modi Comm and Modi File will be changed to a call to a procedureClick to expand...That's the way to do it, right.The object variable you get from DEFINE WINDOW ... NAME oMyWindow is clearly a form class, but it's still not yet exactly the Window defined. I made the same experience as I wanted to establish a hidden ReportDisplay Window with Scrollbars to use with MODIFY COMMAND or FILE. But when you specify IN WINDOW you get a window within the Reportdisplay window, that's not working as intended, if you instead write MODIFY COMM ... WINDOW ReportDisplay, not IN WINDOW, that overrides the existing Window. So you get strange effects any way you do it and I came to the conclusion to better replace this with atlopes full code. And then, right, it's a best approach to put that into a class or procedure to call.There's still a no changes required approach, if you set registry keys for PRG Windows in main for this applications session and stay with MODI COMM. It just overrides the VFP programmers setting everytime using your application.Anyway you go through it, I wish you find all relevant places and sucess in the details."
Reply,How to set font size and type in TXT file thru VFP6/9,Piotr Czekalski,"Dec 5, 2024 at 8:14 PM",https://www.tek-tips.com/threads/how-to-set-font-size-and-type-in-txt-file-thru-vfp6-9.1832407/,Piotr Czekalski,"Chris, I'm working on this problem and have some ideas. Maybe it will be work.I started experimenting with registry keys. I changed my favoriteScreen-1font ""FoxFont"" to Franklin by (Format-->Font and Edit--->Apply to TXT). FoxFont was once developed by a colleague of mine specifically for my needs. I don't want to go into details. I turned my computer off and on again. Fox-Pro remembered the FranklinScreen-2font setting. I checked all Windows registry keys by RegEdit for VFP9 one by one and there is no font named Franklin. Additionally, I used search engine. I found Franklin among other fonts in OfficeScreen-3.This sneaky VFP probably saves these settings somewhere else.<<Personal data, surnames, names generated by ""AI"">>Screen-1Screen-2Screen-3"
Reply,How to set font size and type in TXT file thru VFP6/9,Piotr Czekalski,"Dec 5, 2024 at 8:14 PM",https://www.tek-tips.com/threads/how-to-set-font-size-and-type-in-txt-file-thru-vfp6-9.1832407/,Chris Miller,"I pointed out VFP stores several windows font settings in HKEY_CURRENT_USER\SOFTWARE\Microsoft\VisualFoxPro\9.0\Options\IDELet's look at this in more detail:This registry branch has 4 font settings, while the dialog Options->IDE->Type pffers 8 different window types.Sp there is no 1:1 mapping of window types with the font settings in the IDE registry branch, obviously.The options set appearence for IDE window types, not for file extensions. File extension associations are reg keys in the IDE branch, but this is mainly about IDE window types, not file extensions. File associations of the Windows systems are about standard applications, and font associations therefore are not about file extensions but about applications configurations. So all file extension VFP handles would get their appearance from the IDE branch, unless there is no font key, like for example for TXT.What I think is very straight forward is the VFP reg key for Program Font, as that would be used by MODIFY COMM. The file extension ProgramExtension key is set to PRG, but also others MPR is menu program (generated by genmenu), QPR is for query program, that's a specialty I wont get into, and SPR I think is for snippets or for screens. Well it doesn't matter much, as you know you can also MODIFY COMMAND Text.txt, it's not really bound to PRG,MPR,QPR,SPRSo I would have set ProgramFont and use MODIFY COMM.What you don't have is a special key for TXT, or better said for MODIFY FILE. So either VFP stores that setting elsewhere or it's also determined by ProgramFont.Anyway that is, with Program Font you're in control about how windows appear you open with MODIFY COMMAND. One of the appearance settings that's not in these registry keys is syntax cololuring, and I guess MODIFY COMMAND causes a window appearance to include syntax colouring, which is something you likely don't want.Overall, that gives you less control than I first thought. But there must be somewhere VFP also stores your decision to have or not have syntax colouring. What's less good about using MODIFY COMM is that programming with VFP you surely want syntax colouring, so setting that off for report display windows will always be opposite of what developers will set.That's speaks for finding a way to influence the appearance of MODIFY FILE, but maybe it would work, if you change to MODIFY MEMO. That would require a code change anyway, all report output txt files would need to be read into a memo field of a dbf or cursor.I don't know if you have general, centralized routine that all report outputs to txt go through to get to the txt display, then it would be simple to read in txt files into a memo, generally.Edit: Looking at the reg keys (and refreshing them with F5) I see the syntax colouring is a ""bit"" in the data of the Program registry key, I think in the 11th position. I say ""bit"" in quotes as the data also includes 4, not only 0s and 1s. No idea what this is all about, but the registry key type REG_SZ is just a text. If you set this to what you need and set it back at application end, you're in control about the appearance of windows you get from MODIFY COMMAND, I think. And that is your best bet on having the least program code changes by only setting registry keys.Edit2: Is MODIFY COMMAND only available in the IDE and not with the vfp9r.dll runtime? I think it is available, editor windows are not limited to the IDE only. There's one completely new possibility,  if the runtime will also respect the TEDIT setting within a fpw configuration used by your application, then MODI'FY COMMAND will run whatever application you specify there, that could be notepad++ or anything else, also an own EXE you use for display, and then you'd be in full control about the look of it. So that wouldn't even require fiddling with the registry keys, but instead making use of TEDIT=some.exe in a fpw file you use within your exe by start parameter -c or having a config.fpw in the same folder as the exe or (I think) embedding a config.fpw inside the EXE with a TEDIT line."
Reply,How to set font size and type in TXT file thru VFP6/9,Piotr Czekalski,"Dec 5, 2024 at 8:14 PM",https://www.tek-tips.com/threads/how-to-set-font-size-and-type-in-txt-file-thru-vfp6-9.1832407/,Chris Miller,"Simple experiment about the TEDIT idea:I made a simple project having an embedded config.fpw with TEDIT=Notepad.exe, a main prg that does nothing else but MODIFY COMMAND (GETFILE()) and running that exe, choosing a file I get notepad up to display the chosen file. The only disadvantage is that not only notepad but a cmd.exe windows comes up. I think you could influence that somehow, then this would allow you to define your own exe instead of notepad.exe which gets the file name as first parameter. And then you neither change settings of VFP nor the IDE configuration with a config.fpw and have full control about the display.I think the visibility of cmd.exe can be controlled with the FoxRun.pf in HOME()+""Tools""."
Question,If not checked check1 insert as .f. into table (SOLVED DONT BOTHER),Filip Brnic,"Dec 12, 2024 at 1:49 PM",https://www.tek-tips.com/threads/if-not-checked-check1-insert-as-f-into-table-solved-dont-bother.1832488/,Filip Brnic,"Hey this sounds so simple but it doesnt work to me, when i leave the thing unchecked with correct controlsource to it, it just doesnt work when i save it to the table?Is there some kinda thing i need to do in its procedures?I need that check1 to be always unchecked and when the forms procedure query unload happens, i want it to be replaced in the current field in knjizeno collumn.I just put it on the form and put visible off and i thought it was gonna be false and insert itself as false but something is wrong i have no clue hahahahaha"
Question,"While there is any .f. (false logical records) in the table, do something, if there isnt any, do something ekse",Filip Brnic,"Dec 11, 2024 at 2:36 PM",https://www.tek-tips.com/threads/while-there-is-any-f-false-logical-records-in-the-table-do-something-if-there-isnt-any-do-something-ekse.1832469/,Filip Brnic,"Hello, i need a command button that does something only if there isnt ANY .f. in the tableI need this because i dont wanna allow someone to go further into my program without accounting some stuff.Does anyone have any idea how i would do this??"
Reply,"While there is any .f. (false logical records) in the table, do something, if there isnt any, do something ekse",Filip Brnic,"Dec 11, 2024 at 2:36 PM",https://www.tek-tips.com/threads/while-there-is-any-f-false-logical-records-in-the-table-do-something-if-there-isnt-any-do-something-ekse.1832469/,Chris Miller,"No further details? No field names? Any field? I mean if it's known anyone can create a DBF file and put the necessary .F. in it to get through your barrier.Here are some considerations about security in FoxPro:http://www.foxpert.com/docs/security.en.htmI won't continue with code samples, because I'm quite sure, though I could be wrong, that you mean something else than you wrote, just judging by the number of negations you use to formulate your requirements. That's a bad sign, alone. Formulate what you want, not what you don't want. You can even take that as a much more general advice, concentrate on formulating this positively, not with double, triple of quadruple negations.I think what you need is an entry point knowledge of cryptography. The Foxpert article isn't that, it focusses on some simple but astonishing weaknesses in VFP code processing and warns how they could be exploited and points out how to code to avoid these weaknesses. It's a good starting point, though it's very specifically about VFP only. A bit more general at least basic cryptography knowledge will give you better ideas on how to go about application security."
Reply,"While there is any .f. (false logical records) in the table, do something, if there isnt any, do something ekse",Filip Brnic,"Dec 11, 2024 at 2:36 PM",https://www.tek-tips.com/threads/while-there-is-any-f-false-logical-records-in-the-table-do-something-if-there-isnt-any-do-something-ekse.1832469/,Filip Brnic,"Well i made it sound incredibly harsh if someone happens to go trough the program, the program itself isnt done to that extent, but i do have to tell you more, i have a field (knjizeno) which is logical, if there is anything in that column that is .f. then i want it to do something, and vice versa, if someone does bypass they will eventually run into more problems in the code so i just wanna know for now how to on-click check if there are any .f. in records of the table."
Reply,"While there is any .f. (false logical records) in the table, do something, if there isnt any, do something ekse",Filip Brnic,"Dec 11, 2024 at 2:36 PM",https://www.tek-tips.com/threads/while-there-is-any-f-false-logical-records-in-the-table-do-something-if-there-isnt-any-do-something-ekse.1832469/,TamarGranor,"There are lots of ways to do this. If you don't mind moving the record pointer in that table:Code:LOCATE FOR NOT knjizeno
IF FOUND()
   * Don't allow the user to continue
ENDIFor:Code:COUNT TO nFalse FOR NOT knjizeno
IF nFalse > 0
   * Don't allow the user to continue
ENDIFYou could also use a SQL query, which would leave the record pointer alone:Code:SELECT knjizeno ;
  FROM YourTableNameHere ;
  WHERE NOT knjizeno ;
  INTO CURSOR csrFalse
 
IF _TALLY > 0
   * Don't allow the user to continue
ENDIFI can think of a bunch more, but that's probably enough. And, if you go with one of the record-pointer moving approaches, you should probably save and restore its position.Tamar"
Reply,"While there is any .f. (false logical records) in the table, do something, if there isnt any, do something ekse",Filip Brnic,"Dec 11, 2024 at 2:36 PM",https://www.tek-tips.com/threads/while-there-is-any-f-false-logical-records-in-the-table-do-something-if-there-isnt-any-do-something-ekse.1832469/,Chris Miller,"Not sure, it sounds like you note down in that data what parts of the program are finished, and if one part isn't, would prevent to run it. Wouldn't it be simpler to not release something unfinished, then?It doesn't sound like a authentication problem anymore, but the intent is still not something that sounds plausible to me. If you want to prevent code to run with an incomplete configuration or a configuration that you identify as wrong by verification rules, that would be something I would encourage to do as a mechanism to prevent errors. But then, your data about the parts of finished code can be wrong.The usual way to determine when a program is ready for production use is testing, and that is a topic in itself, again.Tip: Look intohttps://github.com/VFPX/FoxUnit. This generates result files and returns an overall result by exitcode 0 for successful testruns and 1 (aka ERRORLEVEL 1) for an overall failed test."
Question,Curosor adapter right padding with spaces,D-Ward,"Dec 5, 2024 at 2:05 PM",https://www.tek-tips.com/threads/curosor-adapter-right-padding-with-spaces.1832400/,D-Ward,"Hi all,Am updating a MySQL database with a CA, when I open the VFP table the string fields show as being trimmed, when I call the CA and insert the data remote cursor shows the data as trimmed, but when I do the update the MySQL data on the server shows the string fields as being right padded with spaces.I have checked the MySQL setup, have inserted records manually into the database and they are trimmed with no spaces, so it looks like the CA might be doing it, anyone seen this before or have any ideas where to look other than putting some conditions in the MySQL database?"
Reply,Curosor adapter right padding with spaces,D-Ward,"Dec 5, 2024 at 2:05 PM",https://www.tek-tips.com/threads/curosor-adapter-right-padding-with-spaces.1832400/,Chris Miller,"I try to understand the problem. I think it is varchar vs char, is it? VFP supports varchar (which means no automatic padding with spaces in values shorter than the char field. On the other hand, a char field, also in MySQL is not a varchar and is constant width, so it will pad with spaces, too, that's not VFP specific. So if you insert into a char(6) field with a statement having an""abc""value, the char(6) field will still end up as""abc   "".For varchar vs char, there are also some ODBC options to set with MySQL, look into that:https://dev.mysql.com/doc/connector...ection-parameters.html#codbc-dsn-option-flagsAre you useing a parameterized query with the CA, and in general, how is it set up in detail.I'm sure it's not CA that adds spaces or something along that, the CA does only forward the query and values (if parameterized also parameters) to the MySQL server, which then executes it.Or are you using VFP7 or lower, then there is no VFP side varchar support, that was introduced in VFP8, improved and bugfixed in VFP9.Silly question, CA is VFP8 or later, no question."
Reply,Curosor adapter right padding with spaces,D-Ward,"Dec 5, 2024 at 2:05 PM",https://www.tek-tips.com/threads/curosor-adapter-right-padding-with-spaces.1832400/,D-Ward,"Hi Chris,Looks like it was me mixing VARCHAR on the MySQL end and the legacy database in VFP using CHAR and expecting MySQL to look after the VARCHAR at the back end.  Found this from Mr Lewishttp://www.ml-consult.co.uk/foxst-36.htmthat describes the issue.Thank you for your help and input, as always.Darren"
